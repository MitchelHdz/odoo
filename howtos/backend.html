<!doctype html>


<html xmlns="http://www.w3.org/1999/xhtml" lang="es">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  
    <title>Construyendo un módulo &mdash; documentación de odoo - 10.0</title>
    
    <link rel="stylesheet" href="../_static/style.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/patchqueue.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '10.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/translations.js"></script>
    <script type="text/javascript" src="../_static/patchqueue.js"></script>
    <script type="text/javascript" src="../_static/jquery.min.js"></script>
    <script type="text/javascript" src="../_static/bootstrap.js"></script>
    <script type="text/javascript" src="../_static/doc.js"></script>
    <script type="text/javascript" src="../_static/jquery.noconflict.js"></script>
    <link rel="top" title="documentación de odoo - 10.0" href="../index.html" />
    <link rel="up" title="Tutoriales" href="../tutorials.html" />
    <link rel="next" title="Extendiendo la Interfaz" href="web.html" />
    <link rel="prev" title="Construyendo un Website" href="website.html" /> 
  </head>
  <body role="document"><header class="o_main_header o_has_sub_nav o_inverted ">
    <div class="o_main_header_main">
      <a class="pull-left o_logo" href="/"></a>
      <a href="#" class="o_mobile_menu_toggle visible-xs-block pull-right">
        <span class="sr-only">Toggle navigation</span>
        <span class="mdi-navigation-menu"></span>
      </a>
      <div class="o_header_buttons">
        <a href="http://www.odoo.com/trial" class="btn btn-primary">Start Now</a>
      </div>
      <ul class="o_primary_nav">
        <li class="dropdown">
          <a href="#" class="dropdown-toggle">Apps</a>
          <div class="dropdown-menu o_secondary_nav">
            <div class="container">
              <div class="row">
                <div class="col-sm-3 o_website_apps">
                  <div class="o_nav_app_family">
                    <span></span> Websites
                    <div>Build great user experience</div>
                  </div>
                  <ul>
                    <li><a href="https://www.odoo.com/page/website-builder">Website Builder</a></li>
                    <li><a href="https://www.odoo.com/page/e-commerce">eCommerce</a></li>
                    <li><a href="https://www.odoo.com/page/blog-engine">Blogs</a></li>
                    <li><a href="https://www.odoo.com/page/community-builder">Forums</a></li>
                    <li><a href="https://www.odoo.com/page/slides">Slides</a></li>
                    <li><a href="https://adspike.odoo.com">SEA</a></li>
                  </ul>
                </div>
                <div class="col-sm-3 o_sale_apps">
                  <div class="o_nav_app_family">
                    <span></span> Sales
                    <div>Boost your success rate</div>
                  </div>
                  <ul>
                    <li><a href="https://www.odoo.com/page/sales">Sales</a></li>
                    <li><a href="https://www.odoo.com/page/crm">CRM</a></li>
                    <li><a href="https://www.odoo.com/page/billing">Invoicing</a></li>
                    <li class="dropdown">
                      <a href="#0" class="dropdown-toggle">Point of Sale</a>
                      <ul>
                        <li><a href="https://www.odoo.com/page/point-of-sale">Shops</a></li>
                        <li><a href="https://www.odoo.com/page/pos-restaurant">Restaurants</a></li>
                      </ul>
                    </li>
                    <li><a href="https://www.odoo.com/page/subscriptions">Subscriptions</a></li>
                    <li><a href="https://www.odoo.com/page/sign">Sign</a></li>
                  </ul>
                </div>
                <div class="col-sm-3 o_operation_apps">
                  <div class="o_nav_app_family">
                    <span></span> Operations
                    <div>It's all about efficiency</div>
                  </div>
                  <ul>
                    <li><a href="https://www.odoo.com/page/accounting/">Accounting</a></li>
                    <li><a href="https://www.odoo.com/page/project-management/">Project</a></li>
                    <li class="dropdown">
                      <a href="#0" class="dropdown-toggle">Human Resources</a>
                      <ul>
                        <li><a href="https://www.odoo.com/page/recruitment">Recruitment</a></li>
                        <li><a href="https://www.odoo.com/page/employees">Employees</a></li>
                        <li><a href="https://www.odoo.com/page/expenses">Expenses</a></li>
                        <li><a href="https://www.odoo.com/page/appraisal">Appraisal</a></li>
                        <li><a href="https://www.odoo.com/page/fleet">Fleet</a></li>
                        <li><a href="https://www.odoo.com/page/leaves">Leaves</a></li>
                      </ul>
                    </li>
                    <li><a href="https://www.odoo.com/page/warehouse">Inventory</a></li>
                    <li><a href="https://www.odoo.com/page/purchase">Purchase</a></li>
                    <li class="dropdown">
                      <a href="#0" class="dropdown-toggle">Manufacturing</a>
                      <ul>
                        <li><a href="https://www.odoo.com/page/manufacturing">MRP</a></li>
                        <li><a href="https://www.odoo.com/page/plm">PLM</a></li>
                        <li><a href="https://www.odoo.com/page/maintenance">Maintenance</a></li>
                        <li><a href="https://www.odoo.com/page/quality">Quality</a></li>
                      </ul>
                    </li>
                  </ul>
                </div>
                <div class="col-sm-3 o_productivity_apps">
                  <div class="o_nav_app_family">
                    <span></span> Productivity Tools
                    <div>Great Tools = Happy People</div>
                  </div>
                  <ul>
                    <li class="dropdown">
                      <a href="#0" class="dropdown-toggle">Communication</a>
                      <ul>
                        <li><a href="https://www.odoo.com/page/discuss">Discuss</a></li>
                        <li><a href="https://www.odoo.com/page/discuss-groups">Mailing Lists</a></li>
                        <li><a href="https://www.odoo.com/page/notes">Notes</a></li>
                        <li><a href="#">Help desk</a></li>
                        <li><a href="#">Appointment</a></li>
                      </ul>
                    </li>
                    <li><a href="https://www.odoo.com/page/timesheet">Timesheet</a></li>
                    <li><a href="https://www.odoo.com/page/email-marketing">Email Marketing</a></li>
                    <li><a href="https://www.odoo.com/page/events">Events</a></li>
                    <li><a href="https://www.odoo.com/page/survey">Survey</a></li>
                    <li><a href="https://www.odoo.com/page/live-chat">Live Chat</a></li>
                  </ul>
                </div>
              </div>
            </div>
            <a href="http://www.odoo.com/apps/modules" class="o_store_link"><i class="fa fa-cube fa-fw"></i> Third party apps</a>
          </div>
        </li>
        <li><a href="https://www.odoo.com/page/tour">Tour</a></li>
        <li><a href="https://www.odoo.com/pricing">Pricing</a></li>
        <li><a href="https://www.odoo.com/page/docs">Docs</a></li>
      </ul>
    </div>
    <nav class="navbar o_sub_nav">
      <div class="container">
        <div class="navbar-header visible-xs">
            <button type="button" class="navbar-toggle collapsed text-left btn-block" data-toggle="collapse" data-target="#o_sub-menu" aria-expanded="false">
              Navigate
              <span class="mdi-hardware-keyboard-arrow-down pull-right"></span>
            </button>
        </div>

        <div class="collapse navbar-collapse" id="o_sub-menu">
          <ol class="o_breadcrumb breadcrumb nav navbar-left">
              
              





    
        
            <li><a href="../index.html">Developer Doc</a></li>
        
    
    <li class="active"><a href="#">Construyendo un módulo</a></li>

              
          </ol>

          <div class="call-to-action navbar-right hidden-xs">
            <a href="http://www.odoo.com/trial" class="btn btn-primary">Start Now</a>
          </div>

          <ul class="navbar-nav navbar-right nav o_sub_nav_actions">
            
              <li class="divider"></li>
            

            
            


            
          </ul>

          <ul class="nav navbar-nav navbar-right">
            

            
            

<li><a href="http://www.odoo.com/documentation/user/10.0/index.html">User</a></li>
<li><a href="http://www.odoo.com/documentation/10.0/index.html">Developer</a></li>
<li><a href="http://www.odoo.com/documentation/10.0/api_integration.html">API</a></li>
<li><a href="http://www.odoo.com/documentation/10.0/setup/install.html">Installation</a></li>
<li><a href="http://www.odoo.com/page/odoo-white-paper">White Papers</a></li>
<li><a href="http://www.odoo.com/page/legal">Legal</a></li>
            

            
          </ul>
        </div>
      </div>
    </nav>
  </header><div id="wrap" class="">
    
    
    
    <figure class="card top has_banner">
      <span class="card-img" style="background-image: url('../_static/banners/build_a_module.jpg');"></span>
      <div class="container text-center">
        <h1> Construyendo un módulo </h1>
      </div>
    </figure>
    
    
    
    <div class="container ">
      <main class="container-fluid ">
        
        <div class="row">
          
          <aside>
            <div class="navbar-aside text-center">
              <ul class="list-group text-left nav"><li class="list-group-item"><a href="#start-stop-the-odoo-server" class="ripple internal reference">Iniciar/Detener el servidor Odoo</a></li><li class="list-group-item"><a href="#build-an-odoo-module" class="ripple internal reference">Construir un módulo para Odoo</a><ul ><li class="list-group-item"><a href="#composition-of-a-module" class="ripple internal reference">Composición de un módulo</a></li><li class="list-group-item"><a href="#module-structure" class="ripple internal reference">Estructura de un módulo</a></li><li class="list-group-item"><a href="#object-relational-mapping" class="ripple internal reference">Mapeo Objeto-Relacional</a></li><li class="list-group-item"><a href="#model-fields" class="ripple internal reference">Campos en el Modelo</a><ul ><li class="list-group-item"><a href="#common-attributes" class="ripple internal reference">Atributos comunes</a></li><li class="list-group-item"><a href="#simple-fields" class="ripple internal reference">Campos Simples</a></li><li class="list-group-item"><a href="#reserved-fields" class="ripple internal reference">Campos reservados</a></li><li class="list-group-item"><a href="#special-fields" class="ripple internal reference">Campos Especiales</a></li></ul></li><li class="list-group-item"><a href="#data-files" class="ripple internal reference">Archivos de datos</a></li><li class="list-group-item"><a href="#actions-and-menus" class="ripple internal reference">Acciones y menús</a></li></ul></li><li class="list-group-item"><a href="#basic-views" class="ripple internal reference">Vistas Básicas</a><ul ><li class="list-group-item"><a href="#generic-view-declaration" class="ripple internal reference">Declaración de vista genérica</a></li><li class="list-group-item"><a href="#tree-views" class="ripple internal reference">Vistas de árbol</a></li><li class="list-group-item"><a href="#form-views" class="ripple internal reference">Vistas de formulario</a></li><li class="list-group-item"><a href="#search-views" class="ripple internal reference">Vistas de búsqueda</a></li></ul></li><li class="list-group-item"><a href="#relations-between-models" class="ripple internal reference">Relaciones entre modelos</a><ul ><li class="list-group-item"><a href="#relational-fields" class="ripple internal reference">Campos Relacionales</a></li></ul></li><li class="list-group-item"><a href="#inheritance" class="ripple internal reference">Herencia</a><ul ><li class="list-group-item"><a href="#model-inheritance" class="ripple internal reference">Herencia de modelos</a></li><li class="list-group-item"><a href="#view-inheritance" class="ripple internal reference">Herencia de vistas</a><ul ><li class="list-group-item"><a href="#domains" class="ripple internal reference">Dominios</a></li></ul></li></ul></li><li class="list-group-item"><a href="#computed-fields-and-default-values" class="ripple internal reference">Campos y valores calculados</a><ul ><li class="list-group-item"><a href="#dependencies" class="ripple internal reference">Dependencias</a></li><li class="list-group-item"><a href="#default-values" class="ripple internal reference">Valores por defecto</a></li></ul></li><li class="list-group-item"><a href="#onchange" class="ripple internal reference">Onchange</a></li><li class="list-group-item"><a href="#model-constraints" class="ripple internal reference">Restricciones</a></li><li class="list-group-item"><a href="#advanced-views" class="ripple internal reference">Vistas Avanzadas</a><ul ><li class="list-group-item"><a href="#id3" class="ripple internal reference">Vistas de árbol</a></li><li class="list-group-item"><a href="#calendars" class="ripple internal reference">Calendarios</a></li><li class="list-group-item"><a href="#id4" class="ripple internal reference">Vistas de búsqueda</a></li><li class="list-group-item"><a href="#gantt" class="ripple internal reference">Gantt</a></li><li class="list-group-item"><a href="#graph-views" class="ripple internal reference">Vistas en Gráfico</a></li><li class="list-group-item"><a href="#kanban" class="ripple internal reference">Kanban</a></li></ul></li><li class="list-group-item"><a href="#security" class="ripple internal reference">Seguridad</a><ul ><li class="list-group-item"><a href="#group-based-access-control-mechanisms" class="ripple internal reference">Mecanismos de control de acceso basado en grupos</a></li><li class="list-group-item"><a href="#access-rights" class="ripple internal reference">Derechos de acceso</a></li><li class="list-group-item"><a href="#record-rules" class="ripple internal reference">Reglas de Registro</a></li></ul></li><li class="list-group-item"><a href="#wizards" class="ripple internal reference">Asistentes</a><ul ><li class="list-group-item"><a href="#launching-wizards" class="ripple internal reference">Ejecutar un asistente</a></li></ul></li><li class="list-group-item"><a href="#internationalization" class="ripple internal reference">Internacionalización</a></li><li class="list-group-item"><a href="#reporting" class="ripple internal reference">Informes</a><ul ><li class="list-group-item"><a href="#printed-reports" class="ripple internal reference">Informes impresos</a></li><li class="list-group-item"><a href="#dashboards" class="ripple internal reference">Paneles de control</a></li></ul></li><li class="list-group-item"><a href="#webservices" class="ripple internal reference">WebServices</a><ul ><li class="list-group-item"><a href="#xml-rpc-library" class="ripple internal reference">Librería XML-RPC</a></li><li class="list-group-item"><a href="#json-rpc-library" class="ripple internal reference">Biblioteca de JSON-RPC</a></li></ul></li></ul>
              
              <p class="gith-container"><a href="https://github.com/odoo/odoo/edit/10.0/doc/howtos/backend.rst" class="gith-link">
                  Edit on GitHub
              </a></p>
              
            </div>
          </aside>
          
          <article class="doc-body ">
            
            
  <section id="building-a-module"><div role="alert" class="alert-warning alert"><p class="alert-title">Advertencia</p><p >Este tutorial requiere <a href="../setup/install.html#setup-install" class="internal alert-link reference"><span class="std std-ref">haber instalado Odoo</span></a>
Este tutorial fue traducido al español por Vauxoo [<a href="http://www.vauxoo.com" class="external reference alert-link">http://www.vauxoo.com</a>] para sus cursos.
Cualquier sugerencia de mejora: enviarla a nhomar en vauxoo dot com.</p></div></section><section id="start-stop-the-odoo-server"><h2 >Iniciar/Detener el servidor Odoo</h2><p >Odoo utiliza una arquitectura cliente/servidor en la que los clientes son los navegadores que acceden al servidor Odoo vía RPC.</p><p >La lógica de negocio y sus extensiones se realizan generalmente del lado del servidor, aunque se apoya en algunas características del cliente (por ejemplo, una representación de datos como mapas interactivos) que pueden ser añadida al cliente.</p><p >Para iniciar el servidor, simplemente invoca el comando <a href="../reference/cmdline.html#reference-cmdline" class="internal reference"><span class="std std-ref">odoo-bin</span></a> en la consola, agregando la ruta completa al archivo si es necesario:</p><div class="highlight-default code bash"><div class="highlight"><pre><span></span><span class="n">odoo</span><span class="o">-</span><span class="nb">bin</span>
</pre></div>
</div>
<p >El servidor se detiene pulsando <code >Ctrl-C</code> dos veces desde la terminal, o matando el proceso correspondiente.</p></section><section id="build-an-odoo-module"><h2 >Construir un módulo para Odoo</h2><p >Las extensiones de servidor y cliente se empaquetan como <em >módulos</em> que opcionalmente se cargan en una <em >base de datos</em>.</p><p >Los módulos en Odoo pueden añadir nueva lógica de negocio a un sistema Odoo, o modificar y ampliar la lógica de negocios existente: puede crear un módulo para agregar las reglas de contabilidad de su país adicionándolo al soporte de contabilidad genérico de Odoo, mientras que otro módulo puede añadir soporte para la visualización en tiempo real de una flota de autobuses.</p><p >Todo en Odoo comienza y termina con módulos.</p></section><section id="composition-of-a-module"><h3 >Composición de un módulo</h3><p >Un módulo de Odoo puede contener una serie de elementos:</p><dl ><dt >Objetos de negocios</dt><dd ><p >Declarado como clases de Python, estos recursos son automáticamente persistentes en Odoo basados en su configuración</p></dd><dt >Archivos de datos</dt><dd >XML or CSV files declaring metadata (views or reports), configuration
data (modules parameterization), demonstration data and more</dd><dt >Controladores Web</dt><dd ><p >Manejo de peticiones de los navegadores web</p></dd><dt >Datos estáticos Web</dt><dd ><p >Archivos de imágenes, CSS o javascript utilizados por la interfaz web o sitio web</p></dd></dl></section><section id="module-structure"><h3 >Estructura de un módulo</h3><p >Cada módulo es un directorio dentro de un <em >directorio  de módulos</em>. Los directorios de módulos se especifican mediante la opción <a href="../reference/cmdline.html#cmdoption-odoo-bin--addons-path" class="internal reference"><code class="std xref std-option">--addons-path</code></a>.</p><div role="alert" class="alert-info aphorism alert"><p class="alert-title">Truco</p><p >la mayoría de las opciones de línea de comandos también se pueden establecer usando <a href="../reference/cmdline.html#reference-cmdline-config" class="internal alert-link reference"><span class="std std-ref">un archivo de configuración</span></a></p></div><p >Un módulo de Odoo es declarado por su <a href="../reference/module.html#reference-module-manifest" class="internal reference"><span class="std std-ref">manifiesto</span></a>. Ver la <a href="../reference/module.html#reference-module-manifest" class="internal reference"><span class="std std-ref">Documentación del manifiesto</span></a> aquí.</p><p >Un módulo es también un <a href="http://docs.python.org/2/tutorial/modules.html#packages" class="external reference">paquete de Python</a> con un archivo  <code >__init__.py</code>, que contiene instrucciones de importación de varios archivos de Python en dicho módulo.</p><p >Por ejemplo, si un módulo tiene un solo archivo <code >mymodule.py</code>, el archivo <code >__init__.py</code> podría contener:</p><div class="highlight-default"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">.</span> <span class="k">import</span> <span class="n">mymodule</span>
</pre></div>
</div>
<p >Odoo ofrece un mecanismo para ayudar a comenzar un nuevo módulo, el comando <a href="../reference/cmdline.html#reference-cmdline-server" class="internal reference"><span class="std std-ref">odoo-bin</span></a> tiene un subcomando <a href="../reference/cmdline.html#reference-cmdline-scaffold" class="internal reference"><span class="std std-ref">scaffold</span></a>  para crear un módulo vacío:</p><div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> odoo-bin scaffold &lt;module name&gt; &lt;where to put it&gt;
</pre></div>
</div>
<p >El comando crea un subdirectorio para un módulo y automáticamente crea un montón de archivos estándar para dicho módulo. La mayoría de ellos contienen sólo código comentado o XML. A lo largo de este tutorial se explicará el uso de la mayoría de estos archivos.</p><div role="alert" class="alert-exercise alert"><p class="alert-title">Exercise</p><p >Construcción de un módulo</p><p >Utilizar la línea de comandos anterior para crear un módulo vacío Open Academy e instalarlo en Odoo.</p><ol ><li ><p >Ejecuta el comando <code >odoo-bin scaffold openacademy addons</code>.</p></li><li ><p >Adaptar el archivo de manifiesto para su módulo.</p></li><li ><p >No te preocupes de los otros archivos.</p></li></ol><div class="pq-patch"><em >openacademy/__manifest__.py</em><div class="pq-section"><div class="highlight-python"><div class="highlight"><pre><span></span><span class="hll"><span class="c1"># -*- coding: utf-8 -*-</span>
</span><span class="hll"><span class="p">{</span>
</span><span class="hll">    <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s2">&quot;Open Academy&quot;</span><span class="p">,</span>
</span><span class="hll">
</span><span class="hll">    <span class="s1">&#39;summary&#39;</span><span class="p">:</span> <span class="s2">&quot;&quot;&quot;Manage trainings&quot;&quot;&quot;</span><span class="p">,</span>
</span><span class="hll">
</span><span class="hll">    <span class="s1">&#39;description&#39;</span><span class="p">:</span> <span class="s2">&quot;&quot;&quot;</span>
</span><span class="hll"><span class="s2">        Open Academy module for managing trainings:</span>
</span><span class="hll"><span class="s2">            - training courses</span>
</span><span class="hll"><span class="s2">            - training sessions</span>
</span><span class="hll"><span class="s2">            - attendees registration</span>
</span><span class="hll"><span class="s2">    &quot;&quot;&quot;</span><span class="p">,</span>
</span><span class="hll">
</span><span class="hll">    <span class="s1">&#39;author&#39;</span><span class="p">:</span> <span class="s2">&quot;My Company&quot;</span><span class="p">,</span>
</span><span class="hll">    <span class="s1">&#39;website&#39;</span><span class="p">:</span> <span class="s2">&quot;http://www.yourcompany.com&quot;</span><span class="p">,</span>
</span><span class="hll">
</span><span class="hll">    <span class="c1"># Categories can be used to filter modules in modules listing</span>
</span><span class="hll">    <span class="c1"># Check https://github.com/odoo/odoo/blob/master/odoo/addons/base/module/module_data.xml</span>
</span><span class="hll">    <span class="c1"># for the full list</span>
</span><span class="hll">    <span class="s1">&#39;category&#39;</span><span class="p">:</span> <span class="s1">&#39;Test&#39;</span><span class="p">,</span>
</span><span class="hll">    <span class="s1">&#39;version&#39;</span><span class="p">:</span> <span class="s1">&#39;0.1&#39;</span><span class="p">,</span>
</span><span class="hll">
</span><span class="hll">    <span class="c1"># any module necessary for this one to work correctly</span>
</span><span class="hll">    <span class="s1">&#39;depends&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;base&#39;</span><span class="p">],</span>
</span><span class="hll">
</span><span class="hll">    <span class="c1"># always loaded</span>
</span><span class="hll">    <span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="p">[</span>
</span><span class="hll">        <span class="c1"># &#39;security/ir.model.access.csv&#39;,</span>
</span><span class="hll">        <span class="s1">&#39;templates.xml&#39;</span><span class="p">,</span>
</span><span class="hll">    <span class="p">],</span>
</span><span class="hll">    <span class="c1"># only loaded in demonstration mode</span>
</span><span class="hll">    <span class="s1">&#39;demo&#39;</span><span class="p">:</span> <span class="p">[</span>
</span><span class="hll">        <span class="s1">&#39;demo.xml&#39;</span><span class="p">,</span>
</span><span class="hll">    <span class="p">],</span>
</span><span class="hll"><span class="p">}</span>
</span></pre></div>
</div>
</div><em >openacademy/__init__.py</em><div class="pq-section"><div class="highlight-python"><div class="highlight"><pre><span></span><span class="hll"><span class="c1"># -*- coding: utf-8 -*-</span>
</span><span class="hll"><span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">controllers</span>
</span><span class="hll"><span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">models</span>
</span></pre></div>
</div>
</div><em >openacademy/controllers.py</em><div class="pq-section"><div class="highlight-python"><div class="highlight"><pre><span></span><span class="hll"><span class="c1"># -*- coding: utf-8 -*-</span>
</span><span class="hll"><span class="kn">from</span> <span class="nn">odoo</span> <span class="kn">import</span> <span class="n">http</span>
</span><span class="hll">
</span><span class="hll"><span class="c1"># class Openacademy(http.Controller):</span>
</span><span class="hll"><span class="c1">#     @http.route(&#39;/openacademy/openacademy/&#39;, auth=&#39;public&#39;)</span>
</span><span class="hll"><span class="c1">#     def index(self, **kw):</span>
</span><span class="hll"><span class="c1">#         return &quot;Hello, world&quot;</span>
</span><span class="hll">
</span><span class="hll"><span class="c1">#     @http.route(&#39;/openacademy/openacademy/objects/&#39;, auth=&#39;public&#39;)</span>
</span><span class="hll"><span class="c1">#     def list(self, **kw):</span>
</span><span class="hll"><span class="c1">#         return http.request.render(&#39;openacademy.listing&#39;, {</span>
</span><span class="hll"><span class="c1">#             &#39;root&#39;: &#39;/openacademy/openacademy&#39;,</span>
</span><span class="hll"><span class="c1">#             &#39;objects&#39;: http.request.env[&#39;openacademy.openacademy&#39;].search([]),</span>
</span><span class="hll"><span class="c1">#         })</span>
</span><span class="hll">
</span><span class="hll"><span class="c1">#     @http.route(&#39;/openacademy/openacademy/objects/&lt;model(&quot;openacademy.openacademy&quot;):obj&gt;/&#39;, auth=&#39;public&#39;)</span>
</span><span class="hll"><span class="c1">#     def object(self, obj, **kw):</span>
</span><span class="hll"><span class="c1">#         return http.request.render(&#39;openacademy.object&#39;, {</span>
</span><span class="hll"><span class="c1">#             &#39;object&#39;: obj</span>
</span><span class="hll"><span class="c1">#         })</span>
</span></pre></div>
</div>
</div><em >openacademy/demo.xml</em><div class="pq-section"><div class="highlight-xml"><div class="highlight"><pre><span></span><span class="hll"><span class="nt">&lt;odoo&gt;</span>
</span><span class="hll">
</span><span class="hll">        <span class="c">&lt;!--  --&gt;</span>
</span><span class="hll">        <span class="c">&lt;!--   &lt;record id=&quot;object0&quot; model=&quot;openacademy.openacademy&quot;&gt; --&gt;</span>
</span><span class="hll">        <span class="c">&lt;!--     &lt;field name=&quot;name&quot;&gt;Object 0&lt;/field&gt; --&gt;</span>
</span><span class="hll">        <span class="c">&lt;!--   &lt;/record&gt; --&gt;</span>
</span><span class="hll">        <span class="c">&lt;!--  --&gt;</span>
</span><span class="hll">        <span class="c">&lt;!--   &lt;record id=&quot;object1&quot; model=&quot;openacademy.openacademy&quot;&gt; --&gt;</span>
</span><span class="hll">        <span class="c">&lt;!--     &lt;field name=&quot;name&quot;&gt;Object 1&lt;/field&gt; --&gt;</span>
</span><span class="hll">        <span class="c">&lt;!--   &lt;/record&gt; --&gt;</span>
</span><span class="hll">        <span class="c">&lt;!--  --&gt;</span>
</span><span class="hll">        <span class="c">&lt;!--   &lt;record id=&quot;object2&quot; model=&quot;openacademy.openacademy&quot;&gt; --&gt;</span>
</span><span class="hll">        <span class="c">&lt;!--     &lt;field name=&quot;name&quot;&gt;Object 2&lt;/field&gt; --&gt;</span>
</span><span class="hll">        <span class="c">&lt;!--   &lt;/record&gt; --&gt;</span>
</span><span class="hll">        <span class="c">&lt;!--  --&gt;</span>
</span><span class="hll">        <span class="c">&lt;!--   &lt;record id=&quot;object3&quot; model=&quot;openacademy.openacademy&quot;&gt; --&gt;</span>
</span><span class="hll">        <span class="c">&lt;!--     &lt;field name=&quot;name&quot;&gt;Object 3&lt;/field&gt; --&gt;</span>
</span><span class="hll">        <span class="c">&lt;!--   &lt;/record&gt; --&gt;</span>
</span><span class="hll">        <span class="c">&lt;!--  --&gt;</span>
</span><span class="hll">        <span class="c">&lt;!--   &lt;record id=&quot;object4&quot; model=&quot;openacademy.openacademy&quot;&gt; --&gt;</span>
</span><span class="hll">        <span class="c">&lt;!--     &lt;field name=&quot;name&quot;&gt;Object 4&lt;/field&gt; --&gt;</span>
</span><span class="hll">        <span class="c">&lt;!--   &lt;/record&gt; --&gt;</span>
</span><span class="hll">        <span class="c">&lt;!--  --&gt;</span>
</span><span class="hll">
</span><span class="hll"><span class="nt">&lt;/odoo&gt;</span>
</span></pre></div>
</div>
</div><em >openacademy/models.py</em><div class="pq-section"><div class="highlight-python"><div class="highlight"><pre><span></span><span class="hll"><span class="c1"># -*- coding: utf-8 -*-</span>
</span><span class="hll">
</span><span class="hll"><span class="kn">from</span> <span class="nn">odoo</span> <span class="kn">import</span> <span class="n">models</span><span class="p">,</span> <span class="n">fields</span><span class="p">,</span> <span class="n">api</span>
</span><span class="hll">
</span><span class="hll"><span class="c1"># class openacademy(models.Model):</span>
</span><span class="hll"><span class="c1">#     _name = &#39;openacademy.openacademy&#39;</span>
</span><span class="hll">
</span><span class="hll"><span class="c1">#     name = fields.Char()</span>
</span></pre></div>
</div>
</div><em >openacademy/security/ir.model.access.csv</em><div class="pq-section"><div class="highlight-guess"><div class="highlight"><pre><span></span><span class="hll">id,name,model_id/id,group_id/id,perm_read,perm_write,perm_create,perm_unlink
</span><span class="hll">access_openacademy_openacademy,openacademy.openacademy,model_openacademy_openacademy,,1,0,0,0
</span></pre></div>
</div>
</div><em >openacademy/templates.xml</em><div class="pq-section"><div class="highlight-xml+django"><div class="highlight"><pre><span></span><span class="hll"><span class="nt">&lt;odoo&gt;</span>
</span><span class="hll">
</span><span class="hll">        <span class="c">&lt;!-- &lt;template id=&quot;listing&quot;&gt; --&gt;</span>
</span><span class="hll">        <span class="c">&lt;!--   &lt;ul&gt; --&gt;</span>
</span><span class="hll">        <span class="c">&lt;!--     &lt;li t-foreach=&quot;objects&quot; t-as=&quot;object&quot;&gt; --&gt;</span>
</span><span class="hll">        <span class="c">&lt;!--       &lt;a t-attf-href=&quot;</span><span class="cp">{{</span> <span class="nv">root</span> <span class="cp">}}</span><span class="c">/objects/</span><span class="cp">{{</span> <span class="nv">object.id</span> <span class="cp">}}</span><span class="c">&quot;&gt; --&gt;</span>
</span><span class="hll">        <span class="c">&lt;!--         &lt;t t-esc=&quot;object.display_name&quot;/&gt; --&gt;</span>
</span><span class="hll">        <span class="c">&lt;!--       &lt;/a&gt; --&gt;</span>
</span><span class="hll">        <span class="c">&lt;!--     &lt;/li&gt; --&gt;</span>
</span><span class="hll">        <span class="c">&lt;!--   &lt;/ul&gt; --&gt;</span>
</span><span class="hll">        <span class="c">&lt;!-- &lt;/template&gt; --&gt;</span>
</span><span class="hll">        <span class="c">&lt;!-- &lt;template id=&quot;object&quot;&gt; --&gt;</span>
</span><span class="hll">        <span class="c">&lt;!--   &lt;h1&gt;&lt;t t-esc=&quot;object.display_name&quot;/&gt;&lt;/h1&gt; --&gt;</span>
</span><span class="hll">        <span class="c">&lt;!--   &lt;dl&gt; --&gt;</span>
</span><span class="hll">        <span class="c">&lt;!--     &lt;t t-foreach=&quot;object._fields&quot; t-as=&quot;field&quot;&gt; --&gt;</span>
</span><span class="hll">        <span class="c">&lt;!--       &lt;dt&gt;&lt;t t-esc=&quot;field&quot;/&gt;&lt;/dt&gt; --&gt;</span>
</span><span class="hll">        <span class="c">&lt;!--       &lt;dd&gt;&lt;t t-esc=&quot;object[field]&quot;/&gt;&lt;/dd&gt; --&gt;</span>
</span><span class="hll">        <span class="c">&lt;!--     &lt;/t&gt; --&gt;</span>
</span><span class="hll">        <span class="c">&lt;!--   &lt;/dl&gt; --&gt;</span>
</span><span class="hll">        <span class="c">&lt;!-- &lt;/template&gt; --&gt;</span>
</span><span class="hll">
</span><span class="hll"><span class="nt">&lt;/odoo&gt;</span>
</span></pre></div>
</div>
</div></div></div></section><section id="object-relational-mapping"><h3 >Mapeo Objeto-Relacional</h3><p >Un componente clave de Odoo es el <abbr title="Object-Relational Mapping">ORM</abbr>. Esta capa evita escribir la mayoría del <abbr title="Structured Query Language">SQL</abbr> manualmente y proporciona extensibilidad y servicios de seguridad <a href="#rawsql" class="footnote-ref" id="id1">2</a>.</p><p >Los objetos de negocio se declaran como clases Python que extienden <a href="../reference/orm.html#odoo.models.Model" class="internal reference" title="odoo.models.Model"><code class="py xref py-class">Model</code></a> la cual los integra en el sistema automatizado de persistencia.</p><p >Módulos pueden ser configurados para establecer un número de atributos en su definición. El más importante atribute es <a href="../reference/orm.html#odoo.models.Model._name" class="internal reference" title="odoo.models.Model._name"><code class="py xref py-attr">_name</code></a> el cuál es requerido y define el nombre para el modelo en el sistema de Odoo. Aquí es mínimamente completada la definición de un modelo:</p><div class="highlight-default"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">odoo</span> <span class="k">import</span> <span class="n">models</span>
<span class="k">class</span> <span class="nc">MinimalModel</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
    <span class="n">_name</span> <span class="o">=</span> <span class="s1">&#39;test.model&#39;</span>
</pre></div>
</div>
</section><section id="model-fields"><h3 >Campos en el Modelo</h3><p >Los campos se utilizan para definir lo que puede almacenar el modelo y dónde. Los campos se definen como atributos en el modelo:</p><div class="highlight-default"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">odoo</span> <span class="k">import</span> <span class="n">models</span><span class="p">,</span> <span class="n">fields</span>

<span class="k">class</span> <span class="nc">LessMinimalModel</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
    <span class="n">_name</span> <span class="o">=</span> <span class="s1">&#39;test.model2&#39;</span>

    <span class="n">name</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">Char</span><span class="p">()</span>
</pre></div>
</div>
</section><section id="common-attributes"><h4 >Atributos comunes</h4><p >Así como en el modelo, los campos se pueden configurar pasando los atributos como parámetros normales:</p><div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">name</span> <span class="o">=</span> <span class="n">field</span><span class="o">.</span><span class="n">Char</span><span class="p">(</span><span class="n">required</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<p >Algunos atributos están disponibles en todos los campos, aquí están los más comunes:</p><dl ><dt ><code class="py xref py-attr">string</code> (<code >unicode</code>, default: field's name)</dt><dd ><p >La etiqueta del campo en la interfaz del usuario (lo que el usuario leerá).</p></dd><dt ><code class="py xref py-attr">required</code> (<code >bool</code>, default: <code >False</code>)</dt><dd ><p >Si es <code >Verdadero</code>, el campo no puede estar vacío, deberá tener un valor predeterminado o siempre se tendrá que asignar un valor al crear un registro.</p></dd><dt ><code class="py xref py-attr">help</code> (<code >unicode</code>, default: <code >''</code>)</dt><dd ><p >Formato largo, proporciona una información de ayuda en la interfaz de usuario.</p></dd><dt ><code class="py xref py-attr">index</code> (<code >bool</code>, default: <code >False</code>)</dt><dd ><p >Solicita a Odoo la creación de un índice <a href="http://use-the-index-luke.com/sql/preface" class="external reference">database index</a> en la columna.</p></dd></dl></section><section id="simple-fields"><h4 >Campos Simples</h4><p >En general hay dos categorías de campos: Los campos <em >”Simples&quot;</em> los cuales son valores atómicos almacenados directamente en la tabla correspondiente al modelo, y los campos <em >“Relacionales”</em> los cuales enlazan registros (registros del mismo modelo o de diferentes modelos).</p><p >Ejemplo de campos simples son los <a href="../reference/orm.html#odoo.fields.Boolean" class="internal reference" title="odoo.fields.Boolean"><code class="py xref py-class">Boolean</code></a>, <a href="../reference/orm.html#odoo.fields.Date" class="internal reference" title="odoo.fields.Date"><code class="py xref py-class">Date</code></a>, <a href="../reference/orm.html#odoo.fields.Char" class="internal reference" title="odoo.fields.Char"><code class="py xref py-class">Char</code></a>.</p></section><section id="reserved-fields"><h4 >Campos reservados</h4><p >Odoo crea algunos campos en todos los modelos <a href="#autofields" class="footnote-ref" id="id2">1</a>. Estos campos son manejados por el sistema y no deberían ser escritos. Ellos pueden ser leídos si representan alguna utilidad o son necesarios:</p><dl ><dt ><code class="py xref py-attr">id</code> (<code class="py xref py-class">Id</code>)</dt><dd ><p >El identificador único para un registro en su modelo.</p></dd><dt ><code class="py xref py-attr">create_date</code> (<a href="../reference/orm.html#odoo.fields.Datetime" class="internal reference" title="odoo.fields.Datetime"><code class="py xref py-class">Datetime</code></a>)</dt><dd ><p >Fecha de creación del registro.</p></dd><dt ><code class="py xref py-attr">create_uid</code> (<a href="../reference/orm.html#odoo.fields.Many2one" class="internal reference" title="odoo.fields.Many2one"><code class="py xref py-class">Many2one</code></a>)</dt><dd ><p >Usuario quien creó el registro.</p></dd><dt ><code class="py xref py-attr">write_date</code> (<a href="../reference/orm.html#odoo.fields.Datetime" class="internal reference" title="odoo.fields.Datetime"><code class="py xref py-class">Datetime</code></a>)</dt><dd ><p >Fecha de la última modificación del registro.</p></dd><dt ><code class="py xref py-attr">write_uid</code> (<a href="../reference/orm.html#odoo.fields.Many2one" class="internal reference" title="odoo.fields.Many2one"><code class="py xref py-class">Many2one</code></a>)</dt><dd ><p >usuario quien hizo la última modificación del registro.</p></dd></dl></section><section id="special-fields"><h4 >Campos Especiales</h4><p >Por defecto, Odoo también requiere un campo <code >name</code>  en todos los modelos para varios comportamientos de búsqueda y visualización. El campo utilizado para estos fines se puede reemplazar estableciendo <a href="../reference/orm.html#odoo.models.Model._rec_name" class="internal reference" title="odoo.models.Model._rec_name"><code class="py xref py-attr">_rec_name</code></a>.</p><div role="alert" class="alert-exercise alert"><p class="alert-title">Exercise</p><p >Define un modelo</p><p >Definir un nuevo modelo de datos <em >Curso</em> en el módulo <em >openacademy</em>. Un curso tiene un título y una descripción. Los cursos <em >deben</em> tener un título.</p><p >Edita el archivo <code >openacademy/models/models.py</code> incluyendo una clase <em >Course</em> (intenta nombrar todo en inglés).</p><div class="pq-patch"><em >openacademy/models.py</em><div class="pq-section"><div class="highlight-python"><div class="highlight"><pre><span></span>
<span class="kn">from</span> <span class="nn">odoo</span> <span class="kn">import</span> <span class="n">models</span><span class="p">,</span> <span class="n">fields</span><span class="p">,</span> <span class="n">api</span>
<span class="hll">
</span><span class="hll"><span class="k">class</span> <span class="nc">Course</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
</span>    <span class="n">_name</span> <span class="o">=</span> <span class="s1">&#39;openacademy.course&#39;</span>
<span class="hll">
</span><span class="hll">    <span class="n">name</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">Char</span><span class="p">(</span><span class="n">string</span><span class="o">=</span><span class="s2">&quot;Title&quot;</span><span class="p">,</span> <span class="n">required</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</span>    <span class="n">description</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">Text</span><span class="p">()</span>
</pre></div>
</div>
</div></div></div></section><section id="data-files"><h3 >Archivos de datos</h3><p >Odoo es un sistema altamente dirigido por datos. Aunque el comportamiento personalizado utiliza una parte de código <a href="http://python.org" class="external reference">Python</a> el valor de un módulo está en los datos que éste establece cuando se carga.</p><div role="alert" class="alert-info aphorism alert"><p class="alert-title">Truco</p><p >algunos módulos existen únicamente para agregar datos a Odoo</p></div><p >Los datos del módulo son declarados vía <a href="../reference/data.html#reference-data" class="internal reference"><span class="std std-ref">Archivos de Datos</span></a>, archivos XML con elementos <code >&lt;record&gt;</code>. Cada elemento <code >&lt;record&gt;</code> crea o actualiza registros en la base de datos.</p><div class="highlight-xml"><div class="highlight"><pre><span></span><span class="nt">&lt;odoo&gt;</span>

        <span class="nt">&lt;record</span> <span class="na">model=</span><span class="s">&quot;{model name}&quot;</span> <span class="na">id=</span><span class="s">&quot;{record identifier}&quot;</span><span class="nt">&gt;</span>
            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;{a field name}&quot;</span><span class="nt">&gt;</span>{a value}<span class="nt">&lt;/field&gt;</span>
        <span class="nt">&lt;/record&gt;</span>

<span class="nt">&lt;/odoo&gt;</span>
</pre></div>
</div>
<ul ><li ><p ><code >model</code> es el nombre para un registro en el modelo de Odoo.</p></li><li ><p ><code >id</code> es un <a href="../glossary.html#term-external-identifier" class="internal reference"><span class="std std-term xref">external identifier</span></a>, que permite hacer referencia a un registro (sin necesidad de conocer su identificador en base de datos).</p></li><li ><p ><code >&lt;field&gt;</code> los elementos tienen un <code >nombre</code> que es el nombre del campo en el modelo (por ejemplo,  <code >description</code>). Su cuerpo es el valor de campo.</p></li></ul><p >Los archivos de datos tienen que ser declarados en el archivo manifiesto para que puedan cargarse, ellos pueden ser declarados en la lista <code >'data'</code> (la cual siempre se carga) o en la lista <code >'demo'</code> (que se cargará solo cuando <em >modo demostración</em> esté habilitado).</p><div role="alert" class="alert-exercise alert"><p class="alert-title">Exercise</p><p >Definir los datos de demostración</p><p >Crear los datos de demostración llenando el model <em >Courses</em> con algunos pocos cursos.</p><p >Edite el archivo <code >openacademy/demo/demo.xml</code> para incluir algunos datos.</p><div class="pq-patch"><em >openacademy/demo.xml</em><div class="pq-section"><div class="highlight-xml"><div class="highlight"><pre><span></span><span class="nt">&lt;odoo&gt;</span>

<span class="hll">        <span class="nt">&lt;record</span> <span class="na">model=</span><span class="s">&quot;openacademy.course&quot;</span> <span class="na">id=</span><span class="s">&quot;course0&quot;</span><span class="nt">&gt;</span>
</span><span class="hll">            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;name&quot;</span><span class="nt">&gt;</span>Course 0<span class="nt">&lt;/field&gt;</span>
</span><span class="hll">            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;description&quot;</span><span class="nt">&gt;</span>Course 0&#39;s description
</span><span class="hll">
</span><span class="hll">Can have multiple lines
</span><span class="hll">            <span class="nt">&lt;/field&gt;</span>
</span><span class="hll">        <span class="nt">&lt;/record&gt;</span>
</span><span class="hll">        <span class="nt">&lt;record</span> <span class="na">model=</span><span class="s">&quot;openacademy.course&quot;</span> <span class="na">id=</span><span class="s">&quot;course1&quot;</span><span class="nt">&gt;</span>
</span><span class="hll">            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;name&quot;</span><span class="nt">&gt;</span>Course 1<span class="nt">&lt;/field&gt;</span>
</span><span class="hll">            <span class="c">&lt;!-- no description for this one --&gt;</span>
</span><span class="hll">        <span class="nt">&lt;/record&gt;</span>
</span><span class="hll">        <span class="nt">&lt;record</span> <span class="na">model=</span><span class="s">&quot;openacademy.course&quot;</span> <span class="na">id=</span><span class="s">&quot;course2&quot;</span><span class="nt">&gt;</span>
</span><span class="hll">            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;name&quot;</span><span class="nt">&gt;</span>Course 2<span class="nt">&lt;/field&gt;</span>
</span><span class="hll">            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;description&quot;</span><span class="nt">&gt;</span>Course 2&#39;s description<span class="nt">&lt;/field&gt;</span>
</span><span class="hll">        <span class="nt">&lt;/record&gt;</span>
</span>
<span class="nt">&lt;/odoo&gt;</span>
</pre></div>
</div>
</div></div></div></section><section id="actions-and-menus"><h3 >Acciones y menús</h3><p >Acciones y menús son registros regulares en la base de datos, usualmente a través de archivos de datos. Las acciones pueden ser disparadas en tres formas:</p><ol ><li ><p >haciendo click en los menús (enlazados a una acción específica)</p></li><li ><p >haciendo click en botones en las vistas (si éstos están conectados a acciones)</p></li><li ><p >como acciones contextuales en el objeto</p></li></ol><p >Ya que los menús son algo complejos de declarar, hay un acceso directo <code >&lt;menuitem&gt;</code> para declarar un <code >ir.ui.menu</code> y así enlazarlo con mayor facilidad a la acción correspondiente.</p><div class="highlight-xml"><div class="highlight"><pre><span></span><span class="nt">&lt;record</span> <span class="na">model=</span><span class="s">&quot;ir.actions.act_window&quot;</span> <span class="na">id=</span><span class="s">&quot;action_list_ideas&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;name&quot;</span><span class="nt">&gt;</span>Ideas<span class="nt">&lt;/field&gt;</span>
    <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;res_model&quot;</span><span class="nt">&gt;</span>idea.idea<span class="nt">&lt;/field&gt;</span>
    <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;view_mode&quot;</span><span class="nt">&gt;</span>tree,form<span class="nt">&lt;/field&gt;</span>
<span class="nt">&lt;/record&gt;</span>
<span class="nt">&lt;menuitem</span> <span class="na">id=</span><span class="s">&quot;menu_ideas&quot;</span> <span class="na">parent=</span><span class="s">&quot;menu_root&quot;</span> <span class="na">name=</span><span class="s">&quot;Ideas&quot;</span> <span class="na">sequence=</span><span class="s">&quot;10&quot;</span>
          <span class="na">action=</span><span class="s">&quot;action_list_ideas&quot;</span><span class="nt">/&gt;</span>
</pre></div>
</div>
<div role="alert" class="alert-danger aphorism alert"><p class="alert-title">Peligro</p><p >La acción debe declararse antes de declarar el menú correspondiente en el archivo XML.</p><p >Los archivos de datos se ejecutan secuencialmente, el <code >id</code> de la acción debe estar presente en la base de datos antes de que se pueda crear el menú.</p></div><div role="alert" class="alert-exercise alert"><p class="alert-title">Exercise</p><p >Definir nuevas entradas de menú</p><p >Definir nuevas entradas de menú para acceder a cursos bajo la entrada del menú OpenAcademy. Un usuario debería ser capaz de :</p><ul ><li ><p >ver una lista de todos los cursos</p></li><li ><p >crear o modificar cursos</p></li></ul><ol ><li ><p >Crear <code >openacademy/views/openacademy.xml</code> con una acción y los menús para activar la acción</p></li><li ><p >Añadirlo a la lista de <code >data</code> de <code >openacademy/__manifest__.py</code></p></li></ol><div class="pq-patch"><em >openacademy/__manifest__.py</em><div class="pq-section"><div class="highlight-python"><div class="highlight"><pre><span></span>    <span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="p">[</span>
        <span class="c1"># &#39;security/ir.model.access.csv&#39;,</span>
        <span class="s1">&#39;templates.xml&#39;</span><span class="p">,</span>
<span class="hll">        <span class="s1">&#39;views/openacademy.xml&#39;</span><span class="p">,</span>
</span>    <span class="p">],</span>
    <span class="c1"># only loaded in demonstration mode</span>
    <span class="s1">&#39;demo&#39;</span><span class="p">:</span> <span class="p">[</span>
</pre></div>
</div>
</div><em >openacademy/views/openacademy.xml</em><div class="pq-section"><div class="highlight-xml"><div class="highlight"><pre><span></span><span class="hll"><span class="cp">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span>
</span><span class="hll"><span class="nt">&lt;odoo&gt;</span>
</span><span class="hll">
</span><span class="hll">        <span class="c">&lt;!-- window action --&gt;</span>
</span><span class="hll">        <span class="c">&lt;!--</span>
</span><span class="hll"><span class="c">            The following tag is an action definition for a &quot;window action&quot;,</span>
</span><span class="hll"><span class="c">            that is an action opening a view or a set of views</span>
</span><span class="hll"><span class="c">        --&gt;</span>
</span><span class="hll">        <span class="nt">&lt;record</span> <span class="na">model=</span><span class="s">&quot;ir.actions.act_window&quot;</span> <span class="na">id=</span><span class="s">&quot;course_list_action&quot;</span><span class="nt">&gt;</span>
</span><span class="hll">            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;name&quot;</span><span class="nt">&gt;</span>Courses<span class="nt">&lt;/field&gt;</span>
</span><span class="hll">            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;res_model&quot;</span><span class="nt">&gt;</span>openacademy.course<span class="nt">&lt;/field&gt;</span>
</span><span class="hll">            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;view_type&quot;</span><span class="nt">&gt;</span>form<span class="nt">&lt;/field&gt;</span>
</span><span class="hll">            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;view_mode&quot;</span><span class="nt">&gt;</span>tree,form<span class="nt">&lt;/field&gt;</span>
</span><span class="hll">            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;help&quot;</span> <span class="na">type=</span><span class="s">&quot;html&quot;</span><span class="nt">&gt;</span>
</span><span class="hll">                <span class="nt">&lt;p</span> <span class="na">class=</span><span class="s">&quot;oe_view_nocontent_create&quot;</span><span class="nt">&gt;</span>Create the first course
</span><span class="hll">                <span class="nt">&lt;/p&gt;</span>
</span><span class="hll">            <span class="nt">&lt;/field&gt;</span>
</span><span class="hll">        <span class="nt">&lt;/record&gt;</span>
</span><span class="hll">
</span><span class="hll">        <span class="c">&lt;!-- top level menu: no parent --&gt;</span>
</span><span class="hll">        <span class="nt">&lt;menuitem</span> <span class="na">id=</span><span class="s">&quot;main_openacademy_menu&quot;</span> <span class="na">name=</span><span class="s">&quot;Open Academy&quot;</span><span class="nt">/&gt;</span>
</span><span class="hll">        <span class="c">&lt;!-- A first level in the left side menu is needed</span>
</span><span class="hll"><span class="c">             before using action= attribute --&gt;</span>
</span><span class="hll">        <span class="nt">&lt;menuitem</span> <span class="na">id=</span><span class="s">&quot;openacademy_menu&quot;</span> <span class="na">name=</span><span class="s">&quot;Open Academy&quot;</span>
</span><span class="hll">                  <span class="na">parent=</span><span class="s">&quot;main_openacademy_menu&quot;</span><span class="nt">/&gt;</span>
</span><span class="hll">        <span class="c">&lt;!-- the following menuitem should appear *after*</span>
</span><span class="hll"><span class="c">             its parent openacademy_menu and *after* its</span>
</span><span class="hll"><span class="c">             action course_list_action --&gt;</span>
</span><span class="hll">        <span class="nt">&lt;menuitem</span> <span class="na">id=</span><span class="s">&quot;courses_menu&quot;</span> <span class="na">name=</span><span class="s">&quot;Courses&quot;</span> <span class="na">parent=</span><span class="s">&quot;openacademy_menu&quot;</span>
</span><span class="hll">                  <span class="na">action=</span><span class="s">&quot;course_list_action&quot;</span><span class="nt">/&gt;</span>
</span><span class="hll">        <span class="c">&lt;!-- Full id location:</span>
</span><span class="hll"><span class="c">             action=&quot;openacademy.course_list_action&quot;</span>
</span><span class="hll"><span class="c">             It is not required when it is the same module --&gt;</span>
</span><span class="hll">
</span><span class="hll"><span class="nt">&lt;/odoo&gt;</span>
</span></pre></div>
</div>
</div></div></div></section><section id="basic-views"><h2 >Vistas Básicas</h2><p >Las vistas definen el modo que se muestran los registros de un modelo. Cada tipo de vista representa un modo de visualización (una lista de registros, un gráfico,…). Las vistas se pueden solicitar ya sea de manera genérica a través de su tipo (por ejemplo una <em >lista de clientes</em>) o especificando su id. Para solicitudes genéricas, se utilizará la vista con el tipo y la prioridad más baja (por lo que la vista de la prioridad más baja de cada tipo es la vista predeterminada para ese tipo).</p><p ><a href="../reference/views.html#reference-views-inheritance" class="internal reference"><span class="std std-ref">La herencia de Vistas</span></a> permite modificar vistas declaradas en otros lugares (agregar o quitar contenido).</p></section><section id="generic-view-declaration"><h3 >Declaración de vista genérica</h3><p >Una vista es declarada como un registro del modelo <code >ir.ui.view</code>. El tipo de vista es implícita en el elemento raíz del campo <code >arch</code>:</p><div class="highlight-xml"><div class="highlight"><pre><span></span><span class="nt">&lt;record</span> <span class="na">model=</span><span class="s">&quot;ir.ui.view&quot;</span> <span class="na">id=</span><span class="s">&quot;view_id&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;name&quot;</span><span class="nt">&gt;</span>view.name<span class="nt">&lt;/field&gt;</span>
    <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;model&quot;</span><span class="nt">&gt;</span>object_name<span class="nt">&lt;/field&gt;</span>
    <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;priority&quot;</span> <span class="na">eval=</span><span class="s">&quot;16&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;arch&quot;</span> <span class="na">type=</span><span class="s">&quot;xml&quot;</span><span class="nt">&gt;</span>
        <span class="c">&lt;!-- view content: &lt;form&gt;, &lt;tree&gt;, &lt;graph&gt;, ... --&gt;</span>
    <span class="nt">&lt;/field&gt;</span>
<span class="nt">&lt;/record&gt;</span>
</pre></div>
</div>
<div role="alert" class="alert-danger aphorism alert"><p class="alert-title">Peligro</p><p >El contenido de la vista es XML.</p><p >El campo <code >arch</code> debe ser declarado como <code >type =“xml”</code> para que sea analizado correctamente.</p></div></section><section id="tree-views"><h3 >Vistas de árbol</h3><p >Vistas de árbol, también llamadas vistas de lista, mostrarán registros en forma de tabla.</p><p >Su elemento raíz es <code >&lt;tree&gt;</code>. La forma más simple de la vista de árbol simplemente lista todos los campos a mostrar en la tabla (cada campo como una columna):</p><div class="highlight-xml"><div class="highlight"><pre><span></span><span class="nt">&lt;tree</span> <span class="na">string=</span><span class="s">&quot;Idea list&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;name&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;inventor_id&quot;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/tree&gt;</span>
</pre></div>
</div>
</section><section id="form-views"><h3 >Vistas de formulario</h3><p >Formularios se utilizan para crear y editar registros individuales.</p><p >Su elemento raíz es <code >&lt;form&gt;</code>. Ellos son compuestos de una estructura de alto nivel (groups, notebooks) y los elementos interactivos (buttons y fields):</p><div class="highlight-xml"><div class="highlight"><pre><span></span><span class="nt">&lt;form</span> <span class="na">string=</span><span class="s">&quot;Idea form&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;group</span> <span class="na">colspan=</span><span class="s">&quot;4&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;group</span> <span class="na">colspan=</span><span class="s">&quot;2&quot;</span> <span class="na">col=</span><span class="s">&quot;2&quot;</span><span class="nt">&gt;</span>
            <span class="nt">&lt;separator</span> <span class="na">string=</span><span class="s">&quot;General stuff&quot;</span> <span class="na">colspan=</span><span class="s">&quot;2&quot;</span><span class="nt">/&gt;</span>
            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;name&quot;</span><span class="nt">/&gt;</span>
            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;inventor_id&quot;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;/group&gt;</span>

        <span class="nt">&lt;group</span> <span class="na">colspan=</span><span class="s">&quot;2&quot;</span> <span class="na">col=</span><span class="s">&quot;2&quot;</span><span class="nt">&gt;</span>
            <span class="nt">&lt;separator</span> <span class="na">string=</span><span class="s">&quot;Dates&quot;</span> <span class="na">colspan=</span><span class="s">&quot;2&quot;</span><span class="nt">/&gt;</span>
            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;active&quot;</span><span class="nt">/&gt;</span>
            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;invent_date&quot;</span> <span class="na">readonly=</span><span class="s">&quot;1&quot;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;/group&gt;</span>

        <span class="nt">&lt;notebook</span> <span class="na">colspan=</span><span class="s">&quot;4&quot;</span><span class="nt">&gt;</span>
            <span class="nt">&lt;page</span> <span class="na">string=</span><span class="s">&quot;Description&quot;</span><span class="nt">&gt;</span>
                <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;description&quot;</span> <span class="na">nolabel=</span><span class="s">&quot;1&quot;</span><span class="nt">/&gt;</span>
            <span class="nt">&lt;/page&gt;</span>
        <span class="nt">&lt;/notebook&gt;</span>

        <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;state&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/group&gt;</span>
<span class="nt">&lt;/form&gt;</span>
</pre></div>
</div>
<div role="alert" class="alert-exercise alert"><p class="alert-title">Exercise</p><p >Personalizar vista de formulario usando XML</p><p >Crear una vista formulario propia para el objeto <code >Course</code>. Los datos mostrados deben ser: el nombre y la descripción del curso.</p><div class="pq-patch"><em >openacademy/views/openacademy.xml</em><div class="pq-section"><div class="highlight-xml"><div class="highlight"><pre><span></span><span class="cp">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span>
<span class="nt">&lt;odoo&gt;</span>

<span class="hll">        <span class="nt">&lt;record</span> <span class="na">model=</span><span class="s">&quot;ir.ui.view&quot;</span> <span class="na">id=</span><span class="s">&quot;course_form_view&quot;</span><span class="nt">&gt;</span>
</span><span class="hll">            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;name&quot;</span><span class="nt">&gt;</span>course.form<span class="nt">&lt;/field&gt;</span>
</span><span class="hll">            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;model&quot;</span><span class="nt">&gt;</span>openacademy.course<span class="nt">&lt;/field&gt;</span>
</span><span class="hll">            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;arch&quot;</span> <span class="na">type=</span><span class="s">&quot;xml&quot;</span><span class="nt">&gt;</span>
</span><span class="hll">                <span class="nt">&lt;form</span> <span class="na">string=</span><span class="s">&quot;Course Form&quot;</span><span class="nt">&gt;</span>
</span><span class="hll">                    <span class="nt">&lt;sheet&gt;</span>
</span><span class="hll">                        <span class="nt">&lt;group&gt;</span>
</span><span class="hll">                            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;name&quot;</span><span class="nt">/&gt;</span>
</span><span class="hll">                            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;description&quot;</span><span class="nt">/&gt;</span>
</span><span class="hll">                        <span class="nt">&lt;/group&gt;</span>
</span><span class="hll">                    <span class="nt">&lt;/sheet&gt;</span>
</span><span class="hll">                <span class="nt">&lt;/form&gt;</span>
</span><span class="hll">            <span class="nt">&lt;/field&gt;</span>
</span><span class="hll">        <span class="nt">&lt;/record&gt;</span>
</span><span class="hll">
</span>        <span class="c">&lt;!-- window action --&gt;</span>
        <span class="c">&lt;!--</span>
<span class="c">            The following tag is an action definition for a &quot;window action&quot;,</span>
</pre></div>
</div>
</div></div></div><div role="alert" class="alert-exercise alert"><p class="alert-title">Exercise</p><p >Notebooks</p><p >En la vista formulario de un curso, poner el campo <code >description</code> en una pestaña,  de tal manera que será más fácil añadir más tarde otras pestañas que contengan información adicional.</p><p >Modificar la vista de formulario de curso como sigue:</p><div class="pq-patch"><em >openacademy/views/openacademy.xml</em><div class="pq-section"><div class="highlight-xml"><div class="highlight"><pre><span></span>                    <span class="nt">&lt;sheet&gt;</span>
                        <span class="nt">&lt;group&gt;</span>
                            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;name&quot;</span><span class="nt">/&gt;</span>
                        <span class="nt">&lt;/group&gt;</span>
<span class="hll">                        <span class="nt">&lt;notebook&gt;</span>
</span><span class="hll">                            <span class="nt">&lt;page</span> <span class="na">string=</span><span class="s">&quot;Description&quot;</span><span class="nt">&gt;</span>
</span><span class="hll">                                <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;description&quot;</span><span class="nt">/&gt;</span>
</span><span class="hll">                            <span class="nt">&lt;/page&gt;</span>
</span><span class="hll">                            <span class="nt">&lt;page</span> <span class="na">string=</span><span class="s">&quot;About&quot;</span><span class="nt">&gt;</span>
</span><span class="hll">                                This is an example of notebooks
</span><span class="hll">                            <span class="nt">&lt;/page&gt;</span>
</span><span class="hll">                        <span class="nt">&lt;/notebook&gt;</span>
</span>                    <span class="nt">&lt;/sheet&gt;</span>
                <span class="nt">&lt;/form&gt;</span>
            <span class="nt">&lt;/field&gt;</span>
</pre></div>
</div>
</div></div></div><p >Vistas de formulario también pueden utilizar HTML plano para diseños más flexibles:</p><div class="highlight-xml"><div class="highlight"><pre><span></span><span class="nt">&lt;form</span> <span class="na">string=</span><span class="s">&quot;Idea Form&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;header&gt;</span>
        <span class="nt">&lt;button</span> <span class="na">string=</span><span class="s">&quot;Confirm&quot;</span> <span class="na">type=</span><span class="s">&quot;object&quot;</span> <span class="na">name=</span><span class="s">&quot;action_confirm&quot;</span>
                <span class="na">states=</span><span class="s">&quot;draft&quot;</span> <span class="na">class=</span><span class="s">&quot;oe_highlight&quot;</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;button</span> <span class="na">string=</span><span class="s">&quot;Mark as done&quot;</span> <span class="na">type=</span><span class="s">&quot;object&quot;</span> <span class="na">name=</span><span class="s">&quot;action_done&quot;</span>
                <span class="na">states=</span><span class="s">&quot;confirmed&quot;</span> <span class="na">class=</span><span class="s">&quot;oe_highlight&quot;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;button</span> <span class="na">string=</span><span class="s">&quot;Reset to draft&quot;</span> <span class="na">type=</span><span class="s">&quot;object&quot;</span> <span class="na">name=</span><span class="s">&quot;action_draft&quot;</span>
                <span class="na">states=</span><span class="s">&quot;confirmed,done&quot;</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;state&quot;</span> <span class="na">widget=</span><span class="s">&quot;statusbar&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/header&gt;</span>
    <span class="nt">&lt;sheet&gt;</span>
        <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">&quot;oe_title&quot;</span><span class="nt">&gt;</span>
            <span class="nt">&lt;label</span> <span class="na">for=</span><span class="s">&quot;name&quot;</span> <span class="na">class=</span><span class="s">&quot;oe_edit_only&quot;</span> <span class="na">string=</span><span class="s">&quot;Idea Name&quot;</span> <span class="nt">/&gt;</span>
            <span class="nt">&lt;h1&gt;&lt;field</span> <span class="na">name=</span><span class="s">&quot;name&quot;</span> <span class="nt">/&gt;&lt;/h1&gt;</span>
        <span class="nt">&lt;/div&gt;</span>
        <span class="nt">&lt;separator</span> <span class="na">string=</span><span class="s">&quot;General&quot;</span> <span class="na">colspan=</span><span class="s">&quot;2&quot;</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;group</span> <span class="na">colspan=</span><span class="s">&quot;2&quot;</span> <span class="na">col=</span><span class="s">&quot;2&quot;</span><span class="nt">&gt;</span>
            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;description&quot;</span> <span class="na">placeholder=</span><span class="s">&quot;Idea description...&quot;</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;/group&gt;</span>
    <span class="nt">&lt;/sheet&gt;</span>
<span class="nt">&lt;/form&gt;</span>
</pre></div>
</div>
</section><section id="search-views"><h3 >Vistas de búsqueda</h3><p >Vistas de búsqueda personalizan los campos de búsqueda asociados con la vista de lista (y otras vistas agregadas). Su elemento raíz es <code >&lt;search&gt;</code> y están compuestos por los campos definidos los cuáles pueden ser buscados:</p><div class="highlight-xml"><div class="highlight"><pre><span></span><span class="nt">&lt;search&gt;</span>
    <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;name&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;inventor_id&quot;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/search&gt;</span>
</pre></div>
</div>
<p >Si no existe ninguna vista de búsqueda para el modelo, Odoo genera automáticamente una la cual permite la búsqueda por el campo <code >name</code>.</p><div role="alert" class="alert-exercise alert"><p class="alert-title">Exercise</p><p >Buscar Cursos</p><p >Permite buscar cursos basados en el título o la descripción.</p><div class="pq-patch"><em >openacademy/views/openacademy.xml</em><div class="pq-section"><div class="highlight-xml"><div class="highlight"><pre><span></span>            <span class="nt">&lt;/field&gt;</span>
        <span class="nt">&lt;/record&gt;</span>

<span class="hll">        <span class="nt">&lt;record</span> <span class="na">model=</span><span class="s">&quot;ir.ui.view&quot;</span> <span class="na">id=</span><span class="s">&quot;course_search_view&quot;</span><span class="nt">&gt;</span>
</span><span class="hll">            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;name&quot;</span><span class="nt">&gt;</span>course.search<span class="nt">&lt;/field&gt;</span>
</span><span class="hll">            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;model&quot;</span><span class="nt">&gt;</span>openacademy.course<span class="nt">&lt;/field&gt;</span>
</span><span class="hll">            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;arch&quot;</span> <span class="na">type=</span><span class="s">&quot;xml&quot;</span><span class="nt">&gt;</span>
</span><span class="hll">                <span class="nt">&lt;search&gt;</span>
</span><span class="hll">                    <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;name&quot;</span><span class="nt">/&gt;</span>
</span><span class="hll">                    <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;description&quot;</span><span class="nt">/&gt;</span>
</span><span class="hll">                <span class="nt">&lt;/search&gt;</span>
</span><span class="hll">            <span class="nt">&lt;/field&gt;</span>
</span><span class="hll">        <span class="nt">&lt;/record&gt;</span>
</span><span class="hll">
</span>        <span class="c">&lt;!-- window action --&gt;</span>
        <span class="c">&lt;!--</span>
<span class="c">            The following tag is an action definition for a &quot;window action&quot;,</span>
</pre></div>
</div>
</div></div></div></section><section id="relations-between-models"><h2 >Relaciones entre modelos</h2><p >Un registro de un modelo puede estar relacionado con un registro de otro modelo. Por ejemplo, un registro de orden de venta se relaciona con un registro de cliente que contiene los datos del cliente; también está relacionado con los registros de línea de orden de venta.</p><div role="alert" class="alert-exercise alert"><p class="alert-title">Exercise</p><p >Crear un modelo <code >Session</code></p><p >Para el módulo Open Academy, consideramos un modelo <em >sessions</em>: una sesión es cuando un curso es impartido en un momento dado para un público determinado.</p><p >Crear un modelo para <em >sessions</em>. Una sesión tiene un nombre, una fecha de inicio, una duración y un número de asientos. Agregue una acción y un elemento de menú a los mismos. Visualizar el nuevo modelo a través de un menú.</p><ol ><li ><p >Crear la clase <em >Session</em> en <code >openacademy/models/models.py</code>.</p></li><li ><p >Añadir el acceso al objeto <em >session</em> en <code >openacademy/view/openacademy.xml</code>.</p></li></ol><div class="pq-patch"><em >openacademy/models.py</em><div class="pq-section"><div class="highlight-python"><div class="highlight"><pre><span></span>
    <span class="n">name</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">Char</span><span class="p">(</span><span class="n">string</span><span class="o">=</span><span class="s2">&quot;Title&quot;</span><span class="p">,</span> <span class="n">required</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="hll">    <span class="n">description</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">Text</span><span class="p">()</span>
</span><span class="hll">
</span><span class="hll">
</span><span class="hll"><span class="k">class</span> <span class="nc">Session</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
</span><span class="hll">    <span class="n">_name</span> <span class="o">=</span> <span class="s1">&#39;openacademy.session&#39;</span>
</span><span class="hll">
</span><span class="hll">    <span class="n">name</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">Char</span><span class="p">(</span><span class="n">required</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</span><span class="hll">    <span class="n">start_date</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">Date</span><span class="p">()</span>
</span><span class="hll">    <span class="n">duration</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">Float</span><span class="p">(</span><span class="n">digits</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Duration in days&quot;</span><span class="p">)</span>
</span>    <span class="n">seats</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">Integer</span><span class="p">(</span><span class="n">string</span><span class="o">=</span><span class="s2">&quot;Number of seats&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div><em >openacademy/views/openacademy.xml</em><div class="pq-section"><div class="highlight-xml"><div class="highlight"><pre><span></span>        <span class="c">&lt;!-- Full id location:</span>
<span class="c">             action=&quot;openacademy.course_list_action&quot;</span>
<span class="c">             It is not required when it is the same module --&gt;</span>
<span class="hll">
</span><span class="hll">        <span class="c">&lt;!-- session form view --&gt;</span>
</span><span class="hll">        <span class="nt">&lt;record</span> <span class="na">model=</span><span class="s">&quot;ir.ui.view&quot;</span> <span class="na">id=</span><span class="s">&quot;session_form_view&quot;</span><span class="nt">&gt;</span>
</span><span class="hll">            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;name&quot;</span><span class="nt">&gt;</span>session.form<span class="nt">&lt;/field&gt;</span>
</span><span class="hll">            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;model&quot;</span><span class="nt">&gt;</span>openacademy.session<span class="nt">&lt;/field&gt;</span>
</span><span class="hll">            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;arch&quot;</span> <span class="na">type=</span><span class="s">&quot;xml&quot;</span><span class="nt">&gt;</span>
</span><span class="hll">                <span class="nt">&lt;form</span> <span class="na">string=</span><span class="s">&quot;Session Form&quot;</span><span class="nt">&gt;</span>
</span><span class="hll">                    <span class="nt">&lt;sheet&gt;</span>
</span><span class="hll">                        <span class="nt">&lt;group&gt;</span>
</span><span class="hll">                            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;name&quot;</span><span class="nt">/&gt;</span>
</span><span class="hll">                            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;start_date&quot;</span><span class="nt">/&gt;</span>
</span><span class="hll">                            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;duration&quot;</span><span class="nt">/&gt;</span>
</span><span class="hll">                            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;seats&quot;</span><span class="nt">/&gt;</span>
</span><span class="hll">                        <span class="nt">&lt;/group&gt;</span>
</span><span class="hll">                    <span class="nt">&lt;/sheet&gt;</span>
</span><span class="hll">                <span class="nt">&lt;/form&gt;</span>
</span><span class="hll">            <span class="nt">&lt;/field&gt;</span>
</span><span class="hll">        <span class="nt">&lt;/record&gt;</span>
</span><span class="hll">
</span><span class="hll">        <span class="nt">&lt;record</span> <span class="na">model=</span><span class="s">&quot;ir.actions.act_window&quot;</span> <span class="na">id=</span><span class="s">&quot;session_list_action&quot;</span><span class="nt">&gt;</span>
</span><span class="hll">            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;name&quot;</span><span class="nt">&gt;</span>Sessions<span class="nt">&lt;/field&gt;</span>
</span><span class="hll">            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;res_model&quot;</span><span class="nt">&gt;</span>openacademy.session<span class="nt">&lt;/field&gt;</span>
</span><span class="hll">            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;view_type&quot;</span><span class="nt">&gt;</span>form<span class="nt">&lt;/field&gt;</span>
</span><span class="hll">            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;view_mode&quot;</span><span class="nt">&gt;</span>tree,form<span class="nt">&lt;/field&gt;</span>
</span><span class="hll">        <span class="nt">&lt;/record&gt;</span>
</span><span class="hll">
</span><span class="hll">        <span class="nt">&lt;menuitem</span> <span class="na">id=</span><span class="s">&quot;session_menu&quot;</span> <span class="na">name=</span><span class="s">&quot;Sessions&quot;</span>
</span><span class="hll">                  <span class="na">parent=</span><span class="s">&quot;openacademy_menu&quot;</span>
</span><span class="hll">                  <span class="na">action=</span><span class="s">&quot;session_list_action&quot;</span><span class="nt">/&gt;</span>
</span>
<span class="nt">&lt;/odoo&gt;</span>
</pre></div>
</div>
</div></div><div role="alert" class="alert-info alert"><p class="alert-title">Nota</p><p ><code >digits=(6, 2)</code> especifica la precisión de un número flotante: 6 es el número total de dígitos, mientras que 2 es el número de dígitos después de la coma. Tenga en cuenta que en el resultado los dígitos antes de la coma es un máximo de 4</p></div></div></section><section id="relational-fields"><h3 >Campos Relacionales</h3><p >Los campos relacionales vinculan registros, ya sea del mismo modelo (jerarquías) o entre diferentes modelos.</p><p >Los tipos de campos relacionales son:</p><dl ><dt ><a href="../reference/orm.html#odoo.fields.Many2one" class="internal reference" title="odoo.fields.Many2one"><code class="py xref py-class">Many2one(other_model, ondelete='set null')</code></a></dt><dd ><p >Un simple enlace a otro objeto:</p><div class="highlight-default"><div class="highlight"><pre><span></span><span class="nb">print</span> <span class="n">foo</span><span class="o">.</span><span class="n">other_id</span><span class="o">.</span><span class="n">name</span>
</pre></div>
</div>
<div role="alert" class="alert-go_to alert"><p class="alert-title">Ver también</p><p ><a href="http://www.postgresql.org/docs/9.3/static/tutorial-fk.html" class="external reference alert-link">foreign keys</a></p></div></dd><dt ><a href="../reference/orm.html#odoo.fields.One2many" class="internal reference" title="odoo.fields.One2many"><code class="py xref py-class">One2many(other_model, related_field)</code></a></dt><dd ><p >Una relación virtual, inverso a un <a href="../reference/orm.html#odoo.fields.Many2one" class="internal reference" title="odoo.fields.Many2one"><code class="py xref py-class">Many2one</code></a>. Un <a href="../reference/orm.html#odoo.fields.One2many" class="internal reference" title="odoo.fields.One2many"><code class="py xref py-class">One2many</code></a> se comporta como contenedor de registros, accediendo a sus resultados en un (posiblemente vacío) conjunto de registros:</p><div class="highlight-default"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">other</span> <span class="ow">in</span> <span class="n">foo</span><span class="o">.</span><span class="n">other_ids</span><span class="p">:</span>
    <span class="nb">print</span> <span class="n">other</span><span class="o">.</span><span class="n">name</span>
</pre></div>
</div>
<div role="alert" class="alert-danger alert"><p class="alert-title">Peligro</p><p >Debido a que un <a href="../reference/orm.html#odoo.fields.One2many" class="internal alert-link reference" title="odoo.fields.One2many"><code class="py xref py-class">One2many</code></a> es una relación virtual, <em >debe</em> haber un campo <a href="../reference/orm.html#odoo.fields.Many2one" class="internal alert-link reference" title="odoo.fields.Many2one"><code class="py xref py-class">Many2one</code></a> en <code class="samp"><em >other_model</em></code>, y su nombre <em >debe</em> ser <code class="samp"><em >related_field</em></code></p></div></dd><dt ><a href="../reference/orm.html#odoo.fields.Many2many" class="internal reference" title="odoo.fields.Many2many"><code class="py xref py-class">Many2many(other_model)</code></a></dt><dd ><p >Relación bidireccional múltiple, cualquier registro en un lado puede estar relacionada con cualquier número de registros en el otro lado. Se comporta como un contenedor de registros, al acceder a él también se puede traducir en una lista vacía de registros:</p><div class="highlight-default"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">other</span> <span class="ow">in</span> <span class="n">foo</span><span class="o">.</span><span class="n">other_ids</span><span class="p">:</span>
    <span class="nb">print</span> <span class="n">other</span><span class="o">.</span><span class="n">name</span>
</pre></div>
</div>
</dd></dl><div role="alert" class="alert-exercise alert"><p class="alert-title">Exercise</p><p >Relaciones Many2one</p><p >Usando un many2one, modificar los modelos <em >Course</em> y <em >Session</em>  para reflejar su relación con otros modelos:</p><ul ><li ><p >Un curso tiene un usuario <em >responsible</em>; el valor de ese campo es un registro del modelo integrado <code >res.users</code>.</p></li><li ><p >Una sesión tiene un <em >instructor</em>; el valor de ese campo es un registro del modelo integrado <code >res.partner</code>.</p></li><li ><p >Una sesión se refiere a un <em >course</em>; el valor de ese campo es un registro del modelo <code >openacademy.course</code> y es requerido.</p></li><li ><p >Adaptar las vistas.</p></li></ul><ol ><li ><p >Añadir los campos <code >Many2one</code> correspondientes a los modelos, y</p></li><li ><p >agregarlos en las vistas.</p></li></ol><div class="pq-patch"><em >openacademy/models.py</em><div class="pq-section"><div class="highlight-python"><div class="highlight"><pre><span></span>    <span class="n">name</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">Char</span><span class="p">(</span><span class="n">string</span><span class="o">=</span><span class="s2">&quot;Title&quot;</span><span class="p">,</span> <span class="n">required</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
    <span class="n">description</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">Text</span><span class="p">()</span>

<span class="hll">    <span class="n">responsible_id</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">Many2one</span><span class="p">(</span><span class="s1">&#39;res.users&#39;</span><span class="p">,</span>
</span><span class="hll">        <span class="n">ondelete</span><span class="o">=</span><span class="s1">&#39;set null&#39;</span><span class="p">,</span> <span class="n">string</span><span class="o">=</span><span class="s2">&quot;Responsible&quot;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</span><span class="hll">
</span>
<span class="k">class</span> <span class="nc">Session</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
    <span class="n">_name</span> <span class="o">=</span> <span class="s1">&#39;openacademy.session&#39;</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span></span>    <span class="n">start_date</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">Date</span><span class="p">()</span>
    <span class="n">duration</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">Float</span><span class="p">(</span><span class="n">digits</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Duration in days&quot;</span><span class="p">)</span>
    <span class="n">seats</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">Integer</span><span class="p">(</span><span class="n">string</span><span class="o">=</span><span class="s2">&quot;Number of seats&quot;</span><span class="p">)</span>
<span class="hll">
</span><span class="hll">    <span class="n">instructor_id</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">Many2one</span><span class="p">(</span><span class="s1">&#39;res.partner&#39;</span><span class="p">,</span> <span class="n">string</span><span class="o">=</span><span class="s2">&quot;Instructor&quot;</span><span class="p">)</span>
</span><span class="hll">    <span class="n">course_id</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">Many2one</span><span class="p">(</span><span class="s1">&#39;openacademy.course&#39;</span><span class="p">,</span>
</span><span class="hll">        <span class="n">ondelete</span><span class="o">=</span><span class="s1">&#39;cascade&#39;</span><span class="p">,</span> <span class="n">string</span><span class="o">=</span><span class="s2">&quot;Course&quot;</span><span class="p">,</span> <span class="n">required</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</span></pre></div>
</div>
</div><em >openacademy/views/openacademy.xml</em><div class="pq-section"><div class="highlight-xml"><div class="highlight"><pre><span></span>                    <span class="nt">&lt;sheet&gt;</span>
                        <span class="nt">&lt;group&gt;</span>
                            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;name&quot;</span><span class="nt">/&gt;</span>
<span class="hll">                            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;responsible_id&quot;</span><span class="nt">/&gt;</span>
</span>                        <span class="nt">&lt;/group&gt;</span>
                        <span class="nt">&lt;notebook&gt;</span>
                            <span class="nt">&lt;page</span> <span class="na">string=</span><span class="s">&quot;Description&quot;</span><span class="nt">&gt;</span>
</pre></div>
</div>
<div class="highlight-xml"><div class="highlight"><pre><span></span>            <span class="nt">&lt;/field&gt;</span>
        <span class="nt">&lt;/record&gt;</span>

<span class="hll">        <span class="c">&lt;!-- override the automatically generated list view for courses --&gt;</span>
</span><span class="hll">        <span class="nt">&lt;record</span> <span class="na">model=</span><span class="s">&quot;ir.ui.view&quot;</span> <span class="na">id=</span><span class="s">&quot;course_tree_view&quot;</span><span class="nt">&gt;</span>
</span><span class="hll">            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;name&quot;</span><span class="nt">&gt;</span>course.tree<span class="nt">&lt;/field&gt;</span>
</span><span class="hll">            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;model&quot;</span><span class="nt">&gt;</span>openacademy.course<span class="nt">&lt;/field&gt;</span>
</span><span class="hll">            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;arch&quot;</span> <span class="na">type=</span><span class="s">&quot;xml&quot;</span><span class="nt">&gt;</span>
</span><span class="hll">                <span class="nt">&lt;tree</span> <span class="na">string=</span><span class="s">&quot;Course Tree&quot;</span><span class="nt">&gt;</span>
</span><span class="hll">                    <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;name&quot;</span><span class="nt">/&gt;</span>
</span><span class="hll">                    <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;responsible_id&quot;</span><span class="nt">/&gt;</span>
</span><span class="hll">                <span class="nt">&lt;/tree&gt;</span>
</span><span class="hll">            <span class="nt">&lt;/field&gt;</span>
</span><span class="hll">        <span class="nt">&lt;/record&gt;</span>
</span><span class="hll">
</span>        <span class="c">&lt;!-- window action --&gt;</span>
        <span class="c">&lt;!--</span>
<span class="c">            The following tag is an action definition for a &quot;window action&quot;,</span>
</pre></div>
</div>
<div class="highlight-xml"><div class="highlight"><pre><span></span>                <span class="nt">&lt;form</span> <span class="na">string=</span><span class="s">&quot;Session Form&quot;</span><span class="nt">&gt;</span>
                    <span class="nt">&lt;sheet&gt;</span>
                        <span class="nt">&lt;group&gt;</span>
<span class="hll">                            <span class="nt">&lt;group</span> <span class="na">string=</span><span class="s">&quot;General&quot;</span><span class="nt">&gt;</span>
</span><span class="hll">                                <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;course_id&quot;</span><span class="nt">/&gt;</span>
</span><span class="hll">                                <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;name&quot;</span><span class="nt">/&gt;</span>
</span><span class="hll">                                <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;instructor_id&quot;</span><span class="nt">/&gt;</span>
</span><span class="hll">                            <span class="nt">&lt;/group&gt;</span>
</span><span class="hll">                            <span class="nt">&lt;group</span> <span class="na">string=</span><span class="s">&quot;Schedule&quot;</span><span class="nt">&gt;</span>
</span><span class="hll">                                <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;start_date&quot;</span><span class="nt">/&gt;</span>
</span><span class="hll">                                <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;duration&quot;</span><span class="nt">/&gt;</span>
</span><span class="hll">                                <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;seats&quot;</span><span class="nt">/&gt;</span>
</span><span class="hll">                            <span class="nt">&lt;/group&gt;</span>
</span>                        <span class="nt">&lt;/group&gt;</span>
                    <span class="nt">&lt;/sheet&gt;</span>
                <span class="nt">&lt;/form&gt;</span>
            <span class="nt">&lt;/field&gt;</span>
        <span class="nt">&lt;/record&gt;</span>

<span class="hll">        <span class="c">&lt;!-- session tree/list view --&gt;</span>
</span><span class="hll">        <span class="nt">&lt;record</span> <span class="na">model=</span><span class="s">&quot;ir.ui.view&quot;</span> <span class="na">id=</span><span class="s">&quot;session_tree_view&quot;</span><span class="nt">&gt;</span>
</span><span class="hll">            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;name&quot;</span><span class="nt">&gt;</span>session.tree<span class="nt">&lt;/field&gt;</span>
</span><span class="hll">            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;model&quot;</span><span class="nt">&gt;</span>openacademy.session<span class="nt">&lt;/field&gt;</span>
</span><span class="hll">            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;arch&quot;</span> <span class="na">type=</span><span class="s">&quot;xml&quot;</span><span class="nt">&gt;</span>
</span><span class="hll">                <span class="nt">&lt;tree</span> <span class="na">string=</span><span class="s">&quot;Session Tree&quot;</span><span class="nt">&gt;</span>
</span><span class="hll">                    <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;name&quot;</span><span class="nt">/&gt;</span>
</span><span class="hll">                    <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;course_id&quot;</span><span class="nt">/&gt;</span>
</span><span class="hll">                <span class="nt">&lt;/tree&gt;</span>
</span><span class="hll">            <span class="nt">&lt;/field&gt;</span>
</span><span class="hll">        <span class="nt">&lt;/record&gt;</span>
</span><span class="hll">
</span>        <span class="nt">&lt;record</span> <span class="na">model=</span><span class="s">&quot;ir.actions.act_window&quot;</span> <span class="na">id=</span><span class="s">&quot;session_list_action&quot;</span><span class="nt">&gt;</span>
            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;name&quot;</span><span class="nt">&gt;</span>Sessions<span class="nt">&lt;/field&gt;</span>
            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;res_model&quot;</span><span class="nt">&gt;</span>openacademy.session<span class="nt">&lt;/field&gt;</span>
</pre></div>
</div>
</div></div></div><div role="alert" class="alert-exercise alert"><p class="alert-title">Exercise</p><p >Relaciones One2Many inversas</p><p >Utilizando el campo relacional inverso one2many, modificar los modelos para reflejar la relación entre los cursos y sesiones.</p><ol ><li ><p >Modificar la clase <code >Course</code>, y</p></li><li ><p >agregar el campo en la vista de formulario del curso.</p></li></ol><div class="pq-patch"><em >openacademy/models.py</em><div class="pq-section"><div class="highlight-python"><div class="highlight"><pre><span></span>
    <span class="n">responsible_id</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">Many2one</span><span class="p">(</span><span class="s1">&#39;res.users&#39;</span><span class="p">,</span>
<span class="hll">        <span class="n">ondelete</span><span class="o">=</span><span class="s1">&#39;set null&#39;</span><span class="p">,</span> <span class="n">string</span><span class="o">=</span><span class="s2">&quot;Responsible&quot;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</span><span class="hll">    <span class="n">session_ids</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">One2many</span><span class="p">(</span>
</span>        <span class="s1">&#39;openacademy.session&#39;</span><span class="p">,</span> <span class="s1">&#39;course_id&#39;</span><span class="p">,</span> <span class="n">string</span><span class="o">=</span><span class="s2">&quot;Sessions&quot;</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">Session</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
</pre></div>
</div>
</div><em >openacademy/views/openacademy.xml</em><div class="pq-section"><div class="highlight-xml"><div class="highlight"><pre><span></span>                            <span class="nt">&lt;page</span> <span class="na">string=</span><span class="s">&quot;Description&quot;</span><span class="nt">&gt;</span>
                                <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;description&quot;</span><span class="nt">/&gt;</span>
                            <span class="nt">&lt;/page&gt;</span>
<span class="hll">                            <span class="nt">&lt;page</span> <span class="na">string=</span><span class="s">&quot;Sessions&quot;</span><span class="nt">&gt;</span>
</span><span class="hll">                                <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;session_ids&quot;</span><span class="nt">&gt;</span>
</span><span class="hll">                                    <span class="nt">&lt;tree</span> <span class="na">string=</span><span class="s">&quot;Registered sessions&quot;</span><span class="nt">&gt;</span>
</span><span class="hll">                                        <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;name&quot;</span><span class="nt">/&gt;</span>
</span><span class="hll">                                        <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;instructor_id&quot;</span><span class="nt">/&gt;</span>
</span><span class="hll">                                    <span class="nt">&lt;/tree&gt;</span>
</span><span class="hll">                                <span class="nt">&lt;/field&gt;</span>
</span>                            <span class="nt">&lt;/page&gt;</span>
                        <span class="nt">&lt;/notebook&gt;</span>
                    <span class="nt">&lt;/sheet&gt;</span>
</pre></div>
</div>
</div></div></div><div role="alert" class="alert-exercise alert"><p class="alert-title">Exercise</p><p >Relaciones Many2Many múltiples</p><p >Utilizando el campo relacional Many2Many, modificar el modelo de <em >Session</em> para relacionar cada sesión a un conjunto de <em >attendees</em>. Los asistentes estarán representados por los registros <em >partners</em>, por lo que se relacionan con el modelo <code >res.partner</code>. Adaptar las vistas en consecuencia.</p><ol ><li ><p >Modificar la clase `` Session``, y</p></li><li ><p >agregar el campo en la vista de formulario del curso.</p></li></ol><div class="pq-patch"><em >openacademy/models.py</em><div class="pq-section"><div class="highlight-python"><div class="highlight"><pre><span></span>    <span class="n">instructor_id</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">Many2one</span><span class="p">(</span><span class="s1">&#39;res.partner&#39;</span><span class="p">,</span> <span class="n">string</span><span class="o">=</span><span class="s2">&quot;Instructor&quot;</span><span class="p">)</span>
    <span class="n">course_id</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">Many2one</span><span class="p">(</span><span class="s1">&#39;openacademy.course&#39;</span><span class="p">,</span>
        <span class="n">ondelete</span><span class="o">=</span><span class="s1">&#39;cascade&#39;</span><span class="p">,</span> <span class="n">string</span><span class="o">=</span><span class="s2">&quot;Course&quot;</span><span class="p">,</span> <span class="n">required</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="hll">    <span class="n">attendee_ids</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">Many2many</span><span class="p">(</span><span class="s1">&#39;res.partner&#39;</span><span class="p">,</span> <span class="n">string</span><span class="o">=</span><span class="s2">&quot;Attendees&quot;</span><span class="p">)</span>
</span></pre></div>
</div>
</div><em >openacademy/views/openacademy.xml</em><div class="pq-section"><div class="highlight-xml"><div class="highlight"><pre><span></span>                                <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;seats&quot;</span><span class="nt">/&gt;</span>
                            <span class="nt">&lt;/group&gt;</span>
                        <span class="nt">&lt;/group&gt;</span>
<span class="hll">                        <span class="nt">&lt;label</span> <span class="na">for=</span><span class="s">&quot;attendee_ids&quot;</span><span class="nt">/&gt;</span>
</span><span class="hll">                        <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;attendee_ids&quot;</span><span class="nt">/&gt;</span>
</span>                    <span class="nt">&lt;/sheet&gt;</span>
                <span class="nt">&lt;/form&gt;</span>
            <span class="nt">&lt;/field&gt;</span>
</pre></div>
</div>
</div></div></div></section><section id="inheritance"><h2 >Herencia</h2></section><section id="model-inheritance"><h3 >Herencia de modelos</h3><p >Odoo proporciona dos mecanismos de <em >herencia</em> para extender un modelo existente de forma modular.</p><p >El primer mecanismo de herencia permite a un módulo modificar el comportamiento de un modelo definido en otro módulo:</p><ul ><li ><p >agregar campos a un modelo,</p></li><li ><p >sobrescribir la definición de campos en un modelo,</p></li><li ><p >añadir restricciones a un modelo,</p></li><li ><p >añadir métodos a un modelo,</p></li><li ><p >reemplazar los métodos existentes en un modelo.</p></li></ul><p >El segundo mecanismo de herencia (delegación) permite vincular cada registro de un modelo a un registro en un modelo padre, y proporciona un acceso transparente a los campos del registro padre.</p><img src="../_images/inheritance_methods.png" class="img-responsive center-block"><div role="alert" class="alert-go_to alert"><p class="alert-title">Ver también</p><ul ><li ><a href="../reference/orm.html#odoo.models.Model._inherit" class="internal alert-link reference" title="odoo.models.Model._inherit"><code class="py xref py-attr">_inherit</code></a></li><li ><a href="../reference/orm.html#odoo.models.Model._inherits" class="internal alert-link reference" title="odoo.models.Model._inherits"><code class="py xref py-attr">_inherits</code></a></li></ul></div></section><section id="view-inheritance"><h3 >Herencia de vistas</h3><p >En lugar de modificar las vistas existentes en el lugar (sobrescribiéndolos), Odoo proporciona herencia de vistas, donde las vistas hijas <code >extensión</code> se aplican en la parte superior de la vista de la raíz, y se puede añadir o eliminar contenido de sus padres.</p><p >Una vista de extensión hace referencia a su padre con el campo <code >inherit_id</code>, y en lugar de una vista el campo <code >arch</code> se compone de cualquier número de <code >xpath</code>, elementos que seleccionan y modifican el contenido de su vista padre:</p><div class="highlight-xml"><div class="highlight"><pre><span></span><span class="c">&lt;!-- improved idea categories list --&gt;</span>
<span class="nt">&lt;record</span> <span class="na">id=</span><span class="s">&quot;idea_category_list2&quot;</span> <span class="na">model=</span><span class="s">&quot;ir.ui.view&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;name&quot;</span><span class="nt">&gt;</span>id.category.list2<span class="nt">&lt;/field&gt;</span>
    <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;model&quot;</span><span class="nt">&gt;</span>idea.category<span class="nt">&lt;/field&gt;</span>
    <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;inherit_id&quot;</span> <span class="na">ref=</span><span class="s">&quot;id_category_list&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;arch&quot;</span> <span class="na">type=</span><span class="s">&quot;xml&quot;</span><span class="nt">&gt;</span>
        <span class="c">&lt;!-- find field description and add the field</span>
<span class="c">             idea_ids after it --&gt;</span>
        <span class="nt">&lt;xpath</span> <span class="na">expr=</span><span class="s">&quot;//field[@name=&#39;description&#39;]&quot;</span> <span class="na">position=</span><span class="s">&quot;after&quot;</span><span class="nt">&gt;</span>
          <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;idea_ids&quot;</span> <span class="na">string=</span><span class="s">&quot;Number of ideas&quot;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;/xpath&gt;</span>
    <span class="nt">&lt;/field&gt;</span>
<span class="nt">&lt;/record&gt;</span>
</pre></div>
</div>
<dl ><dt ><code >expr</code></dt><dd ><p >Una expresión <a href="http://w3.org/TR/xpath" class="external reference">XPath</a> es la selección de un solo elemento en la vista padre. Genera un error si no coincide con ningún elemento o más de uno</p></dd><dt ><code >position</code></dt><dd ><p >Operación para aplicar al elemento coincidente:</p><dl ><dt ><code >inside</code></dt><dd ><p >anexa el cuerpo de <code >xpath</code> en el extremo del elemento emparejado</p></dd><dt ><code >replace</code></dt><dd ><p >remplaza el elemento que empate con el cuerpo del <code >xpath</code>, remplazando cualquier ocurrencia de nodo <code >$0</code> en el nuevo cuerpo con el elemento original</p></dd><dt ><code >before</code></dt><dd ><p >inserta el cuerpo del <code >xpath</code> como un hermano antes del elemento emparejado</p></dd><dt ><code >after</code></dt><dd ><p >inserta el cuerpo de <code >xpaths</code> como un hermano después del elemento emparejado</p></dd><dt ><code >attributes</code></dt><dd ><p >altera los atributos del elemento coincidente utilizando elementos <code >attribute</code> especiales en el cuerpo de <code >xpath</code></p></dd></dl></dd></dl><div role="alert" class="alert-info alert"><p class="alert-title">Truco</p><p >En la concordancia de un solo elemento, el atributo <code >position</code> se puede establecer directamente sobre el elemento que se encuentra. Ambas herencias a continuación le dará el mismo resultado.</p><div class="highlight-xml"><div class="highlight"><pre><span></span><span class="nt">&lt;xpath</span> <span class="na">expr=</span><span class="s">&quot;//field[@name=&#39;description&#39;]&quot;</span> <span class="na">position=</span><span class="s">&quot;after&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;idea_ids&quot;</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;/xpath&gt;</span>

<span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;description&quot;</span> <span class="na">position=</span><span class="s">&quot;after&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;idea_ids&quot;</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;/field&gt;</span>
</pre></div>
</div>
</div><div role="alert" class="alert-exercise alert"><p class="alert-title">Exercise</p><p >Alterar el contenido existente</p><ul ><li ><p >Utilizando el modelo de herencia, modificar el modelo <em >Partner</em> y añadir un campo boolean llamado <code >Instructor</code> y un campo many2many que correspondería a la relación de session-partner</p></li><li ><p >Mediante herencia de vista, muestra este campo en la vista formulario de partner</p></li></ul><div role="alert" class="alert-info alert"><p class="alert-title">Nota</p><p >Esta es la oportunidad para presentar el modo desarrollador para inspeccionar la vista, conocer su ID externo y el lugar para poner el nuevo campo.</p></div><ol ><li ><p >Crear un archivo <code >openacademy/models/partner.py</code> e importar en <code >__init__.py</code></p></li><li ><p >Crear un archivo <code >openacademy/views/partner.xml</code> y agregarlo al <code >__manifest__.py</code></p></li></ol><div class="pq-patch"><em >openacademy/__init__.py</em><div class="pq-section"><div class="highlight-python"><div class="highlight"><pre><span></span><span class="c1"># -*- coding: utf-8 -*-</span>
<span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">controllers</span>
<span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">models</span>
<span class="hll"><span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">partner</span>
</span></pre></div>
</div>
</div><em >openacademy/__manifest__.py</em><div class="pq-section"><div class="highlight-python"><div class="highlight"><pre><span></span>        <span class="c1"># &#39;security/ir.model.access.csv&#39;,</span>
        <span class="s1">&#39;templates.xml&#39;</span><span class="p">,</span>
        <span class="s1">&#39;views/openacademy.xml&#39;</span><span class="p">,</span>
<span class="hll">        <span class="s1">&#39;views/partner.xml&#39;</span><span class="p">,</span>
</span>    <span class="p">],</span>
    <span class="c1"># only loaded in demonstration mode</span>
    <span class="s1">&#39;demo&#39;</span><span class="p">:</span> <span class="p">[</span>
</pre></div>
</div>
</div><em >openacademy/partner.py</em><div class="pq-section"><div class="highlight-python"><div class="highlight"><pre><span></span><span class="hll"><span class="c1"># -*- coding: utf-8 -*-</span>
</span><span class="hll"><span class="kn">from</span> <span class="nn">odoo</span> <span class="kn">import</span> <span class="n">fields</span><span class="p">,</span> <span class="n">models</span>
</span><span class="hll">
</span><span class="hll"><span class="k">class</span> <span class="nc">Partner</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
</span><span class="hll">    <span class="n">_inherit</span> <span class="o">=</span> <span class="s1">&#39;res.partner&#39;</span>
</span><span class="hll">
</span><span class="hll">    <span class="c1"># Add a new column to the res.partner model, by default partners are not</span>
</span><span class="hll">    <span class="c1"># instructors</span>
</span><span class="hll">    <span class="n">instructor</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">Boolean</span><span class="p">(</span><span class="s2">&quot;Instructor&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
</span><span class="hll">
</span><span class="hll">    <span class="n">session_ids</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">Many2many</span><span class="p">(</span><span class="s1">&#39;openacademy.session&#39;</span><span class="p">,</span>
</span><span class="hll">        <span class="n">string</span><span class="o">=</span><span class="s2">&quot;Attended Sessions&quot;</span><span class="p">,</span> <span class="n">readonly</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</span></pre></div>
</div>
</div><em >openacademy/views/partner.xml</em><div class="pq-section"><div class="highlight-xml"><div class="highlight"><pre><span></span><span class="hll"><span class="cp">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span>
</span><span class="hll"> <span class="nt">&lt;odoo&gt;</span>
</span><span class="hll">
</span><span class="hll">        <span class="c">&lt;!-- Add instructor field to existing view --&gt;</span>
</span><span class="hll">        <span class="nt">&lt;record</span> <span class="na">model=</span><span class="s">&quot;ir.ui.view&quot;</span> <span class="na">id=</span><span class="s">&quot;partner_instructor_form_view&quot;</span><span class="nt">&gt;</span>
</span><span class="hll">            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;name&quot;</span><span class="nt">&gt;</span>partner.instructor<span class="nt">&lt;/field&gt;</span>
</span><span class="hll">            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;model&quot;</span><span class="nt">&gt;</span>res.partner<span class="nt">&lt;/field&gt;</span>
</span><span class="hll">            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;inherit_id&quot;</span> <span class="na">ref=</span><span class="s">&quot;base.view_partner_form&quot;</span><span class="nt">/&gt;</span>
</span><span class="hll">            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;arch&quot;</span> <span class="na">type=</span><span class="s">&quot;xml&quot;</span><span class="nt">&gt;</span>
</span><span class="hll">                <span class="nt">&lt;notebook</span> <span class="na">position=</span><span class="s">&quot;inside&quot;</span><span class="nt">&gt;</span>
</span><span class="hll">                    <span class="nt">&lt;page</span> <span class="na">string=</span><span class="s">&quot;Sessions&quot;</span><span class="nt">&gt;</span>
</span><span class="hll">                        <span class="nt">&lt;group&gt;</span>
</span><span class="hll">                            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;instructor&quot;</span><span class="nt">/&gt;</span>
</span><span class="hll">                            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;session_ids&quot;</span><span class="nt">/&gt;</span>
</span><span class="hll">                        <span class="nt">&lt;/group&gt;</span>
</span><span class="hll">                    <span class="nt">&lt;/page&gt;</span>
</span><span class="hll">                <span class="nt">&lt;/notebook&gt;</span>
</span><span class="hll">            <span class="nt">&lt;/field&gt;</span>
</span><span class="hll">        <span class="nt">&lt;/record&gt;</span>
</span><span class="hll">
</span><span class="hll">        <span class="nt">&lt;record</span> <span class="na">model=</span><span class="s">&quot;ir.actions.act_window&quot;</span> <span class="na">id=</span><span class="s">&quot;contact_list_action&quot;</span><span class="nt">&gt;</span>
</span><span class="hll">            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;name&quot;</span><span class="nt">&gt;</span>Contacts<span class="nt">&lt;/field&gt;</span>
</span><span class="hll">            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;res_model&quot;</span><span class="nt">&gt;</span>res.partner<span class="nt">&lt;/field&gt;</span>
</span><span class="hll">            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;view_mode&quot;</span><span class="nt">&gt;</span>tree,form<span class="nt">&lt;/field&gt;</span>
</span><span class="hll">        <span class="nt">&lt;/record&gt;</span>
</span><span class="hll">        <span class="nt">&lt;menuitem</span> <span class="na">id=</span><span class="s">&quot;configuration_menu&quot;</span> <span class="na">name=</span><span class="s">&quot;Configuration&quot;</span>
</span><span class="hll">                  <span class="na">parent=</span><span class="s">&quot;main_openacademy_menu&quot;</span><span class="nt">/&gt;</span>
</span><span class="hll">        <span class="nt">&lt;menuitem</span> <span class="na">id=</span><span class="s">&quot;contact_menu&quot;</span> <span class="na">name=</span><span class="s">&quot;Contacts&quot;</span>
</span><span class="hll">                  <span class="na">parent=</span><span class="s">&quot;configuration_menu&quot;</span>
</span><span class="hll">                  <span class="na">action=</span><span class="s">&quot;contact_list_action&quot;</span><span class="nt">/&gt;</span>
</span><span class="hll">
</span><span class="hll"><span class="nt">&lt;/odoo&gt;</span>
</span></pre></div>
</div>
</div></div></div></section><section id="domains"><h4 >Dominios</h4><p >En Odoo, <a href="../reference/orm.html#reference-orm-domains" class="internal reference"><span class="std std-ref">Domains</span></a> son valores que representan condiciones en los registros. Un dominio es una lista de criterios utilizados para seleccionar un subconjunto de registros de un modelo. Cada criterio es una tripleta con un nombre de campo, un operador y un valor.</p><p >Por ejemplo, cuando se usa en el modelo <em >product</em> el siguiente dominio selecciona todos los <em >services</em> con un precio unitario mayor <em >1000</em>:</p><div class="highlight-default"><div class="highlight"><pre><span></span><span class="p">[(</span><span class="s1">&#39;product_type&#39;</span><span class="p">,</span> <span class="s1">&#39;=&#39;</span><span class="p">,</span> <span class="s1">&#39;service&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;unit_price&#39;</span><span class="p">,</span> <span class="s1">&#39;&gt;&#39;</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)]</span>
</pre></div>
</div>
<p >Por defecto se combinan criterios con un implícito AND. Los operadores lógicos <code >&amp;</code> (AND), <code >|</code> (OR) and <code >!</code> (NOT) se pueden utilizar para combinar explícitamente criterios. Se utilizan en posición de prefijo (el operador se inserta antes de sus argumentos, y no entre). Por ejemplo para seleccionar productos &quot;que son servicios <em >OR</em> tienen un precio unitario que <em >NOT</em> está entre 1000 y 2000&quot;:</p><div class="highlight-default"><div class="highlight"><pre><span></span><span class="p">[</span><span class="s1">&#39;|&#39;</span><span class="p">,</span>
    <span class="p">(</span><span class="s1">&#39;product_type&#39;</span><span class="p">,</span> <span class="s1">&#39;=&#39;</span><span class="p">,</span> <span class="s1">&#39;service&#39;</span><span class="p">),</span>
    <span class="s1">&#39;!&#39;</span><span class="p">,</span> <span class="s1">&#39;&amp;&#39;</span><span class="p">,</span>
        <span class="p">(</span><span class="s1">&#39;unit_price&#39;</span><span class="p">,</span> <span class="s1">&#39;&gt;=&#39;</span><span class="p">,</span> <span class="mi">1000</span><span class="p">),</span>
        <span class="p">(</span><span class="s1">&#39;unit_price&#39;</span><span class="p">,</span> <span class="s1">&#39;&lt;&#39;</span><span class="p">,</span> <span class="mi">2000</span><span class="p">)]</span>
</pre></div>
</div>
<p >Un parámetro <code >dominio</code> puede ser añadido a campos relacionales para limitar registros válidos para esa relación cuando se intenta seleccionar registros en la interfaz del cliente.</p><div role="alert" class="alert-exercise alert"><p class="alert-title">Exercise</p><p >Dominios en campos relacionales</p><p >Al seleccionar el instructor para una <em >Session</em>, sólo instructores (partners cuyo campo <code >instructor</code> es <code >True</code>) deben ser visibles.</p><div class="pq-patch"><em >openacademy/models.py</em><div class="pq-section"><div class="highlight-python"><div class="highlight"><pre><span></span>    <span class="n">duration</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">Float</span><span class="p">(</span><span class="n">digits</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Duration in days&quot;</span><span class="p">)</span>
    <span class="n">seats</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">Integer</span><span class="p">(</span><span class="n">string</span><span class="o">=</span><span class="s2">&quot;Number of seats&quot;</span><span class="p">)</span>

<span class="hll">    <span class="n">instructor_id</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">Many2one</span><span class="p">(</span><span class="s1">&#39;res.partner&#39;</span><span class="p">,</span> <span class="n">string</span><span class="o">=</span><span class="s2">&quot;Instructor&quot;</span><span class="p">,</span>
</span><span class="hll">        <span class="n">domain</span><span class="o">=</span><span class="p">[(</span><span class="s1">&#39;instructor&#39;</span><span class="p">,</span> <span class="s1">&#39;=&#39;</span><span class="p">,</span> <span class="bp">True</span><span class="p">)])</span>
</span>    <span class="n">course_id</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">Many2one</span><span class="p">(</span><span class="s1">&#39;openacademy.course&#39;</span><span class="p">,</span>
        <span class="n">ondelete</span><span class="o">=</span><span class="s1">&#39;cascade&#39;</span><span class="p">,</span> <span class="n">string</span><span class="o">=</span><span class="s2">&quot;Course&quot;</span><span class="p">,</span> <span class="n">required</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
    <span class="n">attendee_ids</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">Many2many</span><span class="p">(</span><span class="s1">&#39;res.partner&#39;</span><span class="p">,</span> <span class="n">string</span><span class="o">=</span><span class="s2">&quot;Attendees&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div></div><div role="alert" class="alert-info alert"><p class="alert-title">Nota</p><p >Un dominio declarado como una lista literal se evalúa del lado del servidor y no puede hacer referencia a valores dinámicos en el lado derecho en su declaración, un dominio declarado como una cadena es evaluado del lado del cliente y permite nombres de campo en el lado derecho</p></div></div><div role="alert" class="alert-exercise alert"><p class="alert-title">Exercise</p><p >Dominios más complejos</p><p >Crear un par de nuevas categorías <em >Teacher / Level 1</em> y <em >Teacher / Level 2</em>. El instructor de una sesión puede ser un <em >instructor</em> o un profesor (<em >de cualquier nivel</em>).</p><ol ><li ><p >Modificar el dominio del modelo <em >Session</em></p></li><li ><p >Modificar <code >openacademy/view/partner.xml</code> para obtener acceso a las categorías que acabamos de crear:</p></li></ol><div class="pq-patch"><em >openacademy/models.py</em><div class="pq-section"><div class="highlight-python"><div class="highlight"><pre><span></span>    <span class="n">seats</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">Integer</span><span class="p">(</span><span class="n">string</span><span class="o">=</span><span class="s2">&quot;Number of seats&quot;</span><span class="p">)</span>

    <span class="n">instructor_id</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">Many2one</span><span class="p">(</span><span class="s1">&#39;res.partner&#39;</span><span class="p">,</span> <span class="n">string</span><span class="o">=</span><span class="s2">&quot;Instructor&quot;</span><span class="p">,</span>
<span class="hll">        <span class="n">domain</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;|&#39;</span><span class="p">,</span> <span class="p">(</span><span class="s1">&#39;instructor&#39;</span><span class="p">,</span> <span class="s1">&#39;=&#39;</span><span class="p">,</span> <span class="bp">True</span><span class="p">),</span>
</span><span class="hll">                     <span class="p">(</span><span class="s1">&#39;category_id.name&#39;</span><span class="p">,</span> <span class="s1">&#39;ilike&#39;</span><span class="p">,</span> <span class="s2">&quot;Teacher&quot;</span><span class="p">)])</span>
</span>    <span class="n">course_id</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">Many2one</span><span class="p">(</span><span class="s1">&#39;openacademy.course&#39;</span><span class="p">,</span>
        <span class="n">ondelete</span><span class="o">=</span><span class="s1">&#39;cascade&#39;</span><span class="p">,</span> <span class="n">string</span><span class="o">=</span><span class="s2">&quot;Course&quot;</span><span class="p">,</span> <span class="n">required</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
    <span class="n">attendee_ids</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">Many2many</span><span class="p">(</span><span class="s1">&#39;res.partner&#39;</span><span class="p">,</span> <span class="n">string</span><span class="o">=</span><span class="s2">&quot;Attendees&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div><em >openacademy/views/partner.xml</em><div class="pq-section"><div class="highlight-xml"><div class="highlight"><pre><span></span>        <span class="nt">&lt;menuitem</span> <span class="na">id=</span><span class="s">&quot;contact_menu&quot;</span> <span class="na">name=</span><span class="s">&quot;Contacts&quot;</span>
                  <span class="na">parent=</span><span class="s">&quot;configuration_menu&quot;</span>
                  <span class="na">action=</span><span class="s">&quot;contact_list_action&quot;</span><span class="nt">/&gt;</span>
<span class="hll">
</span><span class="hll">        <span class="nt">&lt;record</span> <span class="na">model=</span><span class="s">&quot;ir.actions.act_window&quot;</span> <span class="na">id=</span><span class="s">&quot;contact_cat_list_action&quot;</span><span class="nt">&gt;</span>
</span><span class="hll">            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;name&quot;</span><span class="nt">&gt;</span>Contact Tags<span class="nt">&lt;/field&gt;</span>
</span><span class="hll">            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;res_model&quot;</span><span class="nt">&gt;</span>res.partner.category<span class="nt">&lt;/field&gt;</span>
</span><span class="hll">            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;view_mode&quot;</span><span class="nt">&gt;</span>tree,form<span class="nt">&lt;/field&gt;</span>
</span><span class="hll">        <span class="nt">&lt;/record&gt;</span>
</span><span class="hll">        <span class="nt">&lt;menuitem</span> <span class="na">id=</span><span class="s">&quot;contact_cat_menu&quot;</span> <span class="na">name=</span><span class="s">&quot;Contact Tags&quot;</span>
</span><span class="hll">                  <span class="na">parent=</span><span class="s">&quot;configuration_menu&quot;</span>
</span><span class="hll">                  <span class="na">action=</span><span class="s">&quot;contact_cat_list_action&quot;</span><span class="nt">/&gt;</span>
</span><span class="hll">
</span><span class="hll">        <span class="nt">&lt;record</span> <span class="na">model=</span><span class="s">&quot;res.partner.category&quot;</span> <span class="na">id=</span><span class="s">&quot;teacher1&quot;</span><span class="nt">&gt;</span>
</span><span class="hll">            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;name&quot;</span><span class="nt">&gt;</span>Teacher / Level 1<span class="nt">&lt;/field&gt;</span>
</span><span class="hll">        <span class="nt">&lt;/record&gt;</span>
</span><span class="hll">        <span class="nt">&lt;record</span> <span class="na">model=</span><span class="s">&quot;res.partner.category&quot;</span> <span class="na">id=</span><span class="s">&quot;teacher2&quot;</span><span class="nt">&gt;</span>
</span><span class="hll">            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;name&quot;</span><span class="nt">&gt;</span>Teacher / Level 2<span class="nt">&lt;/field&gt;</span>
</span><span class="hll">        <span class="nt">&lt;/record&gt;</span>
</span>
<span class="nt">&lt;/odoo&gt;</span>
</pre></div>
</div>
</div></div></div></section><section id="computed-fields-and-default-values"><h2 >Campos y valores calculados</h2><p >Hasta ahora los campos han sido almacenados y obtenidos directamente de la base de datos. Los campos también pueden ser <em >calculados</em>. En ese caso, el valor del campo no es obtenido de la base de datos sino calculado al vuelo llamando a un método en el modelo.</p><p >Para crear un campo calculado, cree un campo y establezca su atributo: <code class="py xref py-attr">compute</code> con el nombre del método. El método de cómputo simplemente debe establecer el valor del campo calculado en cada registro en <code >self</code>.</p><div role="alert" class="alert-danger aphorism alert"><p class="alert-title">Peligro</p><p ><code >self</code> es una (collection) colección</p><p >El objeto <code >self</code> es un <em >recordset</em>, es decir, una colección ordenada de registros. Es compatible con las operaciones estándar de Python en colecciones, como <code >len(self)</code> y <code >iter(self)</code>, además de operaciones extra set como <code >recs1 + recs2</code>.</p><p >Iterando sobre <code >self</code> los registros uno por uno, donde cada registro es una colección de tamaño 1. Puedes acceder/asignar campos a registros individuales mediante el uso de la notación de puntos, algo así <code >record.name</code>.</p></div><div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">random</span>
<span class="kn">from</span> <span class="nn">odoo</span> <span class="kn">import</span> <span class="n">models</span><span class="p">,</span> <span class="n">fields</span><span class="p">,</span> <span class="n">api</span>

<span class="k">class</span> <span class="nc">ComputedModel</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
    <span class="n">_name</span> <span class="o">=</span> <span class="s1">&#39;test.computed&#39;</span>

    <span class="n">name</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">Char</span><span class="p">(</span><span class="n">compute</span><span class="o">=</span><span class="s1">&#39;_compute_name&#39;</span><span class="p">)</span>

    <span class="nd">@api.multi</span>
    <span class="k">def</span> <span class="nf">_compute_name</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">record</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>
            <span class="n">record</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mf">1e6</span><span class="p">))</span>
</pre></div>
</div>
</section><section id="dependencies"><h3 >Dependencias</h3><p >El valor de un campo calculado generalmente depende de los valores de otros campos en el registro calculado. El ORM espera que el programador  especifique estas dependencias en el método de cálculo con el decorador <a href="../reference/orm.html#odoo.api.depends" class="internal reference" title="odoo.api.depends"><code class="py xref py-func">depends()</code></a>. Las dependencias dadas son utilizadas por el ORM para desencadenar el recálculo del campo cada vez que se han modificado algunas de sus dependencias:</p><div class="highlight-default"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">odoo</span> <span class="k">import</span> <span class="n">models</span><span class="p">,</span> <span class="n">fields</span><span class="p">,</span> <span class="n">api</span>

<span class="k">class</span> <span class="nc">ComputedModel</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
    <span class="n">_name</span> <span class="o">=</span> <span class="s1">&#39;test.computed&#39;</span>

    <span class="n">name</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">Char</span><span class="p">(</span><span class="n">compute</span><span class="o">=</span><span class="s1">&#39;_compute_name&#39;</span><span class="p">)</span>
    <span class="n">value</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">Integer</span><span class="p">()</span>

    <span class="nd">@api</span><span class="o">.</span><span class="n">depends</span><span class="p">(</span><span class="s1">&#39;value&#39;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">_compute_name</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">record</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>
            <span class="n">record</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;Record with value </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">record</span><span class="o">.</span><span class="n">value</span>
</pre></div>
</div>
<div role="alert" class="alert-exercise alert"><p class="alert-title">Exercise</p><p >Campos y valores calculados</p><ul ><li ><p >Agregar el porcentaje de asientos tomados para el modelo <em >session</em></p></li><li ><p >Mostrar ese campo en la vista de árbol y formulario</p></li><li ><p >Mostrar el campo como una barra de progreso</p></li></ul><ol ><li ><p >Agregar un campo calculado a una <em >Session</em></p></li><li ><p >Mostrar el campo en la vista <em >Session</em>:</p></li></ol><div class="pq-patch"><em >openacademy/models.py</em><div class="pq-section"><div class="highlight-python"><div class="highlight"><pre><span></span>    <span class="n">course_id</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">Many2one</span><span class="p">(</span><span class="s1">&#39;openacademy.course&#39;</span><span class="p">,</span>
        <span class="n">ondelete</span><span class="o">=</span><span class="s1">&#39;cascade&#39;</span><span class="p">,</span> <span class="n">string</span><span class="o">=</span><span class="s2">&quot;Course&quot;</span><span class="p">,</span> <span class="n">required</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
    <span class="n">attendee_ids</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">Many2many</span><span class="p">(</span><span class="s1">&#39;res.partner&#39;</span><span class="p">,</span> <span class="n">string</span><span class="o">=</span><span class="s2">&quot;Attendees&quot;</span><span class="p">)</span>
<span class="hll">
</span><span class="hll">    <span class="n">taken_seats</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">Float</span><span class="p">(</span><span class="n">string</span><span class="o">=</span><span class="s2">&quot;Taken seats&quot;</span><span class="p">,</span> <span class="n">compute</span><span class="o">=</span><span class="s1">&#39;_taken_seats&#39;</span><span class="p">)</span>
</span><span class="hll">
</span><span class="hll">    <span class="nd">@api.depends</span><span class="p">(</span><span class="s1">&#39;seats&#39;</span><span class="p">,</span> <span class="s1">&#39;attendee_ids&#39;</span><span class="p">)</span>
</span><span class="hll">    <span class="k">def</span> <span class="nf">_taken_seats</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span class="hll">        <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>
</span><span class="hll">            <span class="k">if</span> <span class="ow">not</span> <span class="n">r</span><span class="o">.</span><span class="n">seats</span><span class="p">:</span>
</span><span class="hll">                <span class="n">r</span><span class="o">.</span><span class="n">taken_seats</span> <span class="o">=</span> <span class="mf">0.0</span>
</span><span class="hll">            <span class="k">else</span><span class="p">:</span>
</span><span class="hll">                <span class="n">r</span><span class="o">.</span><span class="n">taken_seats</span> <span class="o">=</span> <span class="mf">100.0</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">attendee_ids</span><span class="p">)</span> <span class="o">/</span> <span class="n">r</span><span class="o">.</span><span class="n">seats</span>
</span></pre></div>
</div>
</div><em >openacademy/views/openacademy.xml</em><div class="pq-section"><div class="highlight-xml"><div class="highlight"><pre><span></span>                                <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;start_date&quot;</span><span class="nt">/&gt;</span>
                                <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;duration&quot;</span><span class="nt">/&gt;</span>
                                <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;seats&quot;</span><span class="nt">/&gt;</span>
<span class="hll">                                <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;taken_seats&quot;</span> <span class="na">widget=</span><span class="s">&quot;progressbar&quot;</span><span class="nt">/&gt;</span>
</span>                            <span class="nt">&lt;/group&gt;</span>
                        <span class="nt">&lt;/group&gt;</span>
                        <span class="nt">&lt;label</span> <span class="na">for=</span><span class="s">&quot;attendee_ids&quot;</span><span class="nt">/&gt;</span>
</pre></div>
</div>
<div class="highlight-xml"><div class="highlight"><pre><span></span>                <span class="nt">&lt;tree</span> <span class="na">string=</span><span class="s">&quot;Session Tree&quot;</span><span class="nt">&gt;</span>
                    <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;name&quot;</span><span class="nt">/&gt;</span>
                    <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;course_id&quot;</span><span class="nt">/&gt;</span>
<span class="hll">                    <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;taken_seats&quot;</span> <span class="na">widget=</span><span class="s">&quot;progressbar&quot;</span><span class="nt">/&gt;</span>
</span>                <span class="nt">&lt;/tree&gt;</span>
            <span class="nt">&lt;/field&gt;</span>
        <span class="nt">&lt;/record&gt;</span>
</pre></div>
</div>
</div></div></div></section><section id="default-values"><h3 >Valores por defecto</h3><p >Cualquier campo puede tener un valor por defecto. En la definición de campo, se agrega la opción  <code >default=X</code> donde <code >X</code> es un valor literal Python (boolean, integer, float, string), o una función que toma un conjunto de registros y devuelve un valor:</p><div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">name</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">Char</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="s2">&quot;Unknown&quot;</span><span class="p">)</span>
<span class="n">user_id</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">Many2one</span><span class="p">(</span><span class="s1">&#39;res.users&#39;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="k">lambda</span> <span class="bp">self</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">user</span><span class="p">)</span>
</pre></div>
</div>
<div role="alert" class="alert-info alert"><p class="alert-title">Nota</p><p >El objeto <code >self.env</code> da acceso a solicitar parámetros y otras cosas útiles:</p><ul ><li ><p ><code >self.env.cr</code> o <code >self._cr</code> es el objeto <em >cursor</em> de la base de datos; se utiliza para consultar la base de datos</p></li><li ><p ><code >self.env.uid</code> o <code >self._uid</code> es el id de la base de datos del usuario actual</p></li><li ><p ><code >self.env.user</code> es el registro del usuario actual</p></li><li ><p ><code >self.env.context</code> o <code >self._context</code> es el Diccionario de contexto</p></li><li ><p ><code >self.env.ref(xml_id)</code> devuelve el registro correspondiente a un id XML</p></li><li ><p ><code >self.env[model_name]</code> devuelve una instancia del modelo dado</p></li></ul></div><div role="alert" class="alert-exercise alert"><p class="alert-title">Exercise</p><p >Objetos activos – valores por defecto</p><ul ><li ><p >Definir el valor por defecto de start_date como hoy (ver <a href="../reference/orm.html#odoo.fields.Date" class="internal alert-link reference" title="odoo.fields.Date"><code class="py xref py-class">Date</code></a>).</p></li><li ><p >Agregue un campo <code >active</code> en la clase de Session y haga las sesiones activas por defecto.</p></li></ul><div class="pq-patch"><em >openacademy/models.py</em><div class="pq-section"><div class="highlight-python"><div class="highlight"><pre><span></span>    <span class="n">_name</span> <span class="o">=</span> <span class="s1">&#39;openacademy.session&#39;</span>

    <span class="n">name</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">Char</span><span class="p">(</span><span class="n">required</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="hll">    <span class="n">start_date</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">Date</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="n">fields</span><span class="o">.</span><span class="n">Date</span><span class="o">.</span><span class="n">today</span><span class="p">)</span>
</span>    <span class="n">duration</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">Float</span><span class="p">(</span><span class="n">digits</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Duration in days&quot;</span><span class="p">)</span>
    <span class="n">seats</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">Integer</span><span class="p">(</span><span class="n">string</span><span class="o">=</span><span class="s2">&quot;Number of seats&quot;</span><span class="p">)</span>
<span class="hll">    <span class="n">active</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">Boolean</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</span>
    <span class="n">instructor_id</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">Many2one</span><span class="p">(</span><span class="s1">&#39;res.partner&#39;</span><span class="p">,</span> <span class="n">string</span><span class="o">=</span><span class="s2">&quot;Instructor&quot;</span><span class="p">,</span>
        <span class="n">domain</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;|&#39;</span><span class="p">,</span> <span class="p">(</span><span class="s1">&#39;instructor&#39;</span><span class="p">,</span> <span class="s1">&#39;=&#39;</span><span class="p">,</span> <span class="bp">True</span><span class="p">),</span>
</pre></div>
</div>
</div><em >openacademy/views/openacademy.xml</em><div class="pq-section"><div class="highlight-xml"><div class="highlight"><pre><span></span>                                <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;course_id&quot;</span><span class="nt">/&gt;</span>
                                <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;name&quot;</span><span class="nt">/&gt;</span>
                                <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;instructor_id&quot;</span><span class="nt">/&gt;</span>
<span class="hll">                                <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;active&quot;</span><span class="nt">/&gt;</span>
</span>                            <span class="nt">&lt;/group&gt;</span>
                            <span class="nt">&lt;group</span> <span class="na">string=</span><span class="s">&quot;Schedule&quot;</span><span class="nt">&gt;</span>
                                <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;start_date&quot;</span><span class="nt">/&gt;</span>
</pre></div>
</div>
</div></div><div role="alert" class="alert-info alert"><p class="alert-title">Nota</p><p >Odoo tiene reglas incorporadas que hacen que registros con el campo <code >active</code> establecido a <code >False</code> sean invisibles.</p></div></div></section><section id="onchange"><h2 >Onchange</h2><p >El mecanismo &quot;onchange&quot; proporciona una forma para que la interfaz del cliente actualice los datos de un formulario cuando el usuario ha llenado un valor en un campo, sin guardar nada en la base de datos.</p><p >Por ejemplo, supóngase que un modelo tiene tres campos <code >amount</code>, <code >unit_price</code> y <code >price</code>, y se desea actualizar el precio en el formulario cuando cualquiera de los otros campos es modificado. Para ello, se define un método donde <code >self</code> representa el registro en la vista formulario y se decora con <a href="../reference/orm.html#odoo.api.onchange" class="internal reference" title="odoo.api.onchange"><code class="py xref py-func">onchange()</code></a> para especificar en qué campo se activará. Cualquier cambio que se realice en <code >self</code> será reflejado en el formulario.</p><div class="highlight-xml"><div class="highlight"><pre><span></span><span class="c">&lt;!-- content of form view --&gt;</span>
<span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;amount&quot;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;unit_price&quot;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;price&quot;</span> <span class="na">readonly=</span><span class="s">&quot;1&quot;</span><span class="nt">/&gt;</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="c1"># onchange handler</span>
<span class="nd">@api.onchange</span><span class="p">(</span><span class="s1">&#39;amount&#39;</span><span class="p">,</span> <span class="s1">&#39;unit_price&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">_onchange_price</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="c1"># set auto-changing field</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">price</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">amount</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">unit_price</span>
    <span class="c1"># Can optionally return a warning and domains</span>
    <span class="k">return</span> <span class="p">{</span>
        <span class="s1">&#39;warning&#39;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="s2">&quot;Something bad happened&quot;</span><span class="p">,</span>
            <span class="s1">&#39;message&#39;</span><span class="p">:</span> <span class="s2">&quot;It was very bad indeed&quot;</span><span class="p">,</span>
        <span class="p">}</span>
    <span class="p">}</span>
</pre></div>
</div>
<p >Para campos calculados, el comportamiento <code >onchange</code> está incorporado como se aprecia al jugar con el formulario de una <em >Sessión</em>: cambia el número de asientos o los participantes, y se actualiza automáticamente el progressbar de <code >taken_seats</code>.</p><div role="alert" class="alert-exercise alert"><p class="alert-title">Exercise</p><p >Cuidado</p><p >Añadir un onchange explícito para advertir sobre valores no válidos, como un número negativo de asientos o más participantes que asientos.</p><div class="pq-patch"><em >openacademy/models.py</em><div class="pq-section"><div class="highlight-python"><div class="highlight"><pre><span></span>                <span class="n">r</span><span class="o">.</span><span class="n">taken_seats</span> <span class="o">=</span> <span class="mf">0.0</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">r</span><span class="o">.</span><span class="n">taken_seats</span> <span class="o">=</span> <span class="mf">100.0</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">attendee_ids</span><span class="p">)</span> <span class="o">/</span> <span class="n">r</span><span class="o">.</span><span class="n">seats</span>
<span class="hll">
</span><span class="hll">    <span class="nd">@api.onchange</span><span class="p">(</span><span class="s1">&#39;seats&#39;</span><span class="p">,</span> <span class="s1">&#39;attendee_ids&#39;</span><span class="p">)</span>
</span><span class="hll">    <span class="k">def</span> <span class="nf">_verify_valid_seats</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span class="hll">        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">seats</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span class="hll">            <span class="k">return</span> <span class="p">{</span>
</span><span class="hll">                <span class="s1">&#39;warning&#39;</span><span class="p">:</span> <span class="p">{</span>
</span><span class="hll">                    <span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="s2">&quot;Incorrect &#39;seats&#39; value&quot;</span><span class="p">,</span>
</span><span class="hll">                    <span class="s1">&#39;message&#39;</span><span class="p">:</span> <span class="s2">&quot;The number of available seats may not be negative&quot;</span><span class="p">,</span>
</span><span class="hll">                <span class="p">},</span>
</span><span class="hll">            <span class="p">}</span>
</span><span class="hll">        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">seats</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">attendee_ids</span><span class="p">):</span>
</span><span class="hll">            <span class="k">return</span> <span class="p">{</span>
</span><span class="hll">                <span class="s1">&#39;warning&#39;</span><span class="p">:</span> <span class="p">{</span>
</span><span class="hll">                    <span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="s2">&quot;Too many attendees&quot;</span><span class="p">,</span>
</span><span class="hll">                    <span class="s1">&#39;message&#39;</span><span class="p">:</span> <span class="s2">&quot;Increase seats or remove excess attendees&quot;</span><span class="p">,</span>
</span><span class="hll">                <span class="p">},</span>
</span><span class="hll">            <span class="p">}</span>
</span></pre></div>
</div>
</div></div></div></section><section id="model-constraints"><h2 >Restricciones</h2><p >Odoo ofrece dos formas de configurar automáticamente invariantes: <a href="../reference/orm.html#odoo.api.constrains" class="internal reference" title="odoo.api.constrains"><code class="py xref py-func">Python constraints</code></a> y <a href="../reference/orm.html#odoo.models.Model._sql_constraints" class="internal reference" title="odoo.models.Model._sql_constraints"><code class="py xref py-attr">SQL constraints</code></a>.</p><p >Una restricción de Python se define como un método decorado con <a href="../reference/orm.html#odoo.api.constrains" class="internal reference" title="odoo.api.constrains"><code class="py xref py-func">constrains()</code></a> y es invocado en un recordset. El decorador especifica los campos que están involucrados en la restricción, por lo que la restricción es automáticamente evaluada cuando uno de ellos es modificado. El método levantará una excepción si no se satisface su invariante:</p><div class="highlight-default"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">odoo.exceptions</span> <span class="k">import</span> <span class="n">ValidationError</span>

<span class="nd">@api</span><span class="o">.</span><span class="n">constrains</span><span class="p">(</span><span class="s1">&#39;age&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">_check_something</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">record</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">record</span><span class="o">.</span><span class="n">age</span> <span class="o">&gt;</span> <span class="mi">20</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">ValidationError</span><span class="p">(</span><span class="s2">&quot;Your record is too old: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">record</span><span class="o">.</span><span class="n">age</span><span class="p">)</span>
    <span class="c1"># all records passed the test, don&#39;t return anything</span>
</pre></div>
</div>
<div role="alert" class="alert-exercise alert"><p class="alert-title">Exercise</p><p >Agregar restricciones de Python</p><p >Agregar una restricción que comprueba que el instructor no está presente en los asistentes de su propia sesión.</p><div class="pq-patch"><em >openacademy/models.py</em><div class="pq-section"><div class="highlight-python"><div class="highlight"><pre><span></span><span class="c1"># -*- coding: utf-8 -*-</span>

<span class="hll"><span class="kn">from</span> <span class="nn">odoo</span> <span class="kn">import</span> <span class="n">models</span><span class="p">,</span> <span class="n">fields</span><span class="p">,</span> <span class="n">api</span><span class="p">,</span> <span class="n">exceptions</span>
</span>
<span class="k">class</span> <span class="nc">Course</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
    <span class="n">_name</span> <span class="o">=</span> <span class="s1">&#39;openacademy.course&#39;</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span></span>                    <span class="s1">&#39;message&#39;</span><span class="p">:</span> <span class="s2">&quot;Increase seats or remove excess attendees&quot;</span><span class="p">,</span>
                <span class="p">},</span>
            <span class="p">}</span>
<span class="hll">
</span><span class="hll">    <span class="nd">@api.constrains</span><span class="p">(</span><span class="s1">&#39;instructor_id&#39;</span><span class="p">,</span> <span class="s1">&#39;attendee_ids&#39;</span><span class="p">)</span>
</span><span class="hll">    <span class="k">def</span> <span class="nf">_check_instructor_not_in_attendees</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span class="hll">        <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>
</span><span class="hll">            <span class="k">if</span> <span class="n">r</span><span class="o">.</span><span class="n">instructor_id</span> <span class="ow">and</span> <span class="n">r</span><span class="o">.</span><span class="n">instructor_id</span> <span class="ow">in</span> <span class="n">r</span><span class="o">.</span><span class="n">attendee_ids</span><span class="p">:</span>
</span><span class="hll">                <span class="k">raise</span> <span class="n">exceptions</span><span class="o">.</span><span class="n">ValidationError</span><span class="p">(</span><span class="s2">&quot;A session&#39;s instructor can&#39;t be an attendee&quot;</span><span class="p">)</span>
</span></pre></div>
</div>
</div></div></div><p >Las restricciones SQL se definen mediante el atributo modelo:  <a href="../reference/orm.html#odoo.models.Model._sql_constraints" class="internal reference" title="odoo.models.Model._sql_constraints"><code class="py xref py-attr">_sql_constraints</code></a>. Este último se le asigna a una lista de tripletas de cadenas  <code >(name, sql_definition, message)`, donde ``name</code> es un nombre de restricción válido de SQL,  <code >sql_definition</code> es una expresión de <a href="http://www.postgresql.org/docs/9.3/static/ddl-constraints.html" class="external reference">table_constraint</a>, y <code >message</code> es el mensaje de error.</p><div role="alert" class="alert-exercise alert"><p class="alert-title">Exercise</p><p >Agregar restricciones SQL</p><p >Con la ayuda de <a href="http://www.postgresql.org/docs/9.3/static/ddl-constraints.html" class="external reference alert-link">Documentación de PostgreSQL</a>, añadir las siguientes restricciones:</p><ol ><li ><p >Compruebe que la descripción del curso y el título del curso son diferentes</p></li><li ><p >Hacer el nombre del Curso ÚNICO</p></li></ol><div class="pq-patch"><em >openacademy/models.py</em><div class="pq-section"><div class="highlight-python"><div class="highlight"><pre><span></span>    <span class="n">session_ids</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">One2many</span><span class="p">(</span>
        <span class="s1">&#39;openacademy.session&#39;</span><span class="p">,</span> <span class="s1">&#39;course_id&#39;</span><span class="p">,</span> <span class="n">string</span><span class="o">=</span><span class="s2">&quot;Sessions&quot;</span><span class="p">)</span>

<span class="hll">    <span class="n">_sql_constraints</span> <span class="o">=</span> <span class="p">[</span>
</span><span class="hll">        <span class="p">(</span><span class="s1">&#39;name_description_check&#39;</span><span class="p">,</span>
</span><span class="hll">         <span class="s1">&#39;CHECK(name != description)&#39;</span><span class="p">,</span>
</span><span class="hll">         <span class="s2">&quot;The title of the course should not be the description&quot;</span><span class="p">),</span>
</span><span class="hll">
</span><span class="hll">        <span class="p">(</span><span class="s1">&#39;name_unique&#39;</span><span class="p">,</span>
</span><span class="hll">         <span class="s1">&#39;UNIQUE(name)&#39;</span><span class="p">,</span>
</span><span class="hll">         <span class="s2">&quot;The course title must be unique&quot;</span><span class="p">),</span>
</span><span class="hll">    <span class="p">]</span>
</span><span class="hll">
</span>
<span class="k">class</span> <span class="nc">Session</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
    <span class="n">_name</span> <span class="o">=</span> <span class="s1">&#39;openacademy.session&#39;</span>
</pre></div>
</div>
</div></div></div><div role="alert" class="alert-exercise alert"><p class="alert-title">Exercise</p><p >Ejercicio 6 - Añadir una opción duplicar</p><p >Puesto que hemos añadido una restricción para la unicidad del nombre de curso, no es posible utilizar la función <code >duplicate</code> (<span class="menuselection">Form ‣ Duplicate</span>).</p><p >Volver a implementar su propio método de &quot;copy&quot; que permite duplicar el objeto del curso, cambiando el nombre original por &quot;Copy of [original name]&quot;.</p><div class="pq-patch"><em >openacademy/models.py</em><div class="pq-section"><div class="highlight-python"><div class="highlight"><pre><span></span>    <span class="n">session_ids</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">One2many</span><span class="p">(</span>
        <span class="s1">&#39;openacademy.session&#39;</span><span class="p">,</span> <span class="s1">&#39;course_id&#39;</span><span class="p">,</span> <span class="n">string</span><span class="o">=</span><span class="s2">&quot;Sessions&quot;</span><span class="p">)</span>

<span class="hll">    <span class="nd">@api.multi</span>
</span><span class="hll">    <span class="k">def</span> <span class="nf">copy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
</span><span class="hll">        <span class="n">default</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">default</span> <span class="ow">or</span> <span class="p">{})</span>
</span><span class="hll">
</span><span class="hll">        <span class="n">copied_count</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">search_count</span><span class="p">(</span>
</span><span class="hll">            <span class="p">[(</span><span class="s1">&#39;name&#39;</span><span class="p">,</span> <span class="s1">&#39;=like&#39;</span><span class="p">,</span> <span class="sa">u</span><span class="s2">&quot;Copy of {}%&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">))])</span>
</span><span class="hll">        <span class="k">if</span> <span class="ow">not</span> <span class="n">copied_count</span><span class="p">:</span>
</span><span class="hll">            <span class="n">new_name</span> <span class="o">=</span> <span class="sa">u</span><span class="s2">&quot;Copy of {}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
</span><span class="hll">        <span class="k">else</span><span class="p">:</span>
</span><span class="hll">            <span class="n">new_name</span> <span class="o">=</span> <span class="sa">u</span><span class="s2">&quot;Copy of {} ({})&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">copied_count</span><span class="p">)</span>
</span><span class="hll">
</span><span class="hll">        <span class="n">default</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">new_name</span>
</span><span class="hll">        <span class="k">return</span> <span class="nb">super</span><span class="p">(</span><span class="n">Course</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">default</span><span class="p">)</span>
</span><span class="hll">
</span>    <span class="n">_sql_constraints</span> <span class="o">=</span> <span class="p">[</span>
        <span class="p">(</span><span class="s1">&#39;name_description_check&#39;</span><span class="p">,</span>
         <span class="s1">&#39;CHECK(name != description)&#39;</span><span class="p">,</span>
</pre></div>
</div>
</div></div></div></section><section id="advanced-views"><h2 >Vistas Avanzadas</h2></section><section id="id3"><h3 >Vistas de árbol</h3><p >Las vistas de árbol pueden tener atributos suplementarios para personalizar su comportamiento:</p><dl ><dt ><code >decoration-{$name}</code></dt><dd ><p >permite cambiar el estilo de texto de una fila basada en atributos del registro en cuestión.</p><p >Los valores son expresiones Python. Para cada registro, la expresión se evalúa con los atributos del registro como valores del contexto y si es <code >true</code>, se aplica el estilo correspondiente a la fila. Otros valores de contexto son <code >uid</code> (el id del usuario actual) y <code >current_date</code> (la fecha actual como una cadena de la forma <code >yyyy-MM-dd</code>).</p><p ><code >{$name}</code> puede ser <code >bf</code> (<code >font-weight: bold</code>), <code >it</code> (<code >font-style: italic</code>), o cualquier <a href="http://getbootstrap.com/components/#available-variations" class="external reference">color contextual de bootstrap</a> (<code >danger</code>, <code >info</code>, <code >muted</code>, <code >primary</code>, <code >success</code> or <code >warning</code>).</p><div class="highlight-xml"><div class="highlight"><pre><span></span><span class="nt">&lt;tree</span> <span class="na">string=</span><span class="s">&quot;Idea Categories&quot;</span> <span class="na">decoration-info=</span><span class="s">&quot;state==&#39;draft&#39;&quot;</span>
    <span class="na">decoration-danger=</span><span class="s">&quot;state==&#39;trashed&#39;&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;name&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;state&quot;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/tree&gt;</span>
</pre></div>
</div>
</dd><dt ><code >editable</code></dt><dd ><p >Ya sea <code >&quot;top&quot;</code> o <code >&quot;bottom&quot;</code>. Hace la vista de árbol modificable (en lugar de tener que pasar por la vista formulario), el valor representa la posición donde aparecen nuevas filas bien sea arriba o abajo por su significado en inglés.</p></dd></dl><div role="alert" class="alert-exercise alert"><p class="alert-title">Exercise</p><p >Colores en la Lista</p><p >Modificar la vista de árbol de una sesión de tal manera que las sesiones que duran menos de 5 días son de color azul, y los que duran más de 15 días son de color rojo.</p><p >Modificar la vista de árbol de sesión:</p><div class="pq-patch"><em >openacademy/views/openacademy.xml</em><div class="pq-section"><div class="highlight-xml"><div class="highlight"><pre><span></span>            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;name&quot;</span><span class="nt">&gt;</span>session.tree<span class="nt">&lt;/field&gt;</span>
            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;model&quot;</span><span class="nt">&gt;</span>openacademy.session<span class="nt">&lt;/field&gt;</span>
            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;arch&quot;</span> <span class="na">type=</span><span class="s">&quot;xml&quot;</span><span class="nt">&gt;</span>
<span class="hll">                <span class="nt">&lt;tree</span> <span class="na">string=</span><span class="s">&quot;Session Tree&quot;</span> <span class="na">decoration-info=</span><span class="s">&quot;duration&amp;lt;5&quot;</span> <span class="na">decoration-danger=</span><span class="s">&quot;duration&amp;gt;15&quot;</span><span class="nt">&gt;</span>
</span>                    <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;name&quot;</span><span class="nt">/&gt;</span>
                    <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;course_id&quot;</span><span class="nt">/&gt;</span>
<span class="hll">                    <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;duration&quot;</span> <span class="na">invisible=</span><span class="s">&quot;1&quot;</span><span class="nt">/&gt;</span>
</span>                    <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;taken_seats&quot;</span> <span class="na">widget=</span><span class="s">&quot;progressbar&quot;</span><span class="nt">/&gt;</span>
                <span class="nt">&lt;/tree&gt;</span>
            <span class="nt">&lt;/field&gt;</span>
</pre></div>
</div>
</div></div></div></section><section id="calendars"><h3 >Calendarios</h3><p >Muestra los registros como calendario de eventos. Su elemento raíz es <code >&lt;calendar&gt;</code> y sus atributos más comunes son:</p><dl ><dt ><code >color</code></dt><dd ><p >El nombre del campo utilizado para <em >colorear</em>. Los colores se distribuyen automáticamente a los eventos y acontecimientos en el mismo <em >segmento de color</em> (los registros que tienen el mismo valor para su campo <code >@color</code>) se les dará el mismo color.</p></dd><dt ><code >date_start</code></dt><dd ><p >campo del registro con la fecha de inicio del evento</p></dd><dt ><code >date_stop</code> (opcional)</dt><dd ><p >campo de registro con la fecha final del evento</p></dd><dt ><code >string</code></dt><dd >record's field to define the label for each calendar event</dd></dl><div class="highlight-xml"><div class="highlight"><pre><span></span><span class="nt">&lt;calendar</span> <span class="na">string=</span><span class="s">&quot;Ideas&quot;</span> <span class="na">date_start=</span><span class="s">&quot;invent_date&quot;</span> <span class="na">color=</span><span class="s">&quot;inventor_id&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;name&quot;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/calendar&gt;</span>
</pre></div>
</div>
<div role="alert" class="alert-exercise alert"><p class="alert-title">Exercise</p><p >Vista de calendario</p><p >Agregar una vista de calendario al modelo <em >Session</em> que permita visualizar los eventos asociados a la OpenAcademy.</p><ol ><li ><p >Agregar un campo <code >end_date</code>  calculado a partir de <code >start_date</code> y <code >duration</code></p><div role="alert" class="alert-info alert"><p class="alert-title">Truco</p><p >la función inversa hace que el campo se pueda escribir y permite mover las sesiones (a través de arrastrar y soltar) en la vista Calendario</p></div></li><li ><p >Agregar una vista de calendario al modelo <em >Session</em></p></li><li ><p >Y añadir la vista de calendario a la acción del modelo <em >Session</em></p></li></ol><div class="pq-patch"><em >openacademy/models.py</em><div class="pq-section"><div class="highlight-python"><div class="highlight"><pre><span></span><span class="c1"># -*- coding: utf-8 -*-</span>

<span class="hll"><span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">timedelta</span>
</span><span class="kn">from</span> <span class="nn">odoo</span> <span class="kn">import</span> <span class="n">models</span><span class="p">,</span> <span class="n">fields</span><span class="p">,</span> <span class="n">api</span><span class="p">,</span> <span class="n">exceptions</span>

<span class="k">class</span> <span class="nc">Course</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span></span>    <span class="n">attendee_ids</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">Many2many</span><span class="p">(</span><span class="s1">&#39;res.partner&#39;</span><span class="p">,</span> <span class="n">string</span><span class="o">=</span><span class="s2">&quot;Attendees&quot;</span><span class="p">)</span>

    <span class="n">taken_seats</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">Float</span><span class="p">(</span><span class="n">string</span><span class="o">=</span><span class="s2">&quot;Taken seats&quot;</span><span class="p">,</span> <span class="n">compute</span><span class="o">=</span><span class="s1">&#39;_taken_seats&#39;</span><span class="p">)</span>
<span class="hll">    <span class="n">end_date</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">Date</span><span class="p">(</span><span class="n">string</span><span class="o">=</span><span class="s2">&quot;End Date&quot;</span><span class="p">,</span> <span class="n">store</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
</span><span class="hll">        <span class="n">compute</span><span class="o">=</span><span class="s1">&#39;_get_end_date&#39;</span><span class="p">,</span> <span class="n">inverse</span><span class="o">=</span><span class="s1">&#39;_set_end_date&#39;</span><span class="p">)</span>
</span>
    <span class="nd">@api.depends</span><span class="p">(</span><span class="s1">&#39;seats&#39;</span><span class="p">,</span> <span class="s1">&#39;attendee_ids&#39;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">_taken_seats</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span></span>                <span class="p">},</span>
            <span class="p">}</span>

<span class="hll">    <span class="nd">@api.depends</span><span class="p">(</span><span class="s1">&#39;start_date&#39;</span><span class="p">,</span> <span class="s1">&#39;duration&#39;</span><span class="p">)</span>
</span><span class="hll">    <span class="k">def</span> <span class="nf">_get_end_date</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span class="hll">        <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>
</span><span class="hll">            <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">start_date</span> <span class="ow">and</span> <span class="n">r</span><span class="o">.</span><span class="n">duration</span><span class="p">):</span>
</span><span class="hll">                <span class="n">r</span><span class="o">.</span><span class="n">end_date</span> <span class="o">=</span> <span class="n">r</span><span class="o">.</span><span class="n">start_date</span>
</span><span class="hll">                <span class="k">continue</span>
</span><span class="hll">
</span><span class="hll">            <span class="c1"># Add duration to start_date, but: Monday + 5 days = Saturday, so</span>
</span><span class="hll">            <span class="c1"># subtract one second to get on Friday instead</span>
</span><span class="hll">            <span class="n">start</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">Datetime</span><span class="o">.</span><span class="n">from_string</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">start_date</span><span class="p">)</span>
</span><span class="hll">            <span class="n">duration</span> <span class="o">=</span> <span class="n">timedelta</span><span class="p">(</span><span class="n">days</span><span class="o">=</span><span class="n">r</span><span class="o">.</span><span class="n">duration</span><span class="p">,</span> <span class="n">seconds</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
</span><span class="hll">            <span class="n">r</span><span class="o">.</span><span class="n">end_date</span> <span class="o">=</span> <span class="n">start</span> <span class="o">+</span> <span class="n">duration</span>
</span><span class="hll">
</span><span class="hll">    <span class="k">def</span> <span class="nf">_set_end_date</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span class="hll">        <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>
</span><span class="hll">            <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">start_date</span> <span class="ow">and</span> <span class="n">r</span><span class="o">.</span><span class="n">end_date</span><span class="p">):</span>
</span><span class="hll">                <span class="k">continue</span>
</span><span class="hll">
</span><span class="hll">            <span class="c1"># Compute the difference between dates, but: Friday - Monday = 4 days,</span>
</span><span class="hll">            <span class="c1"># so add one day to get 5 days instead</span>
</span><span class="hll">            <span class="n">start_date</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">Datetime</span><span class="o">.</span><span class="n">from_string</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">start_date</span><span class="p">)</span>
</span><span class="hll">            <span class="n">end_date</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">Datetime</span><span class="o">.</span><span class="n">from_string</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">end_date</span><span class="p">)</span>
</span><span class="hll">            <span class="n">r</span><span class="o">.</span><span class="n">duration</span> <span class="o">=</span> <span class="p">(</span><span class="n">end_date</span> <span class="o">-</span> <span class="n">start_date</span><span class="p">)</span><span class="o">.</span><span class="n">days</span> <span class="o">+</span> <span class="mi">1</span>
</span><span class="hll">
</span>    <span class="nd">@api.constrains</span><span class="p">(</span><span class="s1">&#39;instructor_id&#39;</span><span class="p">,</span> <span class="s1">&#39;attendee_ids&#39;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">_check_instructor_not_in_attendees</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>
</pre></div>
</div>
</div><em >openacademy/views/openacademy.xml</em><div class="pq-section"><div class="highlight-xml"><div class="highlight"><pre><span></span>            <span class="nt">&lt;/field&gt;</span>
        <span class="nt">&lt;/record&gt;</span>

<span class="hll">        <span class="c">&lt;!-- calendar view --&gt;</span>
</span><span class="hll">        <span class="nt">&lt;record</span> <span class="na">model=</span><span class="s">&quot;ir.ui.view&quot;</span> <span class="na">id=</span><span class="s">&quot;session_calendar_view&quot;</span><span class="nt">&gt;</span>
</span><span class="hll">            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;name&quot;</span><span class="nt">&gt;</span>session.calendar<span class="nt">&lt;/field&gt;</span>
</span><span class="hll">            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;model&quot;</span><span class="nt">&gt;</span>openacademy.session<span class="nt">&lt;/field&gt;</span>
</span><span class="hll">            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;arch&quot;</span> <span class="na">type=</span><span class="s">&quot;xml&quot;</span><span class="nt">&gt;</span>
</span><span class="hll">                <span class="nt">&lt;calendar</span> <span class="na">string=</span><span class="s">&quot;Session Calendar&quot;</span> <span class="na">date_start=</span><span class="s">&quot;start_date&quot;</span> <span class="na">date_stop=</span><span class="s">&quot;end_date&quot;</span> <span class="na">color=</span><span class="s">&quot;instructor_id&quot;</span><span class="nt">&gt;</span>
</span><span class="hll">                    <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;name&quot;</span><span class="nt">/&gt;</span>
</span><span class="hll">                <span class="nt">&lt;/calendar&gt;</span>
</span><span class="hll">            <span class="nt">&lt;/field&gt;</span>
</span><span class="hll">        <span class="nt">&lt;/record&gt;</span>
</span><span class="hll">
</span>        <span class="nt">&lt;record</span> <span class="na">model=</span><span class="s">&quot;ir.actions.act_window&quot;</span> <span class="na">id=</span><span class="s">&quot;session_list_action&quot;</span><span class="nt">&gt;</span>
            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;name&quot;</span><span class="nt">&gt;</span>Sessions<span class="nt">&lt;/field&gt;</span>
            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;res_model&quot;</span><span class="nt">&gt;</span>openacademy.session<span class="nt">&lt;/field&gt;</span>
            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;view_type&quot;</span><span class="nt">&gt;</span>form<span class="nt">&lt;/field&gt;</span>
<span class="hll">            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;view_mode&quot;</span><span class="nt">&gt;</span>tree,form,calendar<span class="nt">&lt;/field&gt;</span>
</span>        <span class="nt">&lt;/record&gt;</span>

        <span class="nt">&lt;menuitem</span> <span class="na">id=</span><span class="s">&quot;session_menu&quot;</span> <span class="na">name=</span><span class="s">&quot;Sessions&quot;</span>
</pre></div>
</div>
</div></div></div></section><section id="id4"><h3 >Vistas de búsqueda</h3><p >En la vista de búsqueda los elementos <code >&lt;field&gt;</code>  pueden tener un <code >@filter_domain</code> que reemplaza el dominio generado para la búsqueda en el campo de búsqueda. En el dominio dado, <code >self</code> representa el valor introducido por el usuario. En el siguiente ejemplo, se utiliza para buscar en campos <code >name</code> y <code >description</code>.</p><p >Vistas de búsqueda también pueden contener elementos <code >&lt;filter&gt;</code>, que actúan como alternativa a búsquedas predefinidas. Los filtros deben tener uno de los siguientes atributos:</p><dl ><dt ><code >domain</code></dt><dd ><p >añadir el dominio dado a la búsqueda actual</p></dd><dt ><code >context</code></dt><dd ><p >añadir algún contexto para la búsqueda actual; Utilice la tecla <code >group_by</code> para agrupar los resultados por el campo nombre</p></dd></dl><div class="highlight-xml"><div class="highlight"><pre><span></span><span class="nt">&lt;search</span> <span class="na">string=</span><span class="s">&quot;Ideas&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;name&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;description&quot;</span> <span class="na">string=</span><span class="s">&quot;Name and description&quot;</span>
           <span class="na">filter_domain=</span><span class="s">&quot;[&#39;|&#39;, (&#39;name&#39;, &#39;ilike&#39;, self), (&#39;description&#39;, &#39;ilike&#39;, self)]&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;inventor_id&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;country_id&quot;</span> <span class="na">widget=</span><span class="s">&quot;selection&quot;</span><span class="nt">/&gt;</span>

    <span class="nt">&lt;filter</span> <span class="na">name=</span><span class="s">&quot;my_ideas&quot;</span> <span class="na">string=</span><span class="s">&quot;My Ideas&quot;</span>
            <span class="na">domain=</span><span class="s">&quot;[(&#39;inventor_id&#39;, &#39;=&#39;, uid)]&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;group</span> <span class="na">string=</span><span class="s">&quot;Group By&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;filter</span> <span class="na">name=</span><span class="s">&quot;group_by_inventor&quot;</span> <span class="na">string=</span><span class="s">&quot;Inventor&quot;</span>
                <span class="na">context=</span><span class="s">&quot;{&#39;group_by&#39;: &#39;inventor_id&#39;}&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/group&gt;</span>
<span class="nt">&lt;/search&gt;</span>
</pre></div>
</div>
<p >Para utilizar una vista de búsqueda no predeterminada en una acción, debe vincularse con el campo de  <code >search_view_id</code> del registro de la acción.</p><p >La acción también puede establecer valores predeterminados para los campos de búsqueda a través de su campo <code >context</code>: las claves del contexto deben tener la forma <code class="samp">search_default_<em >field_name</em></code> la cual inicializará  <em >field_name</em> con el valor proporcionado. Filtros de búsqueda deben tener un <code >@name</code> opcional para tener un valor por defecto y comportarse como booleanos (que pueden sólo ser activadas por defecto).</p><div role="alert" class="alert-exercise alert"><p class="alert-title">Exercise</p><p >Vistas de búsqueda</p><ol ><li ><p >Añadir un botón en la vista de búsqueda para filtrar los cursos de tal forma que encuentre solo los registros donde el usuario actual sea el responsable del curso. Y que esté seleccionada por defecto.</p></li><li ><p >Agregar un botón para agrupar los cursos por el usuario responsable.</p></li></ol><div class="pq-patch"><em >openacademy/views/openacademy.xml</em><div class="pq-section"><div class="highlight-xml"><div class="highlight"><pre><span></span>                <span class="nt">&lt;search&gt;</span>
                    <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;name&quot;</span><span class="nt">/&gt;</span>
                    <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;description&quot;</span><span class="nt">/&gt;</span>
<span class="hll">                    <span class="nt">&lt;filter</span> <span class="na">name=</span><span class="s">&quot;my_courses&quot;</span> <span class="na">string=</span><span class="s">&quot;My Courses&quot;</span>
</span><span class="hll">                            <span class="na">domain=</span><span class="s">&quot;[(&#39;responsible_id&#39;, &#39;=&#39;, uid)]&quot;</span><span class="nt">/&gt;</span>
</span><span class="hll">                    <span class="nt">&lt;group</span> <span class="na">string=</span><span class="s">&quot;Group By&quot;</span><span class="nt">&gt;</span>
</span><span class="hll">                        <span class="nt">&lt;filter</span> <span class="na">name=</span><span class="s">&quot;by_responsible&quot;</span> <span class="na">string=</span><span class="s">&quot;Responsible&quot;</span>
</span><span class="hll">                                <span class="na">context=</span><span class="s">&quot;{&#39;group_by&#39;: &#39;responsible_id&#39;}&quot;</span><span class="nt">/&gt;</span>
</span><span class="hll">                    <span class="nt">&lt;/group&gt;</span>
</span>                <span class="nt">&lt;/search&gt;</span>
            <span class="nt">&lt;/field&gt;</span>
        <span class="nt">&lt;/record&gt;</span>
</pre></div>
</div>
<div class="highlight-xml"><div class="highlight"><pre><span></span>            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;res_model&quot;</span><span class="nt">&gt;</span>openacademy.course<span class="nt">&lt;/field&gt;</span>
            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;view_type&quot;</span><span class="nt">&gt;</span>form<span class="nt">&lt;/field&gt;</span>
            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;view_mode&quot;</span><span class="nt">&gt;</span>tree,form<span class="nt">&lt;/field&gt;</span>
<span class="hll">            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;context&quot;</span> <span class="na">eval=</span><span class="s">&quot;{&#39;search_default_my_courses&#39;: 1}&quot;</span><span class="nt">/&gt;</span>
</span>            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;help&quot;</span> <span class="na">type=</span><span class="s">&quot;html&quot;</span><span class="nt">&gt;</span>
                <span class="nt">&lt;p</span> <span class="na">class=</span><span class="s">&quot;oe_view_nocontent_create&quot;</span><span class="nt">&gt;</span>Create the first course
                <span class="nt">&lt;/p&gt;</span>
</pre></div>
</div>
</div></div></div></section><section id="gantt"><h3 >Gantt</h3><div role="alert" class="alert-warning alert"><p class="alert-title">Advertencia</p><p >La vista gantt requiere el módulo web_gantt el cuál está presente en <a href="../setup/install.html#setup-install-editions" class="internal alert-link reference"><span class="std std-ref">the enterprise edition</span></a> versión.</p></div><p >Gráficos de barras horizontales normalmente se utilizan para mostrar la planificación del proyecto y su avance, su elemento raíz es <code >&lt;gantt&gt;</code>.</p><div class="highlight-xml"><div class="highlight"><pre><span></span><span class="nt">&lt;gantt</span> <span class="na">string=</span><span class="s">&quot;Ideas&quot;</span>
       <span class="na">date_start=</span><span class="s">&quot;invent_date&quot;</span>
       <span class="na">date_stop=</span><span class="s">&quot;date_finished&quot;</span>
       <span class="na">progress=</span><span class="s">&quot;progress&quot;</span>
       <span class="na">default_group_by=</span><span class="s">&quot;inventor_id&quot;</span> <span class="nt">/&gt;</span>
</pre></div>
</div>
<div role="alert" class="alert-exercise alert"><p class="alert-title">Exercise</p><p >Diagramas de Gantt</p><p >Agregar un diagrama de Gantt que permite al usuario ver la programación de las sesiones relacionados con el módulo OpenAcademy. Las sesiones deben agruparse por instructor.</p><ol ><li ><p >Crear un campo calculado expresando la duración de la sesión en horas</p></li><li ><p >Agregar la definición de la vista de gantt y agregar la vista de gantt a la acción del modelo <em >Session</em></p></li></ol><div class="pq-patch"><em >openacademy/models.py</em><div class="pq-section"><div class="highlight-python"><div class="highlight"><pre><span></span>    <span class="n">end_date</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">Date</span><span class="p">(</span><span class="n">string</span><span class="o">=</span><span class="s2">&quot;End Date&quot;</span><span class="p">,</span> <span class="n">store</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
        <span class="n">compute</span><span class="o">=</span><span class="s1">&#39;_get_end_date&#39;</span><span class="p">,</span> <span class="n">inverse</span><span class="o">=</span><span class="s1">&#39;_set_end_date&#39;</span><span class="p">)</span>

<span class="hll">    <span class="n">hours</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">Float</span><span class="p">(</span><span class="n">string</span><span class="o">=</span><span class="s2">&quot;Duration in hours&quot;</span><span class="p">,</span>
</span><span class="hll">                         <span class="n">compute</span><span class="o">=</span><span class="s1">&#39;_get_hours&#39;</span><span class="p">,</span> <span class="n">inverse</span><span class="o">=</span><span class="s1">&#39;_set_hours&#39;</span><span class="p">)</span>
</span><span class="hll">
</span>    <span class="nd">@api.depends</span><span class="p">(</span><span class="s1">&#39;seats&#39;</span><span class="p">,</span> <span class="s1">&#39;attendee_ids&#39;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">_taken_seats</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span></span>            <span class="n">end_date</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">Datetime</span><span class="o">.</span><span class="n">from_string</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">end_date</span><span class="p">)</span>
            <span class="n">r</span><span class="o">.</span><span class="n">duration</span> <span class="o">=</span> <span class="p">(</span><span class="n">end_date</span> <span class="o">-</span> <span class="n">start_date</span><span class="p">)</span><span class="o">.</span><span class="n">days</span> <span class="o">+</span> <span class="mi">1</span>

<span class="hll">    <span class="nd">@api.depends</span><span class="p">(</span><span class="s1">&#39;duration&#39;</span><span class="p">)</span>
</span><span class="hll">    <span class="k">def</span> <span class="nf">_get_hours</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span class="hll">        <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>
</span><span class="hll">            <span class="n">r</span><span class="o">.</span><span class="n">hours</span> <span class="o">=</span> <span class="n">r</span><span class="o">.</span><span class="n">duration</span> <span class="o">*</span> <span class="mi">24</span>
</span><span class="hll">
</span><span class="hll">    <span class="k">def</span> <span class="nf">_set_hours</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span class="hll">        <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>
</span><span class="hll">            <span class="n">r</span><span class="o">.</span><span class="n">duration</span> <span class="o">=</span> <span class="n">r</span><span class="o">.</span><span class="n">hours</span> <span class="o">/</span> <span class="mi">24</span>
</span><span class="hll">
</span>    <span class="nd">@api.constrains</span><span class="p">(</span><span class="s1">&#39;instructor_id&#39;</span><span class="p">,</span> <span class="s1">&#39;attendee_ids&#39;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">_check_instructor_not_in_attendees</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>
</pre></div>
</div>
</div><em >openacademy/views/openacademy.xml</em><div class="pq-section"><div class="highlight-xml"><div class="highlight"><pre><span></span>        <span class="nt">&lt;record</span> <span class="na">model=</span><span class="s">&quot;ir.ui.view&quot;</span> <span class="na">id=</span><span class="s">&quot;session_gantt_view&quot;</span><span class="nt">&gt;</span>
            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;name&quot;</span><span class="nt">&gt;</span>session.gantt<span class="nt">&lt;/field&gt;</span>
            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;model&quot;</span><span class="nt">&gt;</span>openacademy.session<span class="nt">&lt;/field&gt;</span>
<span class="hll">            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;arch&quot;</span> <span class="na">type=</span><span class="s">&quot;xml&quot;</span><span class="nt">&gt;</span>
</span><span class="hll">                <span class="nt">&lt;gantt</span> <span class="na">string=</span><span class="s">&quot;Session Gantt&quot;</span> <span class="na">color=</span><span class="s">&quot;course_id&quot;</span>
</span><span class="hll">                       <span class="na">date_start=</span><span class="s">&quot;start_date&quot;</span> <span class="na">date_delay=</span><span class="s">&quot;hours&quot;</span>
</span><span class="hll">                       <span class="na">default_group_by=</span><span class="s">&#39;instructor_id&#39;</span><span class="nt">&gt;</span>
</span><span class="hll">                    <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;name&quot;</span><span class="nt">/&gt;</span>
</span><span class="hll">                <span class="nt">&lt;/gantt&gt;</span>
</span><span class="hll">            <span class="nt">&lt;/field&gt;</span>
</span><span class="hll">        <span class="nt">&lt;/record&gt;</span>
</span><span class="hll">
</span><span class="hll">        <span class="nt">&lt;record</span> <span class="na">model=</span><span class="s">&quot;ir.actions.act_window&quot;</span> <span class="na">id=</span><span class="s">&quot;session_list_action&quot;</span><span class="nt">&gt;</span>
</span><span class="hll">            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;name&quot;</span><span class="nt">&gt;</span>Sessions<span class="nt">&lt;/field&gt;</span>
</span><span class="hll">            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;res_model&quot;</span><span class="nt">&gt;</span>openacademy.session<span class="nt">&lt;/field&gt;</span>
</span>            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;view_type&quot;</span><span class="nt">&gt;</span>form<span class="nt">&lt;/field&gt;</span>
            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;view_mode&quot;</span><span class="nt">&gt;</span>tree,form,calendar,gantt<span class="nt">&lt;/field&gt;</span>
        <span class="nt">&lt;/record&gt;</span>

<span class="hll">        <span class="nt">&lt;menuitem</span> <span class="na">id=</span><span class="s">&quot;session_menu&quot;</span> <span class="na">name=</span><span class="s">&quot;Sessions&quot;</span>
</span>                  <span class="na">parent=</span><span class="s">&quot;openacademy_menu&quot;</span>
                  <span class="na">action=</span><span class="s">&quot;session_list_action&quot;</span><span class="nt">/&gt;</span>
</pre></div>
</div>
</div></div></div></section><section id="graph-views"><h3 >Vistas en Gráfico</h3><p >Las vistas gráfico permiten agregar resumen y análisis de modelos, su elemento raíz es <code >&lt;graph&gt;</code>.</p><div role="alert" class="alert-info alert"><p class="alert-title">Nota</p><p >Vista Pivote (elemento raíz <code >&lt;pivot&gt;</code>) es una tabla multidimensional, permite la selección de dimensiones para obtener el conjunto de datos adecuado para presentar los datos de forma más gráfica. La vista pivote comparte la misma definición contenida como vistas gráfico.</p></div><p >Vistas de gráfico tienen 4 modos de visualización, se selecciona el modo predeterminado mediante el atributo <code >@type</code>.</p><dl ><dt >Bar (por defecto)</dt><dd ><p >un gráfico de barras, la primera dimensión se utiliza para definir los grupos en el eje horizontal, las otras dimensiones definen las barras agregadas dentro de cada grupo.</p><p >Por defecto las barras están lado a lado, éstas pueden apilarse utilizando <code >@stacked=&quot;True&quot;</code> en el <code >&lt;graph&gt;</code></p></dd><dt >Line</dt><dd ><p >Gráfica de Líneas XY</p></dd><dt >Pie</dt><dd ><p >Gráfica de pastel de 2 dimensiones</p></dd></dl><p >Vistas de gráfico contienen <code >&lt;field&gt;</code> con un atributo obligatorio <code >@type</code> tomando los valores:</p><dl ><dt ><code >row</code> (default)</dt><dd ><p >el campo debe agregarse por defecto</p></dd><dt ><code >measure</code></dt><dd ><p >el campo debe ser agregado en lugar de agrupar por él</p></dd></dl><div class="highlight-xml"><div class="highlight"><pre><span></span><span class="nt">&lt;graph</span> <span class="na">string=</span><span class="s">&quot;Total idea score by Inventor&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;inventor_id&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;score&quot;</span> <span class="na">type=</span><span class="s">&quot;measure&quot;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/graph&gt;</span>
</pre></div>
</div>
<div role="alert" class="alert-warning alert"><p class="alert-title">Advertencia</p><p >Las vistas de gráfico realizan agregaciones en los valores de la base de datos, no trabajan con campos calculados que no estén almacenados.</p></div><div role="alert" class="alert-exercise alert"><p class="alert-title">Exercise</p><p >Vistas en Gráfico</p><p >Agregar una vista de gráfico en el objeto Session que muestre, para cada curso, el número de participantes bajo la forma de un gráfico de barras.</p><ol ><li ><p >Agregar el número de asistentes como un campo calculado almacenado</p></li><li ><p >Luego añadir la vista relevante</p></li></ol><div class="pq-patch"><em >openacademy/models.py</em><div class="pq-section"><div class="highlight-python"><div class="highlight"><pre><span></span>    <span class="n">hours</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">Float</span><span class="p">(</span><span class="n">string</span><span class="o">=</span><span class="s2">&quot;Duration in hours&quot;</span><span class="p">,</span>
                         <span class="n">compute</span><span class="o">=</span><span class="s1">&#39;_get_hours&#39;</span><span class="p">,</span> <span class="n">inverse</span><span class="o">=</span><span class="s1">&#39;_set_hours&#39;</span><span class="p">)</span>

<span class="hll">    <span class="n">attendees_count</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">Integer</span><span class="p">(</span>
</span><span class="hll">        <span class="n">string</span><span class="o">=</span><span class="s2">&quot;Attendees count&quot;</span><span class="p">,</span> <span class="n">compute</span><span class="o">=</span><span class="s1">&#39;_get_attendees_count&#39;</span><span class="p">,</span> <span class="n">store</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</span><span class="hll">
</span>    <span class="nd">@api.depends</span><span class="p">(</span><span class="s1">&#39;seats&#39;</span><span class="p">,</span> <span class="s1">&#39;attendee_ids&#39;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">_taken_seats</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span></span>        <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>
            <span class="n">r</span><span class="o">.</span><span class="n">duration</span> <span class="o">=</span> <span class="n">r</span><span class="o">.</span><span class="n">hours</span> <span class="o">/</span> <span class="mi">24</span>

<span class="hll">    <span class="nd">@api.depends</span><span class="p">(</span><span class="s1">&#39;attendee_ids&#39;</span><span class="p">)</span>
</span><span class="hll">    <span class="k">def</span> <span class="nf">_get_attendees_count</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span class="hll">        <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>
</span><span class="hll">            <span class="n">r</span><span class="o">.</span><span class="n">attendees_count</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">attendee_ids</span><span class="p">)</span>
</span><span class="hll">
</span>    <span class="nd">@api.constrains</span><span class="p">(</span><span class="s1">&#39;instructor_id&#39;</span><span class="p">,</span> <span class="s1">&#39;attendee_ids&#39;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">_check_instructor_not_in_attendees</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>
</pre></div>
</div>
</div><em >openacademy/views/openacademy.xml</em><div class="pq-section"><div class="highlight-xml"><div class="highlight"><pre><span></span>        <span class="nt">&lt;record</span> <span class="na">model=</span><span class="s">&quot;ir.ui.view&quot;</span> <span class="na">id=</span><span class="s">&quot;openacademy_session_graph_view&quot;</span><span class="nt">&gt;</span>
            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;name&quot;</span><span class="nt">&gt;</span>openacademy.session.graph<span class="nt">&lt;/field&gt;</span>
            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;model&quot;</span><span class="nt">&gt;</span>openacademy.session<span class="nt">&lt;/field&gt;</span>
<span class="hll">            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;arch&quot;</span> <span class="na">type=</span><span class="s">&quot;xml&quot;</span><span class="nt">&gt;</span>
</span><span class="hll">                <span class="nt">&lt;graph</span> <span class="na">string=</span><span class="s">&quot;Participations by Courses&quot;</span><span class="nt">&gt;</span>
</span><span class="hll">                    <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;course_id&quot;</span><span class="nt">/&gt;</span>
</span><span class="hll">                    <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;attendees_count&quot;</span> <span class="na">type=</span><span class="s">&quot;measure&quot;</span><span class="nt">/&gt;</span>
</span><span class="hll">                <span class="nt">&lt;/graph&gt;</span>
</span><span class="hll">            <span class="nt">&lt;/field&gt;</span>
</span><span class="hll">        <span class="nt">&lt;/record&gt;</span>
</span><span class="hll">
</span><span class="hll">        <span class="nt">&lt;record</span> <span class="na">model=</span><span class="s">&quot;ir.actions.act_window&quot;</span> <span class="na">id=</span><span class="s">&quot;session_list_action&quot;</span><span class="nt">&gt;</span>
</span><span class="hll">            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;name&quot;</span><span class="nt">&gt;</span>Sessions<span class="nt">&lt;/field&gt;</span>
</span><span class="hll">            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;res_model&quot;</span><span class="nt">&gt;</span>openacademy.session<span class="nt">&lt;/field&gt;</span>
</span>            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;view_type&quot;</span><span class="nt">&gt;</span>form<span class="nt">&lt;/field&gt;</span>
            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;view_mode&quot;</span><span class="nt">&gt;</span>tree,form,calendar,gantt,graph<span class="nt">&lt;/field&gt;</span>
        <span class="nt">&lt;/record&gt;</span>

<span class="hll">        <span class="nt">&lt;menuitem</span> <span class="na">id=</span><span class="s">&quot;session_menu&quot;</span> <span class="na">name=</span><span class="s">&quot;Sessions&quot;</span>
</span>                  <span class="na">parent=</span><span class="s">&quot;openacademy_menu&quot;</span>
                  <span class="na">action=</span><span class="s">&quot;session_list_action&quot;</span><span class="nt">/&gt;</span>
</pre></div>
</div>
</div></div></div></section><section id="kanban"><h3 >Kanban</h3><p >Usada para organizar tareas, procesos de producción, etc… su elemento raíz es <code >&lt;kanban&gt;</code>.</p><p >Una vista de kanban muestra un conjunto de tarjetas que pueden ser agrupadas en columnas. Cada tarjeta representa un registro y cada columna los valores de un campo de agregación.</p><p >Por ejemplo, se organizan las tareas del proyecto por etapa (cada columna es una etapa), o por responsable (cada columna es un usuario), y así sucesivamente.</p><p >Vistas Kanban definen la estructura de cada tarjeta como una mezcla de elementos de un formulario (incluyendo HTML básico) y <a href="../reference/qweb.html#reference-qweb" class="internal reference"><span class="std std-ref">QWeb</span></a>.</p><div role="alert" class="alert-exercise alert"><p class="alert-title">Exercise</p><p >Vista Kanban</p><p >Agregar una vista de Kanban que muestre sesiones agrupadas por curso (las columnas son cursos).</p><ol ><li ><p >Agregar un campo entero de <code >color</code> al modelo <em >Session</em></p></li><li ><p >Añadir la opción de kanban y actualizar la acción</p></li></ol><div class="pq-patch"><em >openacademy/models.py</em><div class="pq-section"><div class="highlight-python"><div class="highlight"><pre><span></span>    <span class="n">duration</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">Float</span><span class="p">(</span><span class="n">digits</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Duration in days&quot;</span><span class="p">)</span>
    <span class="n">seats</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">Integer</span><span class="p">(</span><span class="n">string</span><span class="o">=</span><span class="s2">&quot;Number of seats&quot;</span><span class="p">)</span>
    <span class="n">active</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">Boolean</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="hll">    <span class="n">color</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">Integer</span><span class="p">()</span>
</span>
    <span class="n">instructor_id</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">Many2one</span><span class="p">(</span><span class="s1">&#39;res.partner&#39;</span><span class="p">,</span> <span class="n">string</span><span class="o">=</span><span class="s2">&quot;Instructor&quot;</span><span class="p">,</span>
        <span class="n">domain</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;|&#39;</span><span class="p">,</span> <span class="p">(</span><span class="s1">&#39;instructor&#39;</span><span class="p">,</span> <span class="s1">&#39;=&#39;</span><span class="p">,</span> <span class="bp">True</span><span class="p">),</span>
</pre></div>
</div>
</div><em >openacademy/views/openacademy.xml</em><div class="pq-section"><div class="highlight-xml+django"><div class="highlight"><pre><span></span>        &lt;record model=&quot;ir.ui.view&quot; id=&quot;view_openacad_session_kanban&quot;&gt;
            &lt;field name=&quot;name&quot;&gt;openacad.session.kanban&lt;/field&gt;
            &lt;field name=&quot;model&quot;&gt;openacademy.session&lt;/field&gt;
<span class="hll">            &lt;field name=&quot;arch&quot; type=&quot;xml&quot;&gt;
</span><span class="hll">                &lt;kanban default_group_by=&quot;course_id&quot;&gt;
</span><span class="hll">                    &lt;field name=&quot;color&quot;/&gt;
</span><span class="hll">                    &lt;templates&gt;
</span><span class="hll">                        &lt;t t-name=&quot;kanban-box&quot;&gt;
</span><span class="hll">                            &lt;div
</span><span class="hll">                                    t-attf-class=&quot;oe_kanban_color_{{kanban_getcolor(record.color.raw_value)}}
</span><span class="hll">                                                  oe_kanban_global_click_edit oe_semantic_html_override
</span><span class="hll">                                                  oe_kanban_card {{record.group_fancy==1 ? &#39;oe_kanban_card_fancy&#39; : &#39;&#39;}}&quot;&gt;
</span><span class="hll">                                &lt;div class=&quot;oe_dropdown_kanban&quot;&gt;
</span><span class="hll">                                    &lt;!-- dropdown menu --&gt;
</span><span class="hll">                                    &lt;div class=&quot;oe_dropdown_toggle&quot;&gt;
</span><span class="hll">                                        &lt;i class=&quot;fa fa-bars fa-lg&quot;/&gt;
</span><span class="hll">                                        &lt;ul class=&quot;oe_dropdown_menu&quot;&gt;
</span><span class="hll">                                            &lt;li&gt;
</span><span class="hll">                                                &lt;a type=&quot;delete&quot;&gt;Delete&lt;/a&gt;
</span><span class="hll">                                            &lt;/li&gt;
</span><span class="hll">                                            &lt;li&gt;
</span><span class="hll">                                                &lt;ul class=&quot;oe_kanban_colorpicker&quot;
</span><span class="hll">                                                    data-field=&quot;color&quot;/&gt;
</span><span class="hll">                                            &lt;/li&gt;
</span><span class="hll">                                        &lt;/ul&gt;
</span><span class="hll">                                    &lt;/div&gt;
</span><span class="hll">                                    &lt;div class=&quot;oe_clear&quot;&gt;&lt;/div&gt;
</span><span class="hll">                                &lt;/div&gt;
</span><span class="hll">                                &lt;div t-attf-class=&quot;oe_kanban_content&quot;&gt;
</span><span class="hll">                                    &lt;!-- title --&gt;
</span><span class="hll">                                    Session name:
</span><span class="hll">                                    &lt;field name=&quot;name&quot;/&gt;
</span><span class="hll">                                    &lt;br/&gt;
</span><span class="hll">                                    Start date:
</span><span class="hll">                                    &lt;field name=&quot;start_date&quot;/&gt;
</span><span class="hll">                                    &lt;br/&gt;
</span><span class="hll">                                    duration:
</span><span class="hll">                                    &lt;field name=&quot;duration&quot;/&gt;
</span><span class="hll">                                &lt;/div&gt;
</span><span class="hll">                            &lt;/div&gt;
</span><span class="hll">                        &lt;/t&gt;
</span><span class="hll">                    &lt;/templates&gt;
</span><span class="hll">                &lt;/kanban&gt;
</span><span class="hll">            &lt;/field&gt;
</span><span class="hll">        &lt;/record&gt;
</span><span class="hll">
</span><span class="hll">        &lt;record model=&quot;ir.actions.act_window&quot; id=&quot;session_list_action&quot;&gt;
</span><span class="hll">            &lt;field name=&quot;name&quot;&gt;Sessions&lt;/field&gt;
</span><span class="hll">            &lt;field name=&quot;res_model&quot;&gt;openacademy.session&lt;/field&gt;
</span>            &lt;field name=&quot;view_type&quot;&gt;form&lt;/field&gt;
            &lt;field name=&quot;view_mode&quot;&gt;tree,form,calendar,gantt,graph,kanban&lt;/field&gt;
        &lt;/record&gt;

<span class="hll">        &lt;menuitem id=&quot;session_menu&quot; name=&quot;Sessions&quot;
</span>                  parent=&quot;openacademy_menu&quot;
                  action=&quot;session_list_action&quot;/&gt;

</pre></div>
</div>
</div></div></div></section><section id="security"><h2 >Seguridad</h2><p >Mecanismos de control de acceso deben ser configurados para lograr una política coherente de seguridad.</p></section><section id="group-based-access-control-mechanisms"><h3 >Mecanismos de control de acceso basado en grupos</h3><p >Los grupos se crean como registros convencionales del modelo <code >res.groups</code> y garantizan el accesos a través de las definiciones de permisos en los menús. Sin embargo incluso si un objeto no tiene menú, éstos se les puede acceder indirectamente, entonces las reglas CRUD (leer, escribir, crear, borrar) deben definirse para los grupos a nivel de objetos. Estas reglas se insertan generalmente a través de archivos CSV dentro de los módulos. Es posible restringir el acceso a campos específicos de una vista o a un objeto utilizando el atributo <code >groups</code> del campo.</p></section><section id="access-rights"><h3 >Derechos de acceso</h3><p >Los derechos de acceso se definen como registros del modelo <code >ir.model.access</code>. Cada derecho de acceso está asociado a un modelo, un grupo (o no grupo para el caso de un acceso global) y un conjunto de permisos: leer, escribir, crear, borrar. Estos derechos de acceso son creados generalmente por un archivo CSV con el nombre de su modelo: <code >ir.model.access.csv</code>.</p><div class="highlight-text"><div class="highlight"><pre><span></span>id,name,model_id/id,group_id/id,perm_read,perm_write,perm_create,perm_unlink
access_idea_idea,idea.idea,model_idea_idea,base.group_user,1,1,1,0
access_idea_vote,idea.vote,model_idea_vote,base.group_user,1,1,1,0
</pre></div>
</div>
<div role="alert" class="alert-exercise alert"><p class="alert-title">Exercise</p><p >Añadir control de acceso mediante la interfaz de Odoo</p><p >Crea un nuevo usuario “John Smith”. Crear un grupo &quot;OpenAcademy / Session Read&quot; con acceso de lectura al modelo <em >Session</em>.</p><ol ><li ><p >Crea un nuevo usuario <em >John Smith</em> a través de <span class="menuselection">Settings ‣ Users ‣ Users</span></p></li><li ><p >Crear un nuevo grupo llamado <code >session_read</code> a través del menú <span class="menuselection">Settings ‣ Users ‣ Groups</span>, que debe tener acceso de lectura sobre el modelo <em >Session</em></p></li><li ><p >Editar <em >John Smith</em> para que sea un miembro de <code >session_read</code></p></li><li ><p >Inicie la sesión como <em >John Smith</em> para comprobar que los derechos de acceso son correctos</p></li></ol></div><div role="alert" class="alert-exercise alert"><p class="alert-title">Exercise</p><p >Añadir el control de acceso a través de los archivos de datos en el módulo</p><p >El uso de archivos de datos,</p><ul ><li ><p >Crea un grupo <em >OpenAcademy / Manager</em> con pleno acceso a todos los modelos OpenAcademy</p></li><li ><p >Hacer <em >Session</em> y <em >Course</em> leíbles por todos los usuarios</p></li></ul><ol ><li ><p >Crear un nuevo archivo <code >openacademy/security/security.xml</code> que tenga el grupo OpenAcademy Manager en él</p></li><li ><p >Editar el archivo <code >openacademy/security/ir.model.access.csv</code> con los derechos de acceso a los modelos</p></li><li ><p >Finalmente actualizar <code >openacademy/__manifest__.py</code> para añadir los nuevos archivos de datos en él</p></li></ol><div class="pq-patch"><em >openacademy/__manifest__.py</em><div class="pq-section"><div class="highlight-python"><div class="highlight"><pre><span></span>
    <span class="c1"># always loaded</span>
<span class="hll">    <span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="p">[</span>
</span><span class="hll">        <span class="s1">&#39;security/security.xml&#39;</span><span class="p">,</span>
</span>        <span class="s1">&#39;security/ir.model.access.csv&#39;</span><span class="p">,</span>
        <span class="s1">&#39;templates.xml&#39;</span><span class="p">,</span>
        <span class="s1">&#39;views/openacademy.xml&#39;</span><span class="p">,</span>
        <span class="s1">&#39;views/partner.xml&#39;</span><span class="p">,</span>
</pre></div>
</div>
</div><em >openacademy/security/ir.model.access.csv</em><div class="pq-section"><div class="highlight-guess"><div class="highlight"><pre><span></span>id,name,model_id/id,group_id/id,perm_read,perm_write,perm_create,perm_unlink
<span class="hll">course_manager,course manager,model_openacademy_course,group_manager,1,1,1,1
</span><span class="hll">session_manager,session manager,model_openacademy_session,group_manager,1,1,1,1
</span><span class="hll">course_read_all,course all,model_openacademy_course,,1,0,0,0
</span><span class="hll">session_read_all,session all,model_openacademy_session,,1,0,0,0
</span></pre></div>
</div>
</div><em >openacademy/security/security.xml</em><div class="pq-section"><div class="highlight-xml"><div class="highlight"><pre><span></span><span class="hll"><span class="nt">&lt;odoo&gt;</span>
</span><span class="hll">
</span><span class="hll">        <span class="nt">&lt;record</span> <span class="na">id=</span><span class="s">&quot;group_manager&quot;</span> <span class="na">model=</span><span class="s">&quot;res.groups&quot;</span><span class="nt">&gt;</span>
</span><span class="hll">            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;name&quot;</span><span class="nt">&gt;</span>OpenAcademy / Manager<span class="nt">&lt;/field&gt;</span>
</span><span class="hll">        <span class="nt">&lt;/record&gt;</span>
</span><span class="hll">
</span><span class="hll"><span class="nt">&lt;/odoo&gt;</span>
</span></pre></div>
</div>
</div></div></div></section><section id="record-rules"><h3 >Reglas de Registro</h3><p >Una regla de registro restringe los derechos de acceso a un subconjunto de registros de un modelo dado. Una regla es un registro del modelo <code >ir.rule</code>, y se asocia a un modelo, un número de grupos (campo Many2Many), los permisos a los que se aplicarán, y un dominio. El dominio especifica a cuales registros los derechos de acceso serán limitados.</p><p >Aquí un ejemplo de una regla que impide la eliminación de los prospectos (leads) que no se encuentren en el estado <code >cancel</code>. Observe que el valor del campo <code >groups</code> debe seguir la misma convención como el método <a href="../reference/orm.html#odoo.models.Model.write" class="internal reference" title="odoo.models.Model.write"><code class="py py-meth xref">write()</code></a> del ORM.</p><div class="highlight-xml"><div class="highlight"><pre><span></span><span class="nt">&lt;record</span> <span class="na">id=</span><span class="s">&quot;delete_cancelled_only&quot;</span> <span class="na">model=</span><span class="s">&quot;ir.rule&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;name&quot;</span><span class="nt">&gt;</span>Only cancelled leads may be deleted<span class="nt">&lt;/field&gt;</span>
    <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;model_id&quot;</span> <span class="na">ref=</span><span class="s">&quot;crm.model_crm_lead&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;groups&quot;</span> <span class="na">eval=</span><span class="s">&quot;[(4, ref(&#39;sales_team.group_sale_manager&#39;))]&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;perm_read&quot;</span> <span class="na">eval=</span><span class="s">&quot;0&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;perm_write&quot;</span> <span class="na">eval=</span><span class="s">&quot;0&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;perm_create&quot;</span> <span class="na">eval=</span><span class="s">&quot;0&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;perm_unlink&quot;</span> <span class="na">eval=</span><span class="s">&quot;1&quot;</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;domain_force&quot;</span><span class="nt">&gt;</span>[(&#39;state&#39;,&#39;=&#39;,&#39;cancel&#39;)]<span class="nt">&lt;/field&gt;</span>
<span class="nt">&lt;/record&gt;</span>
</pre></div>
</div>
<div role="alert" class="alert-exercise alert"><p class="alert-title">Exercise</p><p >Regla de registro</p><p >Agregar una regla de registro para el modelo <em >Course</em> y el grupo &quot;OpenAcademy / Manager&quot;, que restringe el <code >write</code> y  <code >unlink</code> al responsable de un curso. Si un curso no tiene responsable, todos los usuarios del grupo deben ser capaces de modificarlo.</p><p >Crear una nueva regla en <code >openacademy/security/security.xml</code>:</p><div class="pq-patch"><em >openacademy/security/security.xml</em><div class="pq-section"><div class="highlight-xml"><div class="highlight"><pre><span></span>        <span class="nt">&lt;record</span> <span class="na">id=</span><span class="s">&quot;group_manager&quot;</span> <span class="na">model=</span><span class="s">&quot;res.groups&quot;</span><span class="nt">&gt;</span>
            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;name&quot;</span><span class="nt">&gt;</span>OpenAcademy / Manager<span class="nt">&lt;/field&gt;</span>
        <span class="nt">&lt;/record&gt;</span>
<span class="hll">    
</span><span class="hll">        <span class="nt">&lt;record</span> <span class="na">id=</span><span class="s">&quot;only_responsible_can_modify&quot;</span> <span class="na">model=</span><span class="s">&quot;ir.rule&quot;</span><span class="nt">&gt;</span>
</span><span class="hll">            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;name&quot;</span><span class="nt">&gt;</span>Only Responsible can modify Course<span class="nt">&lt;/field&gt;</span>
</span><span class="hll">            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;model_id&quot;</span> <span class="na">ref=</span><span class="s">&quot;model_openacademy_course&quot;</span><span class="nt">/&gt;</span>
</span><span class="hll">            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;groups&quot;</span> <span class="na">eval=</span><span class="s">&quot;[(4, ref(&#39;openacademy.group_manager&#39;))]&quot;</span><span class="nt">/&gt;</span>
</span><span class="hll">            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;perm_read&quot;</span> <span class="na">eval=</span><span class="s">&quot;0&quot;</span><span class="nt">/&gt;</span>
</span><span class="hll">            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;perm_write&quot;</span> <span class="na">eval=</span><span class="s">&quot;1&quot;</span><span class="nt">/&gt;</span>
</span><span class="hll">            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;perm_create&quot;</span> <span class="na">eval=</span><span class="s">&quot;0&quot;</span><span class="nt">/&gt;</span>
</span><span class="hll">            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;perm_unlink&quot;</span> <span class="na">eval=</span><span class="s">&quot;1&quot;</span><span class="nt">/&gt;</span>
</span><span class="hll">            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;domain_force&quot;</span><span class="nt">&gt;</span>
</span><span class="hll">                [&#39;|&#39;, (&#39;responsible_id&#39;,&#39;=&#39;,False),
</span><span class="hll">                      (&#39;responsible_id&#39;,&#39;=&#39;,user.id)]
</span><span class="hll">            <span class="nt">&lt;/field&gt;</span>
</span><span class="hll">        <span class="nt">&lt;/record&gt;</span>
</span>
<span class="nt">&lt;/odoo&gt;</span>
</pre></div>
</div>
</div></div></div></section><section id="wizards"><h2 >Asistentes</h2><p >Asistentes describen sesiones interactivas con el usuario (o cajas de diálogos) a través de formularios dinámicos. Un asistente es simplemente un modelo que extiende la clase <code class="py xref py-class">TransientModel</code> en vez de <a href="../reference/orm.html#odoo.models.Model" class="internal reference" title="odoo.models.Model"><code class="py xref py-class">Model</code></a>. La clase <code class="py xref py-class">TransientModel</code> extiende <a href="../reference/orm.html#odoo.models.Model" class="internal reference" title="odoo.models.Model"><code class="py xref py-class">Model</code></a> y re-usa todos sus mecanismos existentes, con las siguientes particularidades:</p><ul ><li ><p >Los registros de un asistente no pretenden ser persistentes; se borran automáticamente de la base de datos después de cierto tiempo. Por esta razón se llaman <em >transient</em>.</p></li><li ><p >Un asistente no requiere permisos explícitos: los usuarios tienen todos los permisos en cualquier asistente.</p></li><li ><p >Los registros de un asistente pueden referirse a registros normales a través de la definición de campos many2one, pero los registros regulares <em >no</em> se pueden referir a los registros de un asistentes a través de campos many2one.</p></li></ul><p >Queremos crear un asistente que permite a los usuarios crear a <em >attendees</em> para una determinada sesión, o para una lista de sesiones a la vez.</p><div role="alert" class="alert-exercise alert"><p class="alert-title">Exercise</p><p >Define el asistente</p><p >Crear un modelo asistente con una relación many2one al modelo <em >Session</em> y una relación many2many con el modelo <em >Partner</em>.</p><p >Agregue un nuevo archivo <code >openacademy/wizard.py</code>:</p><div class="pq-patch"><em >openacademy/__init__.py</em><div class="pq-section"><div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">controllers</span>
<span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">models</span>
<span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">partner</span>
<span class="hll"><span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">wizard</span>
</span></pre></div>
</div>
</div><em >openacademy/wizard.py</em><div class="pq-section"><div class="highlight-python"><div class="highlight"><pre><span></span><span class="hll"><span class="c1"># -*- coding: utf-8 -*-</span>
</span><span class="hll">
</span><span class="hll"><span class="kn">from</span> <span class="nn">odoo</span> <span class="kn">import</span> <span class="n">models</span><span class="p">,</span> <span class="n">fields</span><span class="p">,</span> <span class="n">api</span>
</span><span class="hll">
</span><span class="hll"><span class="k">class</span> <span class="nc">Wizard</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">TransientModel</span><span class="p">):</span>
</span><span class="hll">    <span class="n">_name</span> <span class="o">=</span> <span class="s1">&#39;openacademy.wizard&#39;</span>
</span><span class="hll">
</span><span class="hll">    <span class="n">session_id</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">Many2one</span><span class="p">(</span><span class="s1">&#39;openacademy.session&#39;</span><span class="p">,</span>
</span><span class="hll">        <span class="n">string</span><span class="o">=</span><span class="s2">&quot;Session&quot;</span><span class="p">,</span> <span class="n">required</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</span><span class="hll">    <span class="n">attendee_ids</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">Many2many</span><span class="p">(</span><span class="s1">&#39;res.partner&#39;</span><span class="p">,</span> <span class="n">string</span><span class="o">=</span><span class="s2">&quot;Attendees&quot;</span><span class="p">)</span>
</span></pre></div>
</div>
</div></div></div></section><section id="launching-wizards"><h3 >Ejecutar un asistente</h3><p >Los asistentes se lanzan usando registros <code >ir.actions.act_window</code> con el campo <code >target</code> en <code >new</code>. Este último abre la vista del asistente en una ventana emergente. La acción puede ser llamada por un elemento de menú.</p><p >Hay otra manera para iniciar el asistente y esta es usando un registro <code >ir.actions.act_window</code> como arriba, pero con un campo extra <code >src_model</code> que especifica en el contexto de cuál modelo la acción está disponible. El asistente aparecerá en la acción contextual del modelo, por encima de la vista principal. Debido a algunos disparadores internos en el ORM, tal acción es declarada en XML con la etiqueta <code >act_window</code>.</p><div class="xml highlight-default code"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">act_window</span> <span class="nb">id</span><span class="o">=</span><span class="s2">&quot;launch_the_wizard&quot;</span>
            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Launch the Wizard&quot;</span>
            <span class="n">src_model</span><span class="o">=</span><span class="s2">&quot;context.model.name&quot;</span>
            <span class="n">res_model</span><span class="o">=</span><span class="s2">&quot;wizard.model.name&quot;</span>
            <span class="n">view_mode</span><span class="o">=</span><span class="s2">&quot;form&quot;</span>
            <span class="n">target</span><span class="o">=</span><span class="s2">&quot;new&quot;</span>
            <span class="n">key2</span><span class="o">=</span><span class="s2">&quot;client_action_multi&quot;</span><span class="o">/&gt;</span>
</pre></div>
</div>
<p >Los asistentes usan vistas regulares y sus botones pueden usar el atributo <code >special=&quot;cancel&quot;</code> para cerrar la ventana del asistente sin guardar los cambios.</p><div role="alert" class="alert-exercise alert"><p class="alert-title">Exercise</p><p >Iniciar al asistente</p><ol ><li ><p >Definir una vista de formulario para el asistente.</p></li><li ><p >Añadir la acción para ejecutar en el contexto del modelo <em >Session</em>.</p></li><li ><p >Definir un valor predeterminado para el campo de sesión en el asistente; Utilice el parámetro de <code >self._context</code> para recuperar la sesión actual.</p></li></ol><div class="pq-patch"><em >openacademy/wizard.py</em><div class="pq-section"><div class="highlight-python"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">Wizard</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">TransientModel</span><span class="p">):</span>
    <span class="n">_name</span> <span class="o">=</span> <span class="s1">&#39;openacademy.wizard&#39;</span>

<span class="hll">    <span class="k">def</span> <span class="nf">_default_session</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span class="hll">        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="p">[</span><span class="s1">&#39;openacademy.session&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">browse</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_context</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;active_id&#39;</span><span class="p">))</span>
</span><span class="hll">
</span>    <span class="n">session_id</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">Many2one</span><span class="p">(</span><span class="s1">&#39;openacademy.session&#39;</span><span class="p">,</span>
<span class="hll">        <span class="n">string</span><span class="o">=</span><span class="s2">&quot;Session&quot;</span><span class="p">,</span> <span class="n">required</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="n">_default_session</span><span class="p">)</span>
</span>    <span class="n">attendee_ids</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">Many2many</span><span class="p">(</span><span class="s1">&#39;res.partner&#39;</span><span class="p">,</span> <span class="n">string</span><span class="o">=</span><span class="s2">&quot;Attendees&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div><em >openacademy/views/openacademy.xml</em><div class="pq-section"><div class="highlight-xml+django"><div class="highlight"><pre><span></span>                  action=&quot;session_list_action&quot;/&gt;

        <span class="nt">&lt;record</span> <span class="na">model=</span><span class="s">&quot;ir.ui.view&quot;</span> <span class="na">id=</span><span class="s">&quot;wizard_form_view&quot;</span><span class="nt">&gt;</span>
<span class="hll">            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;name&quot;</span><span class="nt">&gt;</span>wizard.form<span class="nt">&lt;/field&gt;</span>
</span><span class="hll">            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;model&quot;</span><span class="nt">&gt;</span>openacademy.wizard<span class="nt">&lt;/field&gt;</span>
</span><span class="hll">            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;arch&quot;</span> <span class="na">type=</span><span class="s">&quot;xml&quot;</span><span class="nt">&gt;</span>
</span><span class="hll">                <span class="nt">&lt;form</span> <span class="na">string=</span><span class="s">&quot;Add Attendees&quot;</span><span class="nt">&gt;</span>
</span><span class="hll">                    <span class="nt">&lt;group&gt;</span>
</span><span class="hll">                        <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;session_id&quot;</span><span class="nt">/&gt;</span>
</span><span class="hll">                        <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;attendee_ids&quot;</span><span class="nt">/&gt;</span>
</span><span class="hll">                    <span class="nt">&lt;/group&gt;</span>
</span><span class="hll">                <span class="nt">&lt;/form&gt;</span>
</span><span class="hll">            <span class="nt">&lt;/field&gt;</span>
</span><span class="hll">        <span class="nt">&lt;/record&gt;</span>
</span><span class="hll">
</span><span class="hll">        <span class="nt">&lt;act_window</span> <span class="na">id=</span><span class="s">&quot;launch_session_wizard&quot;</span>
</span><span class="hll">                    <span class="na">name=</span><span class="s">&quot;Add Attendees&quot;</span>
</span><span class="hll">                    <span class="na">src_model=</span><span class="s">&quot;openacademy.session&quot;</span>
</span><span class="hll">                    <span class="na">res_model=</span><span class="s">&quot;openacademy.wizard&quot;</span>
</span><span class="hll">                    <span class="na">view_mode=</span><span class="s">&quot;form&quot;</span>
</span><span class="hll">                    <span class="na">target=</span><span class="s">&quot;new&quot;</span>
</span><span class="hll">                    <span class="na">key2=</span><span class="s">&quot;client_action_multi&quot;</span><span class="nt">/&gt;</span>
</span><span class="hll">
</span><span class="hll"><span class="nt">&lt;/odoo&gt;</span>
</span></pre></div>
</div>
</div></div></div><div role="alert" class="alert-exercise alert"><p class="alert-title">Exercise</p><p >Registro de asistentes</p><p >Añadir botones al asistente e implementar el método correspondiente para agregar a los asistentes a la sesión dada.</p><div class="pq-patch"><em >openacademy/views/openacademy.xml</em><div class="pq-section"><div class="highlight-xml+django"><div class="highlight"><pre><span></span>                    <span class="nt">&lt;/group&gt;</span>
                    <span class="nt">&lt;footer&gt;</span>
                        <span class="nt">&lt;button</span> <span class="na">name=</span><span class="s">&quot;subscribe&quot;</span> <span class="na">type=</span><span class="s">&quot;object&quot;</span>
<span class="hll">                                <span class="na">string=</span><span class="s">&quot;Subscribe&quot;</span> <span class="na">class=</span><span class="s">&quot;oe_highlight&quot;</span><span class="nt">/&gt;</span>
</span><span class="hll">                        or
</span><span class="hll">                        <span class="nt">&lt;button</span> <span class="na">special=</span><span class="s">&quot;cancel&quot;</span> <span class="na">string=</span><span class="s">&quot;Cancel&quot;</span><span class="nt">/&gt;</span>
</span><span class="hll">                    <span class="nt">&lt;/footer&gt;</span>
</span><span class="hll">                <span class="nt">&lt;/form&gt;</span>
</span><span class="hll">            <span class="nt">&lt;/field&gt;</span>
</span>        <span class="nt">&lt;/record&gt;</span>

        <span class="nt">&lt;act_window</span> <span class="na">id=</span><span class="s">&quot;launch_session_wizard&quot;</span>
</pre></div>
</div>
</div><em >openacademy/wizard.py</em><div class="pq-section"><div class="highlight-python"><div class="highlight"><pre><span></span>    <span class="n">session_id</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">Many2one</span><span class="p">(</span><span class="s1">&#39;openacademy.session&#39;</span><span class="p">,</span>
        <span class="n">string</span><span class="o">=</span><span class="s2">&quot;Session&quot;</span><span class="p">,</span> <span class="n">required</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="n">_default_session</span><span class="p">)</span>
    <span class="n">attendee_ids</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">Many2many</span><span class="p">(</span><span class="s1">&#39;res.partner&#39;</span><span class="p">,</span> <span class="n">string</span><span class="o">=</span><span class="s2">&quot;Attendees&quot;</span><span class="p">)</span>
<span class="hll">
</span><span class="hll">    <span class="nd">@api.multi</span>
</span><span class="hll">    <span class="k">def</span> <span class="nf">subscribe</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span class="hll">        <span class="bp">self</span><span class="o">.</span><span class="n">session_id</span><span class="o">.</span><span class="n">attendee_ids</span> <span class="o">|=</span> <span class="bp">self</span><span class="o">.</span><span class="n">attendee_ids</span>
</span><span class="hll">        <span class="k">return</span> <span class="p">{}</span>
</span></pre></div>
</div>
</div></div></div><div role="alert" class="alert-exercise alert"><p class="alert-title">Exercise</p><p >Registro de asistentes a las sesiones múltiples</p><p >Modificar el modelo de asistente (wizard) para que los asistentes puedan registrarse para varias sesiones.</p><div class="pq-patch"><em >openacademy/views/openacademy.xml</em><div class="pq-section"><div class="highlight-xml+django"><div class="highlight"><pre><span></span>                    <span class="nt">&lt;group&gt;</span>
                        <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;session_ids&quot;</span><span class="nt">/&gt;</span>
                        <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;attendee_ids&quot;</span><span class="nt">/&gt;</span>
<span class="hll">                    <span class="nt">&lt;/group&gt;</span>
</span>                    <span class="nt">&lt;footer&gt;</span>
                        <span class="nt">&lt;button</span> <span class="na">name=</span><span class="s">&quot;subscribe&quot;</span> <span class="na">type=</span><span class="s">&quot;object&quot;</span>
                                <span class="na">string=</span><span class="s">&quot;Subscribe&quot;</span> <span class="na">class=</span><span class="s">&quot;oe_highlight&quot;</span><span class="nt">/&gt;</span>
</pre></div>
</div>
</div><em >openacademy/wizard.py</em><div class="pq-section"><div class="highlight-python"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">Wizard</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">TransientModel</span><span class="p">):</span>
    <span class="n">_name</span> <span class="o">=</span> <span class="s1">&#39;openacademy.wizard&#39;</span>

<span class="hll">    <span class="k">def</span> <span class="nf">_default_sessions</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span class="hll">        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="p">[</span><span class="s1">&#39;openacademy.session&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">browse</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_context</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;active_ids&#39;</span><span class="p">))</span>
</span>
<span class="hll">    <span class="n">session_ids</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">Many2many</span><span class="p">(</span><span class="s1">&#39;openacademy.session&#39;</span><span class="p">,</span>
</span><span class="hll">        <span class="n">string</span><span class="o">=</span><span class="s2">&quot;Sessions&quot;</span><span class="p">,</span> <span class="n">required</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="n">_default_sessions</span><span class="p">)</span>
</span>    <span class="n">attendee_ids</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">Many2many</span><span class="p">(</span><span class="s1">&#39;res.partner&#39;</span><span class="p">,</span> <span class="n">string</span><span class="o">=</span><span class="s2">&quot;Attendees&quot;</span><span class="p">)</span>

    <span class="nd">@api.multi</span>
    <span class="k">def</span> <span class="nf">subscribe</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="hll">        <span class="k">for</span> <span class="n">session</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">session_ids</span><span class="p">:</span>
</span><span class="hll">            <span class="n">session</span><span class="o">.</span><span class="n">attendee_ids</span> <span class="o">|=</span> <span class="bp">self</span><span class="o">.</span><span class="n">attendee_ids</span>
</span>        <span class="k">return</span> <span class="p">{}</span>
</pre></div>
</div>
</div></div></div></section><section id="internationalization"><h2 >Internacionalización</h2><p >Cada módulo puede tener sus propias traducciones dentro del directorio i18n, con solo tener archivos llamados LANG.po donde LANG es el código local del idioma, o el código del idioma y el país combinados cuando son diferentes (por ejemplo pt.po o pt_BR.po). Las traducciones serán cargadas automáticamente por Odoo para todos los idiomas habilitados. Los desarrolladores deberían utilizar inglés cuando crean un módulo, una vez listo exportan los términos de ese módulo usando la característica de exportar archivos POT la cual usa <code >gettext</code> para tal fin (<span class="menuselection">Settings ‣ Translations ‣ Import/Export ‣ Export Translation</span> sin especificar un lenguaje) para crear el archivo plantilla POT del modulo, y entonces usarlo para crear las traducciones derivadas las cuales serían archivos PO. Varios IDEs tienen plugins o modos de edición y merge de archivos PO/POT, por ejemplo <code >poEdit</code>.</p><div role="alert" class="alert-info alert"><p class="alert-title">Truco</p><p >Los archivos del Objeto Potable generados por Odoo son publicados en <a href="https://www.transifex.com/odoo/public/" class="external reference alert-link">Transifex</a>, haciendo fácil para traducir el programa.</p></div><div class="highlight-text"><div class="highlight"><pre><span></span>|- idea/ # The module directory
   |- i18n/ # Translation files
      | - idea.pot # Translation Template (exported from Odoo)
      | - fr.po # French translation
      | - pt_BR.po # Brazilian Portuguese translation
      | (...)
</pre></div>
</div>
<div role="alert" class="alert-info alert"><p class="alert-title">Truco</p><p >Por defecto la exportación de los POT en Odoo sólo extrae etiquetas dentro de archivos XML o dentro de las definiciones de campo en código Python, pero cualquier cadena Python puede ser traducido de esta manera envolviéndola con la función <code class="py xref py-func">odoo._()</code> (e.g. <code >_(&quot;Label&quot;)</code>)</p></div><div role="alert" class="alert-exercise alert"><p class="alert-title">Exercise</p><p >Traduce un Módulo</p><p >Elegir un segundo idioma para la instalación de Odoo. Traducir su módulo utilizando los servicios proporcionados por Odoo.</p><ol ><li ><p >Crear un directorio <code >openacademy/i18n/</code></p></li><li ><p >Instalar cualquier idioma que desee ( <span class="menuselection">Administration ‣ Translations ‣ Load an Official Translation</span>)</p></li><li ><p >Sincronizar términos traducibles  (<span class="menuselection">Administration ‣ Translations ‣ Application Terms ‣ Synchronize Translations</span>)</p></li><li ><p >Crear un archivo de plantilla de traducción por exportación ( <span class="menuselection">Administration ‣ Translations -&gt; Import/Export ‣ Export Translation</span>) sin especificar un idioma, guardar en <code >openacademy/i18n/</code></p></li><li ><p >Crear un archivo de traducción mediante la exportación ( <span class="menuselection">Administration ‣ Translations ‣ Import/Export ‣ Export Translation</span>) especificaca un idioma. Guardarlo en <code >openacademy/i18n/</code></p></li><li ><p >Abra el archivo exportado de la traducción (con un editor de texto básico o un editor de fichero PO dedicado por ejemplo <a href="http://poedit.net" class="external reference alert-link">POEdit</a>) y traduce los términos que faltan</p></li><li ><p >En <code >models.py</code>, agregue una instrucción import para la función <code >odoo._</code> y marca que faltan cadenas como traducible</p></li><li ><p >Repita los pasos 3-6</p></li></ol><div class="pq-patch"><em >openacademy/models.py</em><div class="pq-section"><div class="highlight-python"><div class="highlight"><pre><span></span><span class="c1"># -*- coding: utf-8 -*-</span>

<span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">timedelta</span>
<span class="hll"><span class="kn">from</span> <span class="nn">odoo</span> <span class="kn">import</span> <span class="n">models</span><span class="p">,</span> <span class="n">fields</span><span class="p">,</span> <span class="n">api</span><span class="p">,</span> <span class="n">exceptions</span><span class="p">,</span> <span class="n">_</span>
</span>
<span class="k">class</span> <span class="nc">Course</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
    <span class="n">_name</span> <span class="o">=</span> <span class="s1">&#39;openacademy.course&#39;</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span></span>        <span class="n">default</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">default</span> <span class="ow">or</span> <span class="p">{})</span>

        <span class="n">copied_count</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">search_count</span><span class="p">(</span>
<span class="hll">            <span class="p">[(</span><span class="s1">&#39;name&#39;</span><span class="p">,</span> <span class="s1">&#39;=like&#39;</span><span class="p">,</span> <span class="n">_</span><span class="p">(</span><span class="sa">u</span><span class="s2">&quot;Copy of {}%&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">))])</span>
</span>        <span class="k">if</span> <span class="ow">not</span> <span class="n">copied_count</span><span class="p">:</span>
<span class="hll">            <span class="n">new_name</span> <span class="o">=</span> <span class="n">_</span><span class="p">(</span><span class="sa">u</span><span class="s2">&quot;Copy of {}&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
</span>        <span class="k">else</span><span class="p">:</span>
<span class="hll">            <span class="n">new_name</span> <span class="o">=</span> <span class="n">_</span><span class="p">(</span><span class="sa">u</span><span class="s2">&quot;Copy of {} ({})&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">copied_count</span><span class="p">)</span>
</span>
        <span class="n">default</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">new_name</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">(</span><span class="n">Course</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">default</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span></span>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">seats</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">{</span>
                <span class="s1">&#39;warning&#39;</span><span class="p">:</span> <span class="p">{</span>
<span class="hll">                    <span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="n">_</span><span class="p">(</span><span class="s2">&quot;Incorrect &#39;seats&#39; value&quot;</span><span class="p">),</span>
</span><span class="hll">                    <span class="s1">&#39;message&#39;</span><span class="p">:</span> <span class="n">_</span><span class="p">(</span><span class="s2">&quot;The number of available seats may not be negative&quot;</span><span class="p">),</span>
</span>                <span class="p">},</span>
            <span class="p">}</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">seats</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">attendee_ids</span><span class="p">):</span>
            <span class="k">return</span> <span class="p">{</span>
                <span class="s1">&#39;warning&#39;</span><span class="p">:</span> <span class="p">{</span>
<span class="hll">                    <span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="n">_</span><span class="p">(</span><span class="s2">&quot;Too many attendees&quot;</span><span class="p">),</span>
</span><span class="hll">                    <span class="s1">&#39;message&#39;</span><span class="p">:</span> <span class="n">_</span><span class="p">(</span><span class="s2">&quot;Increase seats or remove excess attendees&quot;</span><span class="p">),</span>
</span>                <span class="p">},</span>
            <span class="p">}</span>

</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span></span>    <span class="k">def</span> <span class="nf">_check_instructor_not_in_attendees</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">r</span><span class="o">.</span><span class="n">instructor_id</span> <span class="ow">and</span> <span class="n">r</span><span class="o">.</span><span class="n">instructor_id</span> <span class="ow">in</span> <span class="n">r</span><span class="o">.</span><span class="n">attendee_ids</span><span class="p">:</span>
<span class="hll">                <span class="k">raise</span> <span class="n">exceptions</span><span class="o">.</span><span class="n">ValidationError</span><span class="p">(</span><span class="n">_</span><span class="p">(</span><span class="s2">&quot;A session&#39;s instructor can&#39;t be an attendee&quot;</span><span class="p">))</span>
</span></pre></div>
</div>
</div></div></div></section><section id="reporting"><h2 >Informes</h2></section><section id="printed-reports"><h3 >Informes impresos</h3><p >A partir de Odoo 8.0 éste viene con un nuevo motor de informe basado en <a href="../reference/qweb.html#reference-qweb" class="internal reference"><span class="std std-ref">QWeb</span></a>, <a href="http://getbootstrap.com" class="external reference">Twitter Bootstrap</a> and <a href="http://wkhtmltopdf.org" class="external reference">Wkhtmltopdf</a>.</p><p >Un informe es un elemento de la combinación de dos elementos:</p><ul ><li ><p >an <code >ir.actions.report</code>, for which a <code >&lt;report&gt;</code> shortcut element is
provided, it sets up various basic parameters for the report (default
type, whether the report should be saved to the database after generation,…)</p><div class="highlight-xml"><div class="highlight"><pre><span></span><span class="nt">&lt;report</span>
    <span class="na">id=</span><span class="s">&quot;account_invoices&quot;</span>
    <span class="na">model=</span><span class="s">&quot;account.invoice&quot;</span>
    <span class="na">string=</span><span class="s">&quot;Invoices&quot;</span>
    <span class="na">report_type=</span><span class="s">&quot;qweb-pdf&quot;</span>
    <span class="na">name=</span><span class="s">&quot;account.report_invoice&quot;</span>
    <span class="na">file=</span><span class="s">&quot;account.report_invoice&quot;</span>
    <span class="na">attachment_use=</span><span class="s">&quot;True&quot;</span>
    <span class="na">attachment=</span><span class="s">&quot;(object.state in (&#39;open&#39;,&#39;paid&#39;)) and</span>
<span class="s">        (&#39;INV&#39;+(object.number or &#39;&#39;).replace(&#39;/&#39;,&#39;&#39;)+&#39;.pdf&#39;)&quot;</span>
<span class="nt">/&gt;</span>
</pre></div>
</div>
</li><li ><p >Un estándar <a href="../reference/views.html#reference-views-qweb" class="internal reference"><span class="std std-ref">QWeb view</span></a> para el informe real:</p><div class="highlight-xml"><div class="highlight"><pre><span></span><span class="nt">&lt;t</span> <span class="na">t-call=</span><span class="s">&quot;report.html_container&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;t</span> <span class="na">t-foreach=</span><span class="s">&quot;docs&quot;</span> <span class="na">t-as=</span><span class="s">&quot;o&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;t</span> <span class="na">t-call=</span><span class="s">&quot;report.external_layout&quot;</span><span class="nt">&gt;</span>
            <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">&quot;page&quot;</span><span class="nt">&gt;</span>
                <span class="nt">&lt;h2&gt;</span>Report title<span class="nt">&lt;/h2&gt;</span>
            <span class="nt">&lt;/div&gt;</span>
        <span class="nt">&lt;/t&gt;</span>
    <span class="nt">&lt;/t&gt;</span>
<span class="nt">&lt;/t&gt;</span>

the standard rendering context provides a number of elements, the most
important being:

``docs``
    the records for which the report is printed
``user``
    the user printing the report
</pre></div>
</div>
</li></ul><p >Debido a que los informes son páginas web estándar, están disponibles a través de una URL y los parámetros de salida pueden ser manipulados a través de esta URL, por ejemplo la versión HTML de la <em >factura</em> está disponible a través de <a href="http://localhost:8069/report/html/account.report_invoice/1" class="external reference">http://localhost:8069/report/html/account.report_invoice/1</a> (si está instalado ‘’account’’) y la versión en PDF a través de <a href="http://localhost:8069/report/pdf/account.report_invoice/1" class="external reference">http://localhost:8069/report/pdf/account.report_invoice/1</a>.</p><div role="alert" class="alert-danger alert" id="reference-backend-reporting-printed-reports-pdf-without-styles"><p class="alert-title">Peligro</p><p >Si parece que su informe PDF le faltan los estilos (es decir, aparece el texto pero el estilo/diseño es diferente de la versión html), probablemente su proceso <a href="http://wkhtmltopdf.org" class="external reference alert-link">wkhtmltopdf</a> no puede encontrar el servidor web para convertir y descargar los estilos.</p><p >Si usted revisa los logs de su servidor y ve que los estilos CSS <em >no</em> están siendo descargados al generar un informe PDF, seguramente ese es el problema.</p><p >El proceso de <a href="http://wkhtmltopdf.org" class="external reference alert-link">wkhtmltopdf</a> utiliza el parámetro de sistema de <code >web.base.url</code> como la <em >root path</em> a archivos todos los <code >links</code>, pero este parámetro se actualiza automáticamente cada vez que el administrador ha iniciado sesión en. Si su servidor se encuentra detrás de algún tipo de proxy, no podía llegar. Puede solucionar esto mediante la adición de uno de estos parámetros del sistema:</p><ul ><li ><p ><code >report.url</code>, apuntando a una URL accesible desde el servidor (probablemente ‘’ <a href="http://localhost:8069" class="external reference alert-link">http://localhost:8069</a>'' o algo parecido). Se utilizará para este propósito particular solamente.</p></li><li ><p ><code >web.base.url.freeze</code>, cuando se establece en <code >True</code>, dejará las actualizaciones automáticas de <code >web.base.url</code>.</p></li></ul></div><div role="alert" class="alert-exercise alert"><p class="alert-title">Exercise</p><p >Crear un informe para el modelo de sesión</p><p >Para cada sesión, debe mostrar el nombre de sesión, su inicio y final y una lista de los asistentes de la sesión.</p><div class="pq-patch"><em >openacademy/__manifest__.py</em><div class="pq-section"><div class="highlight-python"><div class="highlight"><pre><span></span>    <span class="s1">&#39;version&#39;</span><span class="p">:</span> <span class="s1">&#39;0.1&#39;</span><span class="p">,</span>

    <span class="c1"># any module necessary for this one to work correctly</span>
<span class="hll">    <span class="s1">&#39;depends&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;base&#39;</span><span class="p">,</span> <span class="s1">&#39;report&#39;</span><span class="p">],</span>
</span>
    <span class="c1"># always loaded</span>
    <span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="p">[</span>
</pre></div>
</div>
</div><em >openacademy/__manifest__.py</em><div class="pq-section"><div class="highlight-python"><div class="highlight"><pre><span></span>        <span class="s1">&#39;templates.xml&#39;</span><span class="p">,</span>
        <span class="s1">&#39;views/openacademy.xml&#39;</span><span class="p">,</span>
        <span class="s1">&#39;views/partner.xml&#39;</span><span class="p">,</span>
<span class="hll">        <span class="s1">&#39;reports.xml&#39;</span><span class="p">,</span>
</span>    <span class="p">],</span>
    <span class="c1"># only loaded in demonstration mode</span>
    <span class="s1">&#39;demo&#39;</span><span class="p">:</span> <span class="p">[</span>
</pre></div>
</div>
</div><em >openacademy/reports.xml</em><div class="pq-section"><div class="highlight-xml"><div class="highlight"><pre><span></span><span class="hll"><span class="nt">&lt;odoo&gt;</span>
</span><span class="hll">
</span><span class="hll">    <span class="nt">&lt;report</span>
</span><span class="hll">        <span class="na">id=</span><span class="s">&quot;report_session&quot;</span>
</span><span class="hll">        <span class="na">model=</span><span class="s">&quot;openacademy.session&quot;</span>
</span><span class="hll">        <span class="na">string=</span><span class="s">&quot;Session Report&quot;</span>
</span><span class="hll">        <span class="na">name=</span><span class="s">&quot;openacademy.report_session_view&quot;</span>
</span><span class="hll">        <span class="na">file=</span><span class="s">&quot;openacademy.report_session&quot;</span>
</span><span class="hll">        <span class="na">report_type=</span><span class="s">&quot;qweb-pdf&quot;</span> <span class="nt">/&gt;</span>
</span><span class="hll">
</span><span class="hll">    <span class="nt">&lt;template</span> <span class="na">id=</span><span class="s">&quot;report_session_view&quot;</span><span class="nt">&gt;</span>
</span><span class="hll">        <span class="nt">&lt;t</span> <span class="na">t-call=</span><span class="s">&quot;report.html_container&quot;</span><span class="nt">&gt;</span>
</span><span class="hll">            <span class="nt">&lt;t</span> <span class="na">t-foreach=</span><span class="s">&quot;docs&quot;</span> <span class="na">t-as=</span><span class="s">&quot;doc&quot;</span><span class="nt">&gt;</span>
</span><span class="hll">                <span class="nt">&lt;t</span> <span class="na">t-call=</span><span class="s">&quot;report.external_layout&quot;</span><span class="nt">&gt;</span>
</span><span class="hll">                    <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">&quot;page&quot;</span><span class="nt">&gt;</span>
</span><span class="hll">                        <span class="nt">&lt;h2</span> <span class="na">t-field=</span><span class="s">&quot;doc.name&quot;</span><span class="nt">/&gt;</span>
</span><span class="hll">                        <span class="nt">&lt;p&gt;</span>From <span class="nt">&lt;span</span> <span class="na">t-field=</span><span class="s">&quot;doc.start_date&quot;</span><span class="nt">/&gt;</span> to <span class="nt">&lt;span</span> <span class="na">t-field=</span><span class="s">&quot;doc.end_date&quot;</span><span class="nt">/&gt;&lt;/p&gt;</span>
</span><span class="hll">                        <span class="nt">&lt;h3&gt;</span>Attendees:<span class="nt">&lt;/h3&gt;</span>
</span><span class="hll">                        <span class="nt">&lt;ul&gt;</span>
</span><span class="hll">                            <span class="nt">&lt;t</span> <span class="na">t-foreach=</span><span class="s">&quot;doc.attendee_ids&quot;</span> <span class="na">t-as=</span><span class="s">&quot;attendee&quot;</span><span class="nt">&gt;</span>
</span><span class="hll">                                <span class="nt">&lt;li&gt;&lt;span</span> <span class="na">t-field=</span><span class="s">&quot;attendee.name&quot;</span><span class="nt">/&gt;&lt;/li&gt;</span>
</span><span class="hll">                            <span class="nt">&lt;/t&gt;</span>
</span><span class="hll">                        <span class="nt">&lt;/ul&gt;</span>
</span><span class="hll">                    <span class="nt">&lt;/div&gt;</span>
</span><span class="hll">                <span class="nt">&lt;/t&gt;</span>
</span><span class="hll">            <span class="nt">&lt;/t&gt;</span>
</span><span class="hll">        <span class="nt">&lt;/t&gt;</span>
</span><span class="hll">    <span class="nt">&lt;/template&gt;</span>
</span><span class="hll">
</span><span class="hll"><span class="nt">&lt;/odoo&gt;</span>
</span></pre></div>
</div>
</div></div></div></section><section id="dashboards"><h3 >Paneles de control</h3><div role="alert" class="alert-exercise alert"><p class="alert-title">Exercise</p><p >Definir un panel de control</p><p >Definir un tablero que contiene la vista gráfico que creó, la vista de calendario de sesiones y una vista de lista de los cursos (conmutables a una vista de formulario). Este panel debe estar disponible a través de un menuitem en el menú y aparecerá automáticamente en el cliente web cuando se selecciona el menú principal de OpenAcademy.</p><ol ><li ><p >Crear un archivo ‘’ openacademy/views/session_board.xml’’. Que debe contener la opinión de la Junta, las acciones se hace referencia en dicha vista, una acción para abrir la consola y una nueva definición de la opción del menú principal para agregar la acción del tablero de instrumentos</p><div role="alert" class="alert-info alert"><p class="alert-title">Nota</p><p >Disponemos los estilos son <code >1</code>, <code >1-1</code>, <code >1-2</code>, <code >2-1</code> and <code >1-1-1</code></p></div></li><li ><p >Actualizar <code >openacademy/__manifest__.py</code> para hacer referencia al nuevo archivo de datos</p></li></ol><div class="pq-patch"><em >openacademy/__manifest__.py</em><div class="pq-section"><div class="highlight-python"><div class="highlight"><pre><span></span>    <span class="s1">&#39;version&#39;</span><span class="p">:</span> <span class="s1">&#39;0.1&#39;</span><span class="p">,</span>

    <span class="c1"># any module necessary for this one to work correctly</span>
<span class="hll">    <span class="s1">&#39;depends&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;base&#39;</span><span class="p">,</span> <span class="s1">&#39;report&#39;</span><span class="p">,</span> <span class="s1">&#39;board&#39;</span><span class="p">],</span>
</span>
    <span class="c1"># always loaded</span>
    <span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="p">[</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span></span>        <span class="s1">&#39;templates.xml&#39;</span><span class="p">,</span>
        <span class="s1">&#39;views/openacademy.xml&#39;</span><span class="p">,</span>
        <span class="s1">&#39;views/partner.xml&#39;</span><span class="p">,</span>
<span class="hll">        <span class="s1">&#39;views/session_board.xml&#39;</span><span class="p">,</span>
</span>        <span class="s1">&#39;reports.xml&#39;</span><span class="p">,</span>
    <span class="p">],</span>
    <span class="c1"># only loaded in demonstration mode</span>
</pre></div>
</div>
</div><em >openacademy/views/session_board.xml</em><div class="pq-section"><div class="highlight-xml"><div class="highlight"><pre><span></span><span class="hll"><span class="cp">&lt;?xml version=&quot;1.0&quot;?&gt;</span>
</span><span class="hll"><span class="nt">&lt;odoo&gt;</span>
</span><span class="hll">
</span><span class="hll">        <span class="nt">&lt;record</span> <span class="na">model=</span><span class="s">&quot;ir.actions.act_window&quot;</span> <span class="na">id=</span><span class="s">&quot;act_session_graph&quot;</span><span class="nt">&gt;</span>
</span><span class="hll">            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;name&quot;</span><span class="nt">&gt;</span>Attendees by course<span class="nt">&lt;/field&gt;</span>
</span><span class="hll">            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;res_model&quot;</span><span class="nt">&gt;</span>openacademy.session<span class="nt">&lt;/field&gt;</span>
</span><span class="hll">            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;view_type&quot;</span><span class="nt">&gt;</span>form<span class="nt">&lt;/field&gt;</span>
</span><span class="hll">            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;view_mode&quot;</span><span class="nt">&gt;</span>graph<span class="nt">&lt;/field&gt;</span>
</span><span class="hll">            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;view_id&quot;</span>
</span><span class="hll">                   <span class="na">ref=</span><span class="s">&quot;openacademy.openacademy_session_graph_view&quot;</span><span class="nt">/&gt;</span>
</span><span class="hll">        <span class="nt">&lt;/record&gt;</span>
</span><span class="hll">        <span class="nt">&lt;record</span> <span class="na">model=</span><span class="s">&quot;ir.actions.act_window&quot;</span> <span class="na">id=</span><span class="s">&quot;act_session_calendar&quot;</span><span class="nt">&gt;</span>
</span><span class="hll">            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;name&quot;</span><span class="nt">&gt;</span>Sessions<span class="nt">&lt;/field&gt;</span>
</span><span class="hll">            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;res_model&quot;</span><span class="nt">&gt;</span>openacademy.session<span class="nt">&lt;/field&gt;</span>
</span><span class="hll">            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;view_type&quot;</span><span class="nt">&gt;</span>form<span class="nt">&lt;/field&gt;</span>
</span><span class="hll">            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;view_mode&quot;</span><span class="nt">&gt;</span>calendar<span class="nt">&lt;/field&gt;</span>
</span><span class="hll">            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;view_id&quot;</span> <span class="na">ref=</span><span class="s">&quot;openacademy.session_calendar_view&quot;</span><span class="nt">/&gt;</span>
</span><span class="hll">        <span class="nt">&lt;/record&gt;</span>
</span><span class="hll">        <span class="nt">&lt;record</span> <span class="na">model=</span><span class="s">&quot;ir.actions.act_window&quot;</span> <span class="na">id=</span><span class="s">&quot;act_course_list&quot;</span><span class="nt">&gt;</span>
</span><span class="hll">            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;name&quot;</span><span class="nt">&gt;</span>Courses<span class="nt">&lt;/field&gt;</span>
</span><span class="hll">            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;res_model&quot;</span><span class="nt">&gt;</span>openacademy.course<span class="nt">&lt;/field&gt;</span>
</span><span class="hll">            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;view_type&quot;</span><span class="nt">&gt;</span>form<span class="nt">&lt;/field&gt;</span>
</span><span class="hll">            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;view_mode&quot;</span><span class="nt">&gt;</span>tree,form<span class="nt">&lt;/field&gt;</span>
</span><span class="hll">        <span class="nt">&lt;/record&gt;</span>
</span><span class="hll">        <span class="nt">&lt;record</span> <span class="na">model=</span><span class="s">&quot;ir.ui.view&quot;</span> <span class="na">id=</span><span class="s">&quot;board_session_form&quot;</span><span class="nt">&gt;</span>
</span><span class="hll">            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;name&quot;</span><span class="nt">&gt;</span>Session Dashboard Form<span class="nt">&lt;/field&gt;</span>
</span><span class="hll">            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;model&quot;</span><span class="nt">&gt;</span>board.board<span class="nt">&lt;/field&gt;</span>
</span><span class="hll">            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;type&quot;</span><span class="nt">&gt;</span>form<span class="nt">&lt;/field&gt;</span>
</span><span class="hll">            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;arch&quot;</span> <span class="na">type=</span><span class="s">&quot;xml&quot;</span><span class="nt">&gt;</span>
</span><span class="hll">                <span class="nt">&lt;form</span> <span class="na">string=</span><span class="s">&quot;Session Dashboard&quot;</span><span class="nt">&gt;</span>
</span><span class="hll">                    <span class="nt">&lt;board</span> <span class="na">style=</span><span class="s">&quot;2-1&quot;</span><span class="nt">&gt;</span>
</span><span class="hll">                        <span class="nt">&lt;column&gt;</span>
</span><span class="hll">                            <span class="nt">&lt;action</span>
</span><span class="hll">                                <span class="na">string=</span><span class="s">&quot;Attendees by course&quot;</span>
</span><span class="hll">                                <span class="na">name=</span><span class="s">&quot;%(act_session_graph)d&quot;</span>
</span><span class="hll">                                <span class="na">height=</span><span class="s">&quot;150&quot;</span>
</span><span class="hll">                                <span class="na">width=</span><span class="s">&quot;510&quot;</span><span class="nt">/&gt;</span>
</span><span class="hll">                            <span class="nt">&lt;action</span>
</span><span class="hll">                                <span class="na">string=</span><span class="s">&quot;Sessions&quot;</span>
</span><span class="hll">                                <span class="na">name=</span><span class="s">&quot;%(act_session_calendar)d&quot;</span><span class="nt">/&gt;</span>
</span><span class="hll">                        <span class="nt">&lt;/column&gt;</span>
</span><span class="hll">                        <span class="nt">&lt;column&gt;</span>
</span><span class="hll">                            <span class="nt">&lt;action</span>
</span><span class="hll">                                <span class="na">string=</span><span class="s">&quot;Courses&quot;</span>
</span><span class="hll">                                <span class="na">name=</span><span class="s">&quot;%(act_course_list)d&quot;</span><span class="nt">/&gt;</span>
</span><span class="hll">                        <span class="nt">&lt;/column&gt;</span>
</span><span class="hll">                    <span class="nt">&lt;/board&gt;</span>
</span><span class="hll">                <span class="nt">&lt;/form&gt;</span>
</span><span class="hll">            <span class="nt">&lt;/field&gt;</span>
</span><span class="hll">        <span class="nt">&lt;/record&gt;</span>
</span><span class="hll">        <span class="nt">&lt;record</span> <span class="na">model=</span><span class="s">&quot;ir.actions.act_window&quot;</span> <span class="na">id=</span><span class="s">&quot;open_board_session&quot;</span><span class="nt">&gt;</span>
</span><span class="hll">          <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;name&quot;</span><span class="nt">&gt;</span>Session Dashboard<span class="nt">&lt;/field&gt;</span>
</span><span class="hll">          <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;res_model&quot;</span><span class="nt">&gt;</span>board.board<span class="nt">&lt;/field&gt;</span>
</span><span class="hll">          <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;view_type&quot;</span><span class="nt">&gt;</span>form<span class="nt">&lt;/field&gt;</span>
</span><span class="hll">          <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;view_mode&quot;</span><span class="nt">&gt;</span>form<span class="nt">&lt;/field&gt;</span>
</span><span class="hll">          <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;usage&quot;</span><span class="nt">&gt;</span>menu<span class="nt">&lt;/field&gt;</span>
</span><span class="hll">          <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;view_id&quot;</span> <span class="na">ref=</span><span class="s">&quot;board_session_form&quot;</span><span class="nt">/&gt;</span>
</span><span class="hll">        <span class="nt">&lt;/record&gt;</span>
</span><span class="hll">
</span><span class="hll">        <span class="nt">&lt;menuitem</span>
</span><span class="hll">            <span class="na">name=</span><span class="s">&quot;Session Dashboard&quot;</span> <span class="na">parent=</span><span class="s">&quot;base.menu_reporting_dashboard&quot;</span>
</span><span class="hll">            <span class="na">action=</span><span class="s">&quot;open_board_session&quot;</span>
</span><span class="hll">            <span class="na">sequence=</span><span class="s">&quot;1&quot;</span>
</span><span class="hll">            <span class="na">id=</span><span class="s">&quot;menu_board_session&quot;</span> <span class="na">icon=</span><span class="s">&quot;terp-graph&quot;</span><span class="nt">/&gt;</span>
</span><span class="hll">
</span><span class="hll"><span class="nt">&lt;/odoo&gt;</span>
</span></pre></div>
</div>
</div></div></div></section><section id="webservices"><h2 >WebServices</h2><p >El módulo de servicios web ofrece una interfaz común para todos los servicios-web:</p><ul ><li >XML-RPC</li><li >JSON-RPC</li></ul><p >Objetos de negocio también se pueden acceder mediante el mecanismo de objetos distribuidos. Ellos pueden ser modificables mediante la interfaz de cliente con vistas contextuales.</p><p >Odoo es accesible a través de interfaces XML-RPC/JSON-RPC, hay bibliotecas en muchos lenguajes.</p></section><section id="xml-rpc-library"><h3 >Librería XML-RPC</h3><p >En el siguiente ejemplo es un programa Python que interactúa con un servidor de Odoo con la biblioteca <code >xmlrpclib</code>:</p><div class="highlight-default"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">xmlrpclib</span>

<span class="n">root</span> <span class="o">=</span> <span class="s1">&#39;http://</span><span class="si">%s</span><span class="s1">:</span><span class="si">%d</span><span class="s1">/xmlrpc/&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">HOST</span><span class="p">,</span> <span class="n">PORT</span><span class="p">)</span>

<span class="n">uid</span> <span class="o">=</span> <span class="n">xmlrpclib</span><span class="o">.</span><span class="n">ServerProxy</span><span class="p">(</span><span class="n">root</span> <span class="o">+</span> <span class="s1">&#39;common&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">login</span><span class="p">(</span><span class="n">DB</span><span class="p">,</span> <span class="n">USER</span><span class="p">,</span> <span class="n">PASS</span><span class="p">)</span>
<span class="nb">print</span> <span class="s2">&quot;Logged in as </span><span class="si">%s</span><span class="s2"> (uid: </span><span class="si">%d</span><span class="s2">)&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">USER</span><span class="p">,</span> <span class="n">uid</span><span class="p">)</span>

<span class="c1"># Create a new note</span>
<span class="n">sock</span> <span class="o">=</span> <span class="n">xmlrpclib</span><span class="o">.</span><span class="n">ServerProxy</span><span class="p">(</span><span class="n">root</span> <span class="o">+</span> <span class="s1">&#39;object&#39;</span><span class="p">)</span>
<span class="n">args</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;color&#39;</span> <span class="p">:</span> <span class="mi">8</span><span class="p">,</span>
    <span class="s1">&#39;memo&#39;</span> <span class="p">:</span> <span class="s1">&#39;This is a note&#39;</span><span class="p">,</span>
    <span class="s1">&#39;create_uid&#39;</span><span class="p">:</span> <span class="n">uid</span><span class="p">,</span>
<span class="p">}</span>
<span class="n">note_id</span> <span class="o">=</span> <span class="n">sock</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">DB</span><span class="p">,</span> <span class="n">uid</span><span class="p">,</span> <span class="n">PASS</span><span class="p">,</span> <span class="s1">&#39;note.note&#39;</span><span class="p">,</span> <span class="s1">&#39;create&#39;</span><span class="p">,</span> <span class="n">args</span><span class="p">)</span>
</pre></div>
</div>
<div role="alert" class="alert-exercise alert"><p class="alert-title">Exercise</p><p >Añadir un nuevo servicio al cliente</p><p >Escribir un programa de Python capaz de enviar peticiones XML-RPC a un PC Odoo (tuyo o de tu instructor). Este programa debe mostrar todas las sesiones y su correspondiente número de asientos. También debe crear una nueva sesión para uno de los cursos.</p><div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">functools</span>
<span class="kn">import</span> <span class="nn">xmlrpclib</span>
<span class="n">HOST</span> <span class="o">=</span> <span class="s1">&#39;localhost&#39;</span>
<span class="n">PORT</span> <span class="o">=</span> <span class="mi">8069</span>
<span class="n">DB</span> <span class="o">=</span> <span class="s1">&#39;openacademy&#39;</span>
<span class="n">USER</span> <span class="o">=</span> <span class="s1">&#39;admin&#39;</span>
<span class="n">PASS</span> <span class="o">=</span> <span class="s1">&#39;admin&#39;</span>
<span class="n">ROOT</span> <span class="o">=</span> <span class="s1">&#39;http://</span><span class="si">%s</span><span class="s1">:</span><span class="si">%d</span><span class="s1">/xmlrpc/&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">HOST</span><span class="p">,</span><span class="n">PORT</span><span class="p">)</span>

<span class="c1"># 1. Login</span>
<span class="n">uid</span> <span class="o">=</span> <span class="n">xmlrpclib</span><span class="o">.</span><span class="n">ServerProxy</span><span class="p">(</span><span class="n">ROOT</span> <span class="o">+</span> <span class="s1">&#39;common&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">login</span><span class="p">(</span><span class="n">DB</span><span class="p">,</span><span class="n">USER</span><span class="p">,</span><span class="n">PASS</span><span class="p">)</span>
<span class="k">print</span> <span class="s2">&quot;Logged in as </span><span class="si">%s</span><span class="s2"> (uid:</span><span class="si">%d</span><span class="s2">)&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">USER</span><span class="p">,</span><span class="n">uid</span><span class="p">)</span>

<span class="n">call</span> <span class="o">=</span> <span class="n">functools</span><span class="o">.</span><span class="n">partial</span><span class="p">(</span>
    <span class="n">xmlrpclib</span><span class="o">.</span><span class="n">ServerProxy</span><span class="p">(</span><span class="n">ROOT</span> <span class="o">+</span> <span class="s1">&#39;object&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">execute</span><span class="p">,</span>
    <span class="n">DB</span><span class="p">,</span> <span class="n">uid</span><span class="p">,</span> <span class="n">PASS</span><span class="p">)</span>

<span class="c1"># 2. Read the sessions</span>
<span class="n">sessions</span> <span class="o">=</span> <span class="n">call</span><span class="p">(</span><span class="s1">&#39;openacademy.session&#39;</span><span class="p">,</span><span class="s1">&#39;search_read&#39;</span><span class="p">,</span> <span class="p">[],</span> <span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">,</span><span class="s1">&#39;seats&#39;</span><span class="p">])</span>
<span class="k">for</span> <span class="n">session</span> <span class="ow">in</span> <span class="n">sessions</span><span class="p">:</span>
    <span class="k">print</span> <span class="s2">&quot;Session </span><span class="si">%s</span><span class="s2"> (</span><span class="si">%s</span><span class="s2"> seats)&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">session</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">],</span> <span class="n">session</span><span class="p">[</span><span class="s1">&#39;seats&#39;</span><span class="p">])</span>
<span class="c1"># 3.create a new session</span>
<span class="n">session_id</span> <span class="o">=</span> <span class="n">call</span><span class="p">(</span><span class="s1">&#39;openacademy.session&#39;</span><span class="p">,</span> <span class="s1">&#39;create&#39;</span><span class="p">,</span> <span class="p">{</span>
    <span class="s1">&#39;name&#39;</span> <span class="p">:</span> <span class="s1">&#39;My session&#39;</span><span class="p">,</span>
    <span class="s1">&#39;course_id&#39;</span> <span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
<span class="p">})</span>
</pre></div>
</div>
<p >En lugar de utilizar un id de curso en el código, el código puede buscar un curso por nombre:</p><div class="highlight-default"><div class="highlight"><pre><span></span><span class="c1"># 3.create a new session for the &quot;Functional&quot; course</span>
<span class="n">course_id</span> <span class="o">=</span> <span class="n">call</span><span class="p">(</span><span class="s1">&#39;openacademy.course&#39;</span><span class="p">,</span> <span class="s1">&#39;search&#39;</span><span class="p">,</span> <span class="p">[(</span><span class="s1">&#39;name&#39;</span><span class="p">,</span><span class="s1">&#39;ilike&#39;</span><span class="p">,</span><span class="s1">&#39;Functional&#39;</span><span class="p">)])[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">session_id</span> <span class="o">=</span> <span class="n">call</span><span class="p">(</span><span class="s1">&#39;openacademy.session&#39;</span><span class="p">,</span> <span class="s1">&#39;create&#39;</span><span class="p">,</span> <span class="p">{</span>
    <span class="s1">&#39;name&#39;</span> <span class="p">:</span> <span class="s1">&#39;My session&#39;</span><span class="p">,</span>
    <span class="s1">&#39;course_id&#39;</span> <span class="p">:</span> <span class="n">course_id</span><span class="p">,</span>
<span class="p">})</span>
</pre></div>
</div>
</div></section><section id="json-rpc-library"><h3 >Biblioteca de JSON-RPC</h3><p >En el siguiente ejemplo es un programa Python que interactúa con un servidor de Odoo con las bibliotecas estándar de Python <code >urllib2</code> and <code >json</code>:</p><div class="highlight-default"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">json</span>
<span class="kn">import</span> <span class="nn">random</span>
<span class="kn">import</span> <span class="nn">urllib2</span>

<span class="k">def</span> <span class="nf">json_rpc</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">method</span><span class="p">,</span> <span class="n">params</span><span class="p">):</span>
    <span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;jsonrpc&quot;</span><span class="p">:</span> <span class="s2">&quot;2.0&quot;</span><span class="p">,</span>
        <span class="s2">&quot;method&quot;</span><span class="p">:</span> <span class="n">method</span><span class="p">,</span>
        <span class="s2">&quot;params&quot;</span><span class="p">:</span> <span class="n">params</span><span class="p">,</span>
        <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1000000000</span><span class="p">),</span>
    <span class="p">}</span>
    <span class="n">req</span> <span class="o">=</span> <span class="n">urllib2</span><span class="o">.</span><span class="n">Request</span><span class="p">(</span><span class="n">url</span><span class="o">=</span><span class="n">url</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">data</span><span class="p">),</span> <span class="n">headers</span><span class="o">=</span><span class="p">{</span>
        <span class="s2">&quot;Content-Type&quot;</span><span class="p">:</span><span class="s2">&quot;application/json&quot;</span><span class="p">,</span>
    <span class="p">})</span>
    <span class="n">reply</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">urllib2</span><span class="o">.</span><span class="n">urlopen</span><span class="p">(</span><span class="n">req</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">reply</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;error&quot;</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="n">reply</span><span class="p">[</span><span class="s2">&quot;error&quot;</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">reply</span><span class="p">[</span><span class="s2">&quot;result&quot;</span><span class="p">]</span>

<span class="k">def</span> <span class="nf">call</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">service</span><span class="p">,</span> <span class="n">method</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">json_rpc</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="s2">&quot;call&quot;</span><span class="p">,</span> <span class="p">{</span><span class="s2">&quot;service&quot;</span><span class="p">:</span> <span class="n">service</span><span class="p">,</span> <span class="s2">&quot;method&quot;</span><span class="p">:</span> <span class="n">method</span><span class="p">,</span> <span class="s2">&quot;args&quot;</span><span class="p">:</span> <span class="n">args</span><span class="p">})</span>

<span class="c1"># log in the given database</span>
<span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;http://</span><span class="si">%s</span><span class="s2">:</span><span class="si">%s</span><span class="s2">/jsonrpc&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">HOST</span><span class="p">,</span> <span class="n">PORT</span><span class="p">)</span>
<span class="n">uid</span> <span class="o">=</span> <span class="n">call</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="s2">&quot;common&quot;</span><span class="p">,</span> <span class="s2">&quot;login&quot;</span><span class="p">,</span> <span class="n">DB</span><span class="p">,</span> <span class="n">USER</span><span class="p">,</span> <span class="n">PASS</span><span class="p">)</span>

<span class="c1"># create a new note</span>
<span class="n">args</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;color&#39;</span> <span class="p">:</span> <span class="mi">8</span><span class="p">,</span>
    <span class="s1">&#39;memo&#39;</span> <span class="p">:</span> <span class="s1">&#39;This is another note&#39;</span><span class="p">,</span>
    <span class="s1">&#39;create_uid&#39;</span><span class="p">:</span> <span class="n">uid</span><span class="p">,</span>
<span class="p">}</span>
<span class="n">note_id</span> <span class="o">=</span> <span class="n">call</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="s2">&quot;object&quot;</span><span class="p">,</span> <span class="s2">&quot;execute&quot;</span><span class="p">,</span> <span class="n">DB</span><span class="p">,</span> <span class="n">uid</span><span class="p">,</span> <span class="n">PASS</span><span class="p">,</span> <span class="s1">&#39;note.note&#39;</span><span class="p">,</span> <span class="s1">&#39;create&#39;</span><span class="p">,</span> <span class="n">args</span><span class="p">)</span>
</pre></div>
</div>
<p >Aquí está el mismo programa, utilizando la biblioteca <a href="https://pypi.python.org/pypi/jsonrpclib" class="external reference">jsonrpclib</a>:</p><div class="highlight-default"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">jsonrpclib</span>

<span class="c1"># server proxy object</span>
<span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;http://</span><span class="si">%s</span><span class="s2">:</span><span class="si">%s</span><span class="s2">/jsonrpc&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">HOST</span><span class="p">,</span> <span class="n">PORT</span><span class="p">)</span>
<span class="n">server</span> <span class="o">=</span> <span class="n">jsonrpclib</span><span class="o">.</span><span class="n">Server</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>

<span class="c1"># log in the given database</span>
<span class="n">uid</span> <span class="o">=</span> <span class="n">server</span><span class="o">.</span><span class="n">call</span><span class="p">(</span><span class="n">service</span><span class="o">=</span><span class="s2">&quot;common&quot;</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;login&quot;</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">[</span><span class="n">DB</span><span class="p">,</span> <span class="n">USER</span><span class="p">,</span> <span class="n">PASS</span><span class="p">])</span>

<span class="c1"># helper function for invoking model methods</span>
<span class="k">def</span> <span class="nf">invoke</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">method</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
    <span class="n">args</span> <span class="o">=</span> <span class="p">[</span><span class="n">DB</span><span class="p">,</span> <span class="n">uid</span><span class="p">,</span> <span class="n">PASS</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">method</span><span class="p">]</span> <span class="o">+</span> <span class="nb">list</span><span class="p">(</span><span class="n">args</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">server</span><span class="o">.</span><span class="n">call</span><span class="p">(</span><span class="n">service</span><span class="o">=</span><span class="s2">&quot;object&quot;</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;execute&quot;</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="n">args</span><span class="p">)</span>

<span class="c1"># create a new note</span>
<span class="n">args</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;color&#39;</span> <span class="p">:</span> <span class="mi">8</span><span class="p">,</span>
    <span class="s1">&#39;memo&#39;</span> <span class="p">:</span> <span class="s1">&#39;This is another note&#39;</span><span class="p">,</span>
    <span class="s1">&#39;create_uid&#39;</span><span class="p">:</span> <span class="n">uid</span><span class="p">,</span>
<span class="p">}</span>
<span class="n">note_id</span> <span class="o">=</span> <span class="n">invoke</span><span class="p">(</span><span class="s1">&#39;note.note&#39;</span><span class="p">,</span> <span class="s1">&#39;create&#39;</span><span class="p">,</span> <span class="n">args</span><span class="p">)</span>
</pre></div>
</div>
<p >Los ejemplos pueden ser fácilmente adaptados de XML-RPC a JSON-RPC.</p><div role="alert" class="alert-info alert"><p class="alert-title">Nota</p><p >Hay una serie de APIs de alto nivel en varios idiomas para acceder a los sistemas de Odoo sin <em >explícitamente</em> pasando por XML-RPC o JSON-RPC, tales como:</p><ul ><li ><a href="https://github.com/akretion/ooor" class="external reference alert-link">https://github.com/akretion/ooor</a></li><li ><a href="https://github.com/syleam/openobject-library" class="external reference alert-link">https://github.com/syleam/openobject-library</a></li><li ><a href="https://github.com/nicolas-van/openerp-client-lib" class="external reference alert-link">https://github.com/nicolas-van/openerp-client-lib</a></li><li ><a href="http://pythonhosted.org/OdooRPC" class="external reference alert-link">http://pythonhosted.org/OdooRPC</a></li><li ><a href="https://github.com/abhishek-jaiswal/php-openerp-lib" class="external reference alert-link">https://github.com/abhishek-jaiswal/php-openerp-lib</a></li></ul></div><div class="footnote" id="autofields"><span class="footnote-label"><a class="footnote-backref" href="#id2">[1]</a></span> <p >es posible <a href="../reference/orm.html#odoo.models.Model._log_access" class="internal reference" title="odoo.models.Model._log_access"><code class="py xref py-attr">desactivar la creación automática de algunos campos</code></a></p></div><div class="footnote" id="rawsql"><span class="footnote-label"><a class="footnote-backref" href="#id1">[2]</a></span> <p >escribir consultas SQL directas es totalmente posible, pero requiere muchísimo cuidado, ya que ignora todos los mecanismos de seguridad y autenticación de Odoo.</p></div></section>

          </article>
        </div>
        
        <div id="mask"></div>
      </main>
    </div>
  </div>

  <div class="floating_action_container">
    <a id="floating_action" class="ripple" href="#">
      <i class="mdi-action-explore"></i>
    </a>
    <div id="floating_action_menu">
      <span class="bubble"></span>
      <ul class="list-group content">
        <li class="list-group-item ripple"><a>Cras justo odio</a></li>
        <li class="list-group-item ripple"><a>Dapibus ac facilisis in</a></li>
        <li class="list-group-item ripple"><a>Morbi leo risus</a></li>
        <li class="list-group-item ripple"><a>Porta ac consectetur ac</a></li>
        <li class="list-group-item ripple"><a>Vestibulum at eros</a></li>
      </ul>
    </div>
  </div>
  <footer>
    <div id="footer" class="container">
      <span class="o_logo o_logo_inverse center-block o_footer_logo"></span>
      <div class="row">
        <div class="col-sm-7 col-md-7 col-lg-6">
          <div class="row">
            <div class="col-xs-6 col-sm-4">
              <span class="menu_title">Community</span>
              <ul>
                <li><a href="https://github.com/odoo/odoo">Github</a></li>
                <li><a href="http://www.odoo.com/page/download">Download</a></li>
                <li class="divider"></li>
                <li><a href="http://runbot.odoo.com/runbot/repo/git-github-com-odoo-enterprise-7">Runbot</a></li>
                <li><a href="https://github.com/odoo/odoo/wiki/Translations">Translations</a></li>
                <li class="divider"></li>
                <li><a href="http://www.odoo.com/page/odoo-community">Mailing Lists</a></li>
                <li><a href="http://www.odoo.com/forum/help-1">Forum</a></li>
              </ul>
            </div>
            <div class="col-xs-6 col-sm-4">
              <span class="menu_title">Services</span>
              <ul>
                <li><a href="http://www.odoo.com/pricing">Editions</a></li>
                <li><a href="http://www.odoo.com/pricing-online">Cloud Pricing</a></li>
                <li><a href="http://www.odoo.com/page/upgrade">Upgrade</a></li>
                <li class="divider"></li>
                <li><a href="http://www.odoo.com/partners">Find a partner</a></li>
                <li><a href="http://www.odoo.com/page/become-a-partner">Become a partner</a></li>
                <li class="divider"></li>
                <li><a href="http://www.odoo.com/page/education-program">Education</a></li>
                <li class="divider"></li>
                <li><a href="http://www.odoo.com/page/security">Security</a></li>
              </ul>
            </div>
            <div class="col-sm-4 mb64">
              <span class="menu_title">About us</span>
              <ul>
                <li><a href="http://www.odoo.com/page/about-us">Our company</a></li>
                <li><a href="http://www.odoo.com/page/contactus">Contact</a></li>
                <li class="divider" />
                <li><a href="http://www.odoo.com/event">Events</a></li>
                <li><a href="http://www.odoo.com/blog/">Blog</a></li>
                <li><a href="http://www.odoo.com/blog/6">Customers</a></li>
                <li class="divider" />
                <li><a href="http://www.odoo.com/jobs">Jobs</a></li>
              </ul>
            </div>
          </div>
        </div>
        <div class="col-sm-5 col-md-4 col-md-offset-1 col-lg-5 col-lg-offset-1">
          <p>
            <small>
              Odoo is a suite of open source business apps that cover all your company needs: CRM, eCommerce, accounting, inventory, point of sale, project management, etc.
              <br/><br/>
              Odoo's unique value proposition is to be at the same time very easy to use and fully integrated.
            </small>
          </p>
        </div>
      </div>
    </div>
    <div class="o_footer_bottom">
      <div class="container">
        <a class="small" href="http://www.odoo.com/page/website-builder">Website made with <span class="o_logo o_logo_inverse o_logo_15"></span></a>
        <div class="social-links pull-right">
          <a href="http://www.odoo.com/web/about/facebook"><i class="fa fa-facebook"></i></a>
          <a href="http://www.odoo.com/web/about/twitter"><i class="fa fa-twitter"></i></a>
          <a href="http://www.odoo.com/web/about/linkedin"><i class="fa fa-linkedin"></i></a>
          <a href="mailto:info@odoo.com"><i class="fa fa-envelope"></i></a>
        </div>
      </div>
    </div>
  </footer>
  </body>
</html>